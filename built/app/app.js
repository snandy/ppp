/*! SohuBlog @snandy 2013-04-09 15:58:38 */
function checkOptVar(){_sff||$LR('<span style="color:red"><strong>Warning:</strong> _sff = false</span>'),_sff_l||$LR('<span style="color:red"><strong>Warning:</strong> _sff_l = false</span>'),pageLib[3].ableSetPer&&$LR('<span style="color:red"><strong>Warning:</strong> page0.ableSetPer = true</span>')}function registerWidget(w){App.Widgets[w]=eval(w)}function loginPath(){return"http://blog.sohu.com/login/logon.do?bru="+encodeURIComponent(location.href)}var js_domain1="js1.pp.sohu.com.cn",js_domain2="js2.pp.sohu.com.cn",js_domain3="js3.pp.sohu.com.cn",js_domain4="js4.pp.sohu.com.cn",js_domain5="js5.pp.sohu.com.cn",camp_apis={blog_profile:"http://blog.sohu.com/service/profile.jsp",pp_profile:"http://pp.sohu.com/photoparkService.jhtml?method=getUser&type=json",alumni_profile:"http://alumni.chinaren.com/my/json.camp.alumni.jsp",xiaonei_profile:"http://xiaonei.chinaren.com/my/json.camp.xiaonei.jsp",crclub_profile:"http://club.chinaren.com/my/json.camp.club.jsp",club_profile:"http://club.sohu.com/getuserinfoforcamp.php",mail_profile:"http://login.mail.sohu.com/servlet/LoginServlet?ul=camp",passport_profile:"http://passport.sohu.com/interface/widget.jsp",say_profile:"http://bbs.sogou.com/jsp/exinterface/widget.jsp",music_profile:"http://mbox.sogou.com/mbox/coo/widget.jsp",relaxgame_profile:"http://game.sohu.com/gamecamp/gamecampcard.php"},lang="zh",Actions={imgPath:"http://"+js_domain1+"/ppp/blog/styles_ppp/images/",themePath:"undefined"!=typeof ThP?ThP:"http://"+js_domain2+"/ppp/blog/themes_ppp/",jsPath:"undefined"!=typeof SP?SP:"http://"+js_domain3+"/ppp/blog/js_ppp/",flashPath:"http://js.pp.sohu.com/ppp/blog/flash/",widgetLibPath:"http://js.pp.sohu.com"+("undefined"!=typeof WP?WP:"/ppp/blog/widgets/"),widgetLibPath1:"http://"+js_domain1+("undefined"!=typeof WP?WP:"/ppp/blog/widgets/"),widgetLibPath2:"http://"+js_domain2+("undefined"!=typeof WP?WP:"/ppp/blog/widgets/"),widgetLibPath3:"http://"+js_domain3+("undefined"!=typeof WP?WP:"/ppp/blog/widgets/"),widgetLibPath4:"http://"+js_domain4+("undefined"!=typeof WP?WP:"/ppp/blog/widgets/"),widgetLibPath5:"http://"+js_domain5+("undefined"!=typeof WP?WP:"/ppp/blog/widgets/"),widgetLibPathCR:"http://"+js_domain5+("undefined"!=typeof WP?WP:"/ppp/blog/widgets/"),customTheme:"/manage/style.do",userData:"/action/",newMod:"/manage/module.do",delMod:"/manage/module.do",editMod:"/manage/module.do",newPage:"/manage/page.do",delPage:"/manage/page.do",editPage:"/manage/page.do",editUserStyle:"/manage/module.do",theme:"/manage/theme.do",linkMng:"/manage/link.do",greenWay:"http://act.blog.sohu.com/service/list_code.jsp",proxyURL:"/hp"},noCache=!1,defaultCacheTime=30,maxWidgetLoadTime=2e4,colStyleLib={"25:25:25:25":"custom/colStyles/25_25_25_25.gif","33:33:33":"custom/colStyles/33_33_33.gif","25:50:25":"custom/colStyles/25_50_25.gif","25:25:50":"custom/colStyles/25_25_50.gif","50:25:25":"custom/colStyles/50_25_25.gif","50:50":"custom/colStyles/50_50.gif","25:75":"custom/colStyles/25_75.gif","75:25":"custom/colStyles/75_25.gif","67:33":"custom/colStyles/67_33.gif","33:67":"custom/colStyles/33_67.gif",100:"custom/colStyles/100.gif"},themeGroup=[{key:"sys",title:"默认主题"},{key:"ot",title:"我购买的主题",isNew:!0,type:"function",dataUrl:"http://ow.blog.sohu.com/goods/0/myGoods?p="+PassportSC.cookie.userid+"&vn=ow_my_themes",more:!0,moreTitle:"更多 &gt;&gt;",moreId:"ow_my_themes_more",moreUrl:"http://ow.blog.sohu.com/manage/goods.do?action=myThemes&catId=1&passport="+PassportSC.cookie.userid},{key:"ot",title:"付费主题购买区",isNew:!0,type:"function",dataUrl:"http://ow.blog.sohu.com/goods/0/latestGoods?st=0&sz=16&vn=ow_latest_themes",more:!0,moreTitle:"更多付费主题 &gt;&gt;",moreId:"ow_latest_themes_more",moreUrl:"http://ow.blog.sohu.com/goods/0/goods",itDivExtCss:"div_jsf"},{key:"bw",title:"部落窝主题专区"},{key:"fei2",title:"F2主题专区"},{key:"cr",title:"ChinaRen主题专区"},{key:"g17173",title:"17173主题专区"},{key:"customTheme",title:"主题自定义"},{key:"ot",title:"精彩主题推荐",isNew:!0,type:"function",dataUrl:"http://ow.blog.sohu.com/page/zone.do?action=recmdTheme&st=0&sz=16&vn=ow_recmd_themes"}],themeLib=[{id:"np0000",grp:"sys",smp:"sample.gif"},{id:"np0001",grp:"sys",smp:"sample.gif"},{id:"np0002",grp:"sys",smp:"sample.gif"},{id:"np0003",grp:"sys",smp:"sample.gif"},{id:"np0005",grp:"sys",smp:"sample.gif"},{id:"p0201",grp:"sys",smp:"sample.gif"},{id:"p0401",grp:"sys",smp:"sample.gif"},{id:"p0501",grp:"sys",smp:"sample.gif"},{id:"p0601",grp:"sys",smp:"sample.gif"},{id:"p0701",grp:"sys",smp:"sample.gif"},{id:"p0801",grp:"sys",smp:"sample.gif"},{id:"p0203",grp:"sys",smp:"sample.gif"},{id:"p0403",grp:"sys",smp:"sample.gif"},{id:"p0503",grp:"sys",smp:"sample.gif"},{id:"p0603",grp:"sys",smp:"sample.gif"},{id:"p0703",grp:"sys",smp:"sample.gif"},{id:"p0803",grp:"sys",smp:"sample.gif"},{id:"p0204",grp:"sys",smp:"sample.gif"},{id:"p0304",grp:"sys",smp:"sample.gif"},{id:"p0504",grp:"sys",smp:"sample.gif"},{id:"p0604",grp:"sys",smp:"sample.gif"},{id:"p0704",grp:"sys",smp:"sample.gif"},{id:"p0004",grp:"sys",smp:"sample.gif"},{id:"p0205",grp:"sys",smp:"sample.gif"},{id:"p0305",grp:"sys",smp:"sample.gif"},{id:"p0505",grp:"sys",smp:"sample.gif"},{id:"p0605",grp:"sys",smp:"sample.gif"},{id:"p0705",grp:"sys",smp:"sample.gif"},{id:"p0005",grp:"sys",smp:"sample.gif"},{id:"p21",grp:"sys",smp:"sample.jpg"},{id:"p22",grp:"sys",smp:"sample.jpg"},{id:"p23",grp:"sys",smp:"sample.gif"},{id:"p24",grp:"sys",smp:"sample.gif"},{id:"p25",grp:"sys",smp:"sample.gif"},{id:"p1001",grp:"sys",smp:"sample.jpg"},{id:"p1002",grp:"sys",smp:"sample.jpg"},{id:"p1003",grp:"sys",smp:"sample.jpg"},{id:"p1004",grp:"sys",smp:"sample.jpg"},{id:"p1005",grp:"sys",smp:"sample.jpg"},{id:"p1006",grp:"sys",smp:"sample.jpg"},{id:"p26",grp:"sys",smp:"sample.jpg"},{id:"p27",grp:"sys",smp:"sample.jpg"},{id:"p28",grp:"sys",smp:"sample.jpg"},{id:"p29",grp:"sys",smp:"sample.jpg"},{id:"p30",grp:"sys",smp:"sample.gif"},{id:"p6013",grp:"sys",smp:"sample.gif"},{id:"p6014",grp:"sys",smp:"sample.gif"},{id:"p6015",grp:"sys",smp:"sample.gif"},{id:"p6016",grp:"sys",smp:"sample.gif"},{id:"p6017",grp:"sys",smp:"sample.gif"},{id:"p6018",grp:"sys",smp:"sample.gif"},{id:"p6019",grp:"sys",smp:"sample.gif"},{id:"p6020",grp:"sys",smp:"sample.gif"},{id:"p6021",grp:"sys",smp:"sample.gif"},{id:"p6022",grp:"sys",smp:"sample.gif"},{id:"p6000",grp:"sys",smp:"sample.gif"},{id:"p6001",grp:"sys",smp:"sample.jpg"},{id:"p6002",grp:"sys",smp:"sample.gif"},{id:"p6003",grp:"sys",smp:"sample.jpg"},{id:"p9011",grp:"sys",smp:"sample.jpg"},{id:"p6004",grp:"sys",smp:"sample.gif"},{id:"p6005",grp:"sys",smp:"sample.gif"},{id:"p6006",grp:"sys",smp:"sample.gif"},{id:"p6007",grp:"sys",smp:"sample.jpg"},{id:"p6008",grp:"sys",smp:"sample.jpg"},{id:"p6009",grp:"sys",smp:"sample.jpg"},{id:"p6010",grp:"sys",smp:"sample.jpg"},{id:"p6011",grp:"sys",smp:"sample.jpg"},{id:"p6012",grp:"sys",smp:"sample.jpg"},{id:"p1008",grp:"bw",smp:"sample.gif"},{id:"p1009",grp:"bw",smp:"sample.gif"},{id:"p1010",grp:"bw",smp:"sample.gif"},{id:"p1013",grp:"bw",smp:"sample.gif"},{id:"p1017",grp:"bw",smp:"sample.gif"},{id:"p1019",grp:"bw",smp:"sample.gif"},{id:"p1021",grp:"bw",smp:"sample.gif"},{id:"p1023",grp:"bw",smp:"sample.gif"},{id:"p1024",grp:"bw",smp:"sample.gif"},{id:"p1025",grp:"bw",smp:"sample.gif"},{id:"p1026",grp:"bw",smp:"sample.gif"},{id:"p1027",grp:"bw",smp:"sample.gif"},{id:"p1028",grp:"bw",smp:"sample.gif"},{id:"p1029",grp:"bw",smp:"sample.gif"},{id:"p1030",grp:"bw",smp:"sample.gif"},{id:"p1031",grp:"bw",smp:"sample.gif"},{id:"p1032",grp:"bw",smp:"sample.gif"},{id:"p1033",grp:"bw",smp:"sample.gif"},{id:"p1034",grp:"bw",smp:"sample.gif"},{id:"p1035",grp:"bw",smp:"sample.gif"},{id:"p1036",grp:"bw",smp:"sample.gif"},{id:"p1037",grp:"bw",smp:"sample.gif"},{id:"p1038",grp:"bw",smp:"sample.gif"},{id:"p1039",grp:"bw",smp:"sample.gif"},{id:"p1040",grp:"bw",smp:"sample.gif"},{id:"p1041",grp:"bw",smp:"sample.gif"},{id:"p1042",grp:"bw",smp:"sample.gif"},{id:"p1043",grp:"bw",smp:"sample.gif"},{id:"p1044",grp:"bw",smp:"sample.gif"},{id:"p1045",grp:"bw",smp:"sample.gif"},{id:"p1046",grp:"bw",smp:"sample.gif"},{id:"p1047",grp:"bw",smp:"sample.gif"},{id:"p1048",grp:"bw",smp:"sample.gif"},{id:"p1049",grp:"bw",smp:"sample.gif"},{id:"p1050",grp:"bw",smp:"sample.gif"},{id:"p1051",grp:"bw",smp:"sample.gif"},{id:"p1052",grp:"bw",smp:"sample.gif"},{id:"p1053",grp:"bw",smp:"sample.gif"},{id:"p1054",grp:"bw",smp:"sample.gif"},{id:"p1055",grp:"bw",smp:"sample.gif"},{id:"p1056",grp:"bw",smp:"sample.gif"},{id:"p1057",grp:"bw",smp:"sample.gif"},{id:"p1058",grp:"bw",smp:"sample.gif"},{id:"p1059",grp:"bw",smp:"sample.gif"},{id:"p1060",grp:"bw",smp:"sample.gif"},{id:"p1061",grp:"bw",smp:"sample.gif"},{id:"p1062",grp:"bw",smp:"sample.gif"},{id:"p1063",grp:"bw",smp:"sample.gif"},{id:"p1064",grp:"bw",smp:"sample.gif"},{id:"p1065",grp:"bw",smp:"sample.gif"},{id:"p1066",grp:"bw",smp:"sample.gif"},{id:"p1067",grp:"bw",smp:"sample.gif"},{id:"p1068",grp:"bw",smp:"sample.gif"},{id:"p1069",grp:"bw",smp:"sample.gif"},{id:"p1070",grp:"bw",smp:"sample.gif"},{id:"p1071",grp:"bw",smp:"sample.gif",isNew:!0},{id:"p1072",grp:"bw",smp:"sample.gif",isNew:!0},{id:"p2001",grp:"fei2",smp:"sample.jpg"},{id:"p2002",grp:"fei2",smp:"sample.jpg"},{id:"p2003",grp:"fei2",smp:"sample.jpg"},{id:"p2004",grp:"fei2",smp:"sample.jpg"},{id:"p2005",grp:"fei2",smp:"sample.jpg"},{id:"p2006",grp:"fei2",smp:"sample.jpg"},{id:"p2007",grp:"fei2",smp:"sample.jpg"},{id:"p2008",grp:"fei2",smp:"sample.jpg"},{id:"p2009",grp:"fei2",smp:"sample.jpg"},{id:"p2010",grp:"fei2",smp:"sample.jpg"},{id:"p2011",grp:"fei2",smp:"sample.jpg"},{id:"p2012",grp:"fei2",smp:"sample.jpg"},{id:"p2013",grp:"fei2",smp:"sample.jpg"},{id:"p2014",grp:"fei2",smp:"sample.jpg"},{id:"p2015",grp:"fei2",smp:"sample.jpg"},{id:"p2016",grp:"fei2",smp:"sample.jpg"},{id:"p2017",grp:"fei2",smp:"sample.jpg"},{id:"p2018",grp:"fei2",smp:"sample.jpg"},{id:"p2019",grp:"fei2",smp:"sample.jpg"},{id:"p2020",grp:"fei2",smp:"sample.jpg"},{id:"p2021",grp:"fei2",smp:"sample.jpg"},{id:"p2022",grp:"fei2",smp:"sample.jpg"},{id:"p2023",grp:"fei2",smp:"sample.jpg"},{id:"p2024",grp:"fei2",smp:"sample.jpg"},{id:"p2025",grp:"fei2",smp:"sample.jpg"},{id:"p2026",grp:"fei2",smp:"sample.jpg"},{id:"p2027",grp:"fei2",smp:"sample.jpg"},{id:"p2028",grp:"fei2",smp:"sample.jpg"},{id:"p2029",grp:"fei2",smp:"sample.jpg"},{id:"p2030",grp:"fei2",smp:"sample.jpg"},{id:"p2031",grp:"fei2",smp:"sample.jpg"},{id:"p2032",grp:"fei2",smp:"sample.jpg"},{id:"p2033",grp:"fei2",smp:"sample.jpg"},{id:"p2034",grp:"fei2",smp:"sample.jpg"},{id:"p2035",grp:"fei2",smp:"sample.jpg"},{id:"p2036",grp:"fei2",smp:"sample.jpg"},{id:"p2037",grp:"fei2",smp:"sample.jpg"},{id:"p2038",grp:"fei2",smp:"sample.jpg"},{id:"p2039",grp:"fei2",smp:"sample.jpg"},{id:"p2040",grp:"fei2",smp:"sample.jpg"},{id:"p2041",grp:"fei2",smp:"sample.jpg"},{id:"c1016",grp:"cr",smp:"sample.jpg"},{id:"c1014",grp:"cr",smp:"sample.jpg"},{id:"c1015",grp:"cr",smp:"sample.jpg"},{id:"c1001",grp:"cr",smp:"sample.gif"},{id:"c1003",grp:"cr",smp:"sample.gif"},{id:"c1005",grp:"cr",smp:"sample.gif"},{id:"c1006",grp:"cr",smp:"sample.gif"},{id:"c1007",grp:"cr",smp:"sample.gif"},{id:"c1008",grp:"cr",smp:"sample.gif"},{id:"c1009",grp:"cr",smp:"sample.gif"},{id:"c1010",grp:"cr",smp:"sample.gif"},{id:"c1011",grp:"cr",smp:"sample.gif"},{id:"p3001",grp:"g17173",smp:"sample.gif"},{id:"p3002",grp:"g17173",smp:"sample.gif"},{id:"p3003",grp:"g17173",smp:"sample.gif"},{id:"p3004",grp:"g17173",smp:"sample.gif"},{id:"p3005",grp:"g17173",smp:"sample.gif"},{id:"p3006",grp:"g17173",smp:"sample.gif"},{id:"p3007",grp:"g17173",smp:"sample.gif"},{id:"p3008",grp:"g17173",smp:"sample.gif"},{id:"p3009",grp:"g17173",smp:"sample.gif"},{id:"p3011",grp:"g17173",smp:"sample.gif"},{id:"p3012",grp:"g17173",smp:"sample.gif"},{id:"p3014",grp:"g17173",smp:"sample.gif"},{id:"p3015",grp:"g17173",smp:"sample.gif"},{id:"p3016",grp:"g17173",smp:"sample.gif"},{id:"p3018",grp:"g17173",smp:"sample.gif"},{id:"p3019",grp:"g17173",smp:"sample.gif"},{id:"p3022",grp:"g17173",smp:"sample.gif"}],cusThemeHeaderBgi=[{smp:Actions.imgPath+"custom/themesHeaderBg/1_smp.gif",src:Actions.imgPath+"custom/themesHeaderBg/1.jpg",tiled:"no-repeat",height:"200"},{smp:Actions.imgPath+"custom/themesHeaderBg/2_smp.gif",src:Actions.imgPath+"custom/themesHeaderBg/2.jpg",tiled:"no-repeat",height:"200"},{smp:Actions.imgPath+"custom/themesHeaderBg/3_smp.gif",src:Actions.imgPath+"custom/themesHeaderBg/3.jpg",tiled:"no-repeat",height:"200"},{smp:Actions.imgPath+"custom/themesHeaderBg/4_smp.gif",src:Actions.imgPath+"custom/themesHeaderBg/4.jpg",tiled:"no-repeat",height:"200"},{smp:Actions.imgPath+"custom/themesHeaderBg/5_smp.gif",src:Actions.imgPath+"custom/themesHeaderBg/5.jpg",tiled:"no-repeat",height:"200"},{smp:Actions.imgPath+"custom/themesHeaderBg/6_smp.gif",src:Actions.imgPath+"custom/themesHeaderBg/6.jpg",tiled:"no-repeat",height:"200"}],cusThemeBodyBgi=[{smp:Actions.imgPath+"custom/themesBodyBg/1_smp.gif",src:Actions.imgPath+"custom/themesBodyBg/1.jpg",tiled:"repeat"},{smp:Actions.imgPath+"custom/themesBodyBg/2_smp.gif",src:Actions.imgPath+"custom/themesBodyBg/2.jpg",tiled:"repeat"},{smp:Actions.imgPath+"custom/themesBodyBg/3_smp.gif",src:Actions.imgPath+"custom/themesBodyBg/3.jpg",tiled:"repeat"},{smp:Actions.imgPath+"custom/themesBodyBg/4_smp.gif",src:Actions.imgPath+"custom/themesBodyBg/4.jpg",tiled:"repeat"},{smp:Actions.imgPath+"custom/themesBodyBg/5_smp.gif",src:Actions.imgPath+"custom/themesBodyBg/5.jpg",tiled:"repeat"},{smp:Actions.imgPath+"custom/themesBodyBg/6_smp.gif",src:Actions.imgPath+"custom/themesBodyBg/6.jpg",tiled:"repeat"},{smp:Actions.imgPath+"custom/themesBodyBg/7_smp.gif",src:Actions.imgPath+"custom/themesBodyBg/7.jpg",tiled:"repeat"},{smp:Actions.imgPath+"custom/themesBodyBg/8_smp.gif",src:Actions.imgPath+"custom/themesBodyBg/8.jpg",tiled:"repeat"},{smp:Actions.imgPath+"custom/themesBodyBg/9_smp.gif",src:Actions.imgPath+"custom/themesBodyBg/9.gif",tiled:"repeat"}],widgetGallery=[{key:"base",title:"基本"},{key:"mini",title:"微博"},{key:"entry",title:"日志"},{key:"picture",title:"图片"},{key:"music",title:"音乐"},{key:"video",title:"视频"},{key:"ground",title:"圈子"},{key:"tool",title:"工具"},{key:"subscibe",title:"订阅"},{key:"camp",title:"大本营"},{key:"chinaren",title:"ChinaRen"},{key:"other",title:"其他"},{key:"ow",title:"精品模块推荐",isNew:!0,type:"function",dataUrl:"http://ow.blog.sohu.com/page/category.do?action=recmdWidget&st=0&sz=15&vn=ow_recmd_widgets"}],widgetLib=[{title:"日志",desc:"最新的几篇日志",ico:"ico_widget.gif",author:"chenqj",site:"http://chenqj.blog.sohu.com",type:"entries",path:Actions.widgetLibPath5+"entries/",js:["widget.js"],only:!0,sys:!0,gal:"entry"},{title:"最新图片",desc:"最新上传的图片",ico:"ico_widget.gif",author:"chenqj",site:"http://chenqj.blog.sohu.com",type:"pp",path:Actions.widgetLibPath4+"pp/",js:["widget.js"],only:!0,sys:!0,gal:"picture"},{title:"最新图评",desc:"其他网友对您的图片的最新评论",ico:"ico_widget.gif",author:"chenqj",site:"http://chenqj.blog.sohu.com",type:"pp_comments",path:Actions.widgetLibPath3+"pp_comments/",js:["widget.js"],css:["style.css"],only:!0,sys:!0,gal:"picture"},{title:"相册收藏",desc:"收藏的相册专辑",ico:"ico_widget.gif",author:"chenqj",site:"http://chenqj.blog.sohu.com",type:"pp_favs",path:Actions.widgetLibPath2+"pp_favs/",js:["widget.js"],css:["style.css"],only:!0,sys:!0,demo:!0,gal:"picture"},{title:"相册专辑",desc:"相册的专辑列表",ico:"ico_widget.gif",author:"chenqj",site:"http://chenqj.blog.sohu.com",type:"pp_sets",path:Actions.widgetLibPath1+"pp_sets/",js:["widget.js"],css:["style.css"],only:!0,sys:!0,gal:"picture"},{title:"相册某一专辑",desc:"以缩略或幻灯方式，显示相册中的某一专辑",ico:"ico_widget.gif",author:"Todd Lee",site:"http://www.todd-lee.com",type:"pp_set",path:Actions.widgetLibPath5+"pp_set/",js:["widget.js"],css:["style.css"],gal:"picture"},{title:"相册风云榜",desc:"搜狐相册风云榜",ico:"ico_widget.gif",author:"chenqj",site:"http://chenqj.blog.sohu.com",type:"pp_top",path:Actions.widgetLibPath4+"pp_top/",js:["widget.js"],css:["style.css"],only:!0,sys:!0,toy:!0,gal:"picture"},{title:"精品相册专辑",desc:"搜狐相册精品专辑",ico:"ico_widget.gif",author:"chenqj",site:"http://chenqj.blog.sohu.com",type:"pp_recommends",path:Actions.widgetLibPath3+"pp_recommends/",js:["widget.js"],css:["style.css"],only:!0,sys:!0,demo:!0,gal:"picture"},{title:"音乐盒",desc:"音乐盒播放器",ico:"ico_widget.gif",author:"Todd Lee",site:"http://www.todd-lee.com",type:"music",path:Actions.widgetLibPath2+"music/",js:["widget.js"],css:["style.css"],only:!0,sys:!0,gal:"music"},{title:"邓丽君音乐盒",desc:"邓丽君音乐盒播放器",ico:"ico_widget.gif",author:"gm",site:"http://gmtjuwidget.blog.sohu.com",type:"music_act",path:Actions.widgetLibPath2+"music_act/",js:["widget.js"],css:["style.css"],only:!0,sys:!0,demo:!0,gal:"music"},{title:"档案",desc:"个人档案",ico:"ico_widget.gif",author:"chenqj",site:"http://chenqj.blog.sohu.com",pubDate:"2006-6-19 12:32",type:"profile",path:Actions.widgetLibPath1+"profile/",js:["widget.js"],css:["style.css"],only:!0,sys:!0,gal:"base"},{title:"好友",desc:"好友列表",ico:"ico_widget.gif",author:"chenqj",site:"http://chenqj.blog.sohu.com",type:"links",path:Actions.widgetLibPath5+"links/",js:["widget.js"],only:!0,sys:!0,gal:"base"},{title:"日志分类",desc:"日志的分类列表",ico:"ico_widget.gif",author:"chenqj",site:"http://chenqj.blog.sohu.com",type:"categories",path:Actions.widgetLibPath4+"categories/",js:["widget.js"],only:!0,sys:!0,gal:"entry"},{title:"最新评论",desc:"列出最新的十条评论",ico:"ico_widget.gif",author:"chenqj",site:"http://chenqj.blog.sohu.com",type:"latest_comments",path:Actions.widgetLibPath3+"latest_comments/",js:["widget.js"],only:!0,sys:!0,gal:"entry"},{title:"统计信息",desc:"博客的统计信息",ico:"ico_widget.gif",author:"chenqj",site:"http://chenqj.blog.sohu.com",type:"stats",path:Actions.widgetLibPath2+"stats/",js:["widget.js"],only:!0,sys:!0,gal:"base"},{title:"最近访客",desc:"你可以通过他看谁曾一次又一次的造访你的博客而只字未留,他可能是暗恋你的人 关心你的人 憎恨你的人 无意中闲逛来的人",ico:"ico_widget.gif",author:"chenqj",site:"http://chenqj.blog.sohu.com",type:"refer",path:Actions.widgetLibPath1+"refer/",js:["widget.js"],only:!0,sys:!0,gal:"base"},{title:"留言",desc:"列出最新的留言",ico:"ico_widget.gif",author:"Todd Lee",site:"http://www.todd-lee.com",type:"messages",path:Actions.widgetLibPath5+"messages/",js:["widget.js"],only:!0,sys:!0,gal:"base"},{title:"更新的博客",desc:"列出最近更新的十个博客",ico:"ico_widget.gif",author:"chenqj",site:"http://chenqj.blog.sohu.com",type:"fresh_blogs",path:Actions.widgetLibPath4+"fresh_blogs/",js:["widget.js"],only:!0,sys:!0,gal:"base"},{title:"自定义列表",desc:"可以列出您喜欢的书、音乐、电影等等～",ico:"ico_widget.gif",author:"Todd Lee",site:"http://www.todd-lee.com",type:"Custom_Links",path:Actions.widgetLibPath3+"custom_links/",js:["widget.js"],css:["style.css"],gal:"other"},{title:"自写文本",desc:"您可以在您的页面上增加一些公告或便签",ico:"ico_widget.gif",author:"Todd Lee",site:"http://www.todd-lee.com",pubDate:"2006-07-05",type:"Text_Note",path:Actions.widgetLibPath2+"text_note/",js:["widget.js"],css:["style.css"],gal:"other"},{title:"搜狗搜索",desc:"搜索网页，博客，音乐",ico:"ico_widget.gif",author:"chenqj",site:"http://chenqj.blog.sohu.com",type:"search",path:Actions.widgetLibPath1+"search/",js:["widget.js"],css:["style.css"],only:!0,sys:!0,gal:"tool"},{title:"新闻/社区",desc:"为您精选搜狐新闻和社区，方便您每日阅读",ico:"ico_widget.gif",author:"Todd Lee",site:"http://www.todd-lee.com",pubDate:"2006-07-05",type:"Feeds",path:Actions.widgetLibPath5+"sohu_news/",js:["widget.js"],css:["style.css"],gal:"subscibe"},{title:"时钟",desc:"给自己的博客加一个小时钟",ico:"ico_widget.gif",author:"Todd Lee",site:"http://www.todd-lee.com",pubDate:"2006-07-05",type:"Clock",path:Actions.widgetLibPath4+"clock/",js:["widget.js"],css:["style.css"],gal:"tool"},{title:"每日星座运势",desc:"看看每天的运势",ico:"ico_widget.gif",author:"chenqj",site:"http://chenqj.blog.sohu.com",type:"horoscope",path:Actions.widgetLibPath3+"horoscope/",js:["widget.js"],css:["style.css"],gal:"subscibe"},{title:"图片点点看",desc:"精彩图片点点看",ico:"ico_widget.gif",author:"chenqj",site:"http://chenqj.blog.sohu.com",type:"pic",path:Actions.widgetLibPath2+"pic/",js:["widget.js"],only:!0,demo:!0,gal:"picture"},{title:"休闲小游戏",desc:"轻松一下，玩一会儿游戏吧",ico:"ico_widget.gif",author:"chenqj",site:"http://chenqj.blog.sohu.com",type:"game",path:Actions.widgetLibPath1+"game/",js:["widget.js"],css:["style.css"],gal:"other"},{title:"FLASH 模块",desc:"好玩的FLASH模块",ico:"http://i0.itc.cn/20081111/63b_659b68d4_9ef0_44fb_9feb_d14045ec9d8b_1.gif",author:"Springwang",site:"http://www.i-starting.com",type:"flash",path:Actions.widgetLibPath1+"flash/",js:["widget.js"],css:["style.css"],dev:!0,gal:"other"},{title:"搜狐视频播报",desc:"搜狐娱乐播报，搜狐体育播报",ico:"ico_widget.gif",author:"Todd Lee",site:"http://www.todd-lee.com",type:"v",path:Actions.widgetLibPath5+"v/",js:["widget.js"],css:["style.css"],only:!0,demo:!0,gal:"video"},{title:"好友文章订阅",desc:"列出好友的日志，不会错过他的每篇精彩文章",ico:"ico_widget.gif",author:"Todd Lee",site:"http://www.todd-lee.com",pubDate:"2006-07-05",type:"Friend_Rss",path:Actions.widgetLibPath4+"friend_rss/",js:["widget.js"],css:["style.css"],toy:!0,gal:"subscibe"},{title:"心情晴雨表",desc:"说出你的心情，我们一起分享，一起分担",ico:"ico_widget.gif",author:"chenqj",site:"http://chenqj.blog.sohu.com",type:"mood",path:Actions.widgetLibPath3+"mood/",js:["widget.js"],css:["style.css"],only:!0,toy:!0,gal:"base"},{title:"del.icio.us",desc:"del.icio.us",ico:"ico_widget.gif",author:"chenqj",site:"http://chenqj.blog.sohu.com",type:"delicious",path:Actions.widgetLibPath2+"delicious/",js:["widget.js"],css:["style.css"],only:!0,toy:!0,gal:"subscibe"},{title:"Theme Developer",desc:"主题开发者测试用模块",author:"Todd Lee",site:"http://www.todd-lee.com",type:"Theme_Dev",path:Actions.widgetLibPath1+"themeDev/",js:["widget.js"],only:!0,dev:!0,gal:"tool"},{title:"每日一句",desc:"随机地显示名言,每次显示一行",author:"chenqj",site:"http://chenqj.blog.sohu.com",type:"hello",path:Actions.widgetLibPath5+"hello/",js:["widget.js"],css:["style.css"],demo:!0,gal:"subscibe"},{title:"17173资讯",desc:"最新网游排名和网游测试时间表",ico:"ico_widget.gif",author:"Todd Lee",site:"http://www.todd-lee.com",type:"game17173",path:Actions.widgetLibPath4+"game17173/",js:["widget.js"],css:["style.css"],only:!0,sys:!0,gal:"subscibe"},{title:"博客活动",desc:"搜狐博客活动",ico:"ico_widget.gif",author:"Todd Lee",site:"http://www.todd-lee.com",type:"campaign",path:Actions.widgetLibPath3+"campaign/",js:["widget.js"],css:["style.css"],only:!0,sys:!0,gal:"subscibe"},{title:"音乐盒专辑",desc:"音乐盒的专辑列表",ico:"ico_widget.gif",author:"Jady",site:"http://jadyyang.blog.sohu.com",type:"msc_albums",path:Actions.widgetLibPath2+"msc_albums/",js:["widget.js"],css:["style.css"],only:!0,sys:!0,gal:"music"},{title:"音乐盒某专辑",desc:"音乐盒中的某一个专辑",ico:"ico_widget.gif",author:"Jady",site:"http://jadyyang.blog.sohu.com",type:"msc_album",path:Actions.widgetLibPath1+"msc_album/",js:["widget.js"],css:["style.css"],only:!1,sys:!1,gal:"music"},{title:"推荐专辑",desc:"sogou音乐明星专辑",ico:"ico_widget.gif",author:"Jady",site:"http://jadyyang.blog.sohu.com",type:"msc_recommends",path:Actions.widgetLibPath5+"msc_recommends/",js:["widget.js"],css:["style.css"],only:!0,sys:!0,gal:"music"},{title:"新歌快递",desc:"sogou音乐新歌快递",ico:"ico_widget.gif",author:"Jady",site:"http://jadyyang.blog.sohu.com",type:"msc_newsongs",path:Actions.widgetLibPath4+"msc_newsongs/",js:["widget.js"],css:["style.css"],only:!0,sys:!0,gal:"music"},{title:"日志标签",desc:"日志标签列表",ico:"ico_widget.gif",author:"Jady",site:"http://jadyyang.blog.sohu.com",type:"tag_tags",path:Actions.widgetLibPath3+"tag_tags/",js:["widget.js"],css:["style.css"],only:!0,sys:!0,gal:"entry"},{title:"某一标签日志",desc:"个人某一标签中的日志列表",ico:"ico_widget.gif",author:"Jady",site:"http://jadyyang.blog.sohu.com",type:"tag_logs",path:Actions.widgetLibPath2+"tag_logs/",js:["widget.js"],css:["style.css"],only:!1,sys:!1,gal:"entry"},{title:"标签订阅",desc:"订阅系统中某一标签的日志",ico:"ico_widget.gif",author:"Jady",site:"http://jadyyang.blog.sohu.com",type:"tag_subscribe",path:Actions.widgetLibPath1+"tag_subscribe/",js:["widget.js"],css:["style.css"],only:!1,sys:!1,gal:"subscibe"},{title:"搜狐通行证",desc:"使用搜狐各个产品的通行证",ico:"ico_widget.gif",type:"camp_passport",path:Actions.widgetLibPath4+"camp_passport/",js:["widget.js"],css:["style.css"],only:!0,sys:!0,"private":!0,gal:"camp"},{title:"搜狐博客",desc:"搜狐博客是快速稳定的门户平台，提供最专业的Blog托管服务，免费注册，成为博客，建立自己的个人门户",ico:"ico_widget.gif",type:"camp_blog",path:Actions.widgetLibPath3+"camp_blog/",js:["widget.js"],css:["style.css"],only:!0,sys:!0,"private":!0,gal:"camp"},{title:"搜狐邮件",desc:"搜狐闪电邮件",ico:"ico_widget.gif",type:"camp_mail",path:Actions.widgetLibPath2+"camp_mail/",js:["widget.js"],css:["style.css"],only:!0,sys:!0,"private":!0,gal:"camp"},{title:"图片公园",desc:"搜狐图片公园（ pp.sohu.com ）是您的个人网络相册，您可以发布照片，进行个性展示，与好友分享交流",ico:"ico_widget.gif",type:"camp_pp",path:Actions.widgetLibPath1+"camp_pp/",js:["widget.js"],css:["style.css"],only:!0,sys:!0,"private":!0,gal:"camp"},{title:"搜狗音乐盒",desc:"搜狗音乐盒",ico:"ico_widget.gif",type:"camp_music",path:Actions.widgetLibPath5+"camp_music/",js:["widget.js"],css:["style.css"],only:!0,sys:!0,"private":!0,gal:"camp"},{title:"搜狐社区",desc:"中国第一社区",ico:"ico_widget.gif",type:"camp_club",path:Actions.widgetLibPath4+"camp_club/",js:["widget.js"],css:["style.css"],only:!0,sys:!0,"private":!0,gal:"camp"},{title:"校友录",desc:"中国规模最大、数据最全、服务最稳定的校友录产品",ico:"ico_widget.gif",type:"camp_alumni",path:Actions.widgetLibPath3+"camp_alumni/",js:["widget.js"],css:["style.css"],only:!0,sys:!0,"private":!0,gal:"camp"},{title:"校内",desc:"专属于在校大学生的真实空间",ico:"ico_widget.gif",type:"camp_xiaonei",path:Actions.widgetLibPath2+"camp_xiaonei/",js:["widget.js"],css:["style.css"],only:!0,sys:!0,"private":!0,gal:"camp",demo:!0},{title:"CR社区",desc:"时尚年轻人的新锐社区",ico:"ico_widget.gif",type:"camp_crclub",path:Actions.widgetLibPath1+"camp_crclub/",js:["widget.js"],css:["style.css"],only:!0,sys:!0,"private":!0,gal:"camp"},{title:"搜狗说吧",desc:"搜狗说吧",ico:"ico_widget.gif",type:"camp_say",path:Actions.widgetLibPath5+"camp_say/",js:["widget.js"],css:["style.css"],only:!0,sys:!0,"private":!0,gal:"camp"},{title:"搜狐游戏",desc:"搜狐游戏",ico:"ico_widget.gif",type:"camp_relaxgame",path:Actions.widgetLibPath5+"camp_relaxgame/",js:["widget.js"],css:["style.css"],only:!0,sys:!0,"private":!0,gal:"camp",demo:!0},{title:"声色放映厅",desc:"将您的视频展示给大家",ico:"ico_widget.gif",author:"Todd Lee",site:"http://www.todd-lee.com",type:"v_tv",path:Actions.widgetLibPath3+"v_tv/",js:["widget.js"],css:["style.css"],only:!0,sys:!0,demo:!0,gal:"video"},{title:"最新视频",desc:"最新视频",ico:"ico_widget.gif",author:"Jady",site:"http://jadyyang.blog.sohu.com",type:"v_video",path:Actions.widgetLibPath2+"v_video/",js:["widget.js"],css:["style.css"],only:!0,sys:!0,gal:"video"},{title:"最新节目单",desc:"最新节目单",ico:"ico_widget.gif",author:"Jady",site:"http://jadyyang.blog.sohu.com",type:"v_plist",path:Actions.widgetLibPath1+"v_plist/",js:["widget.js"],css:["style.css"],only:!0,sys:!0,gal:"video"},{title:"收藏的视频",desc:"收藏的视频",ico:"ico_widget.gif",author:"Jady",site:"http://jadyyang.blog.sohu.com",type:"v_favovideo",path:Actions.widgetLibPath5+"v_favovideo/",js:["widget.js"],css:["style.css"],only:!0,sys:!0,gal:"video"},{title:"收藏的节目单",desc:"收藏的节目单",ico:"ico_widget.gif",author:"Jady",site:"http://jadyyang.blog.sohu.com",type:"v_favoplist",path:Actions.widgetLibPath4+"v_favoplist/",js:["widget.js"],css:["style.css"],only:!0,sys:!0,gal:"video"},{title:"推荐视频",desc:"推荐视频",ico:"ico_widget.gif",author:"Jady",site:"http://jadyyang.blog.sohu.com",type:"v_vrecommend",path:Actions.widgetLibPath3+"v_vrecommend/",js:["widget.js"],css:["style.css"],only:!0,sys:!0,gal:"video"},{title:"视频档案",desc:"视频档案",ico:"ico_widget.gif",author:"Jady",site:"http://jadyyang.blog.sohu.com",type:"v_profile",path:Actions.widgetLibPath3+"v_profile/",js:["widget.js"],only:!0,sys:!0,demo:!0,gal:"video"},{title:"最新动态",desc:"最新动态",ico:"ico_widget.gif",author:"Jady",site:"http://jadyyang.blog.sohu.com",type:"miniblog",path:Actions.widgetLibPath4+"miniblog/",js:["widget.js",HMP+"feed.js"],css:["style.css"],only:!0,sys:!0,demo:!1,gal:"base"},{title:"最新分享",desc:"最新分享",ico:"http://js2.pp.sohu.com.cn/ppp/images/icons/ico_share2.gif",author:"Springwang",site:"http://www.i-starting.com",type:"share",path:Actions.widgetLibPath4+"share/",js:["widget.js"],css:["style.css"],only:!0,sys:!0,gal:"base"},{title:"珍藏的社区",desc:"列出您珍藏的社区版面，方便您随时去查看",ico:"ico_widget.gif",author:"Todd Lee",site:"http://www.todd-lee.com",type:"club_favboard",path:Actions.widgetLibPath5+"club_favboard/",js:["widget.js"],css:["style.css"],only:!0,sys:!0,gal:"subscibe"},{title:"关注的说吧",desc:"列出您关注的说吧，方便您随时去查看",ico:"ico_widget.gif",author:"Todd Lee",site:"http://www.todd-lee.com",type:"say_favbar",path:Actions.widgetLibPath1+"say_favbar/",js:["widget.js"],css:["style.css"],only:!0,sys:!0,gal:"subscibe"},{title:"关注的标签",desc:"列出您关注的标签，方便您随时去查看",ico:"ico_widget.gif",author:"Todd Lee",site:"http://www.todd-lee.com",type:"tag_favtag",path:Actions.widgetLibPath2+"tag_favtag/",js:["widget.js"],css:["style.css"],only:!0,sys:!0,gal:"subscibe"},{title:"加入的圈子",desc:"加入的圈子",ico:"ico_widget.gif",author:"Jady",site:"http://jadyyang.blog.sohu.com",type:"q_ugroups",path:Actions.widgetLibPath3+"q_ugroups/",js:["widget.js"],css:["style.css"],only:!0,sys:!0,gal:"ground"},{title:"管理的圈子",desc:"管理的圈子",ico:"ico_widget.gif",author:"Jady",site:"http://jadyyang.blog.sohu.com",type:"q_uadmingroups",path:Actions.widgetLibPath4+"q_uadmingroups/",js:["widget.js"],css:["style.css"],only:!0,sys:!0,gal:"ground"},{title:"我关注的圈子",desc:"我关注的圈子",ico:"http://js1.pp.sohu.com.cn/ppp/images/icons/ico_group.gif",author:"Springwang",site:"http://www.i-starting.com",type:"q_atteGroup",path:Actions.widgetLibPath4+"q_atteGroup/",js:["widget.js"],css:["style.css"],only:!1,sys:!0,dev:!0,gal:"ground"},{title:"圈子个人档案",desc:"圈个人子档案",ico:"ico_widget.gif",author:"Jady",site:"http://jadyyang.blog.sohu.com",type:"q_ushow",path:Actions.widgetLibPath5+"q_ushow/",js:["widget.js"],css:["style.css"],only:!0,sys:!0,gal:"ground"},{title:"发表的圈子主帖",desc:"发表的圈子主贴",ico:"ico_widget.gif",author:"Jady",site:"http://jadyyang.blog.sohu.com",type:"q_utopics",path:Actions.widgetLibPath1+"q_utopics/",js:["widget.js"],css:["style.css"],only:!0,sys:!0,gal:"ground"},{title:"24小时热帖",desc:"24小时热帖",ico:"ico_widget.gif",author:"Jady",site:"http://jadyyang.blog.sohu.com",type:"q_tentopic",path:Actions.widgetLibPath2+"q_tentopic/",js:["widget.js"],css:["style.css"],only:!0,sys:!0,gal:"ground"},{title:"测试模块",desc:"Open Widget测试模块",ico:"ico_widget.gif",author:"Jady",site:"http://jadyyang.blog.sohu.com",type:"uwa_widget",path:UWAP,js:["uwa.js"],css:["uwa.css"],dev:!0,gal:"base"},{title:"站外友情链接",desc:"站外友情链接",ico:"ico_widget.gif",author:"jady",site:"http://jadyyang.blog.sohu.com",type:"my_links",path:Actions.widgetLibPath5+"my_links/",js:["widget.js"],css:["style.css"],gal:"base",demo:!0},{title:"RSS订阅",desc:"RSS订阅",ico:"ico_widget.gif",type:"rss",path:Actions.widgetLibPath5+"rss/",js:["widget.js"],css:["style.css"],gal:"subscibe"},{title:"动感相册",desc:"动感相册",ico:"http://js1.pp.sohu.com.cn/ppp/images/icons/ico_slide.gif",type:"pp_slide",path:Actions.widgetLibPath5+"pp_slide/",js:["widget.js"],css:["style.css"],gal:"picture"},{title:"天龙官网公告",desc:"天龙官网公告",ico:"ico_widget.gif",type:"tl_notice",path:Actions.widgetLibPath1+"tl_notice/",js:["widget.js"],css:["style.css"],only:!0,sys:!0,gal:"subscibe"},{title:"天龙八部众",desc:"天龙八部众",ico:"ico_widget.gif",type:"tl_bbshot",path:Actions.widgetLibPath2+"tl_bbshot/",js:["widget.js"],css:["style.css"],only:!0,sys:!0,gal:"subscibe"},{title:"在CR的涂鸦",desc:"在CR的涂鸦",ico:"ico_widget.gif",type:"cr_doodle",path:Actions.widgetLibPathCR+"cr_doodle/",js:["widget.js"],css:["style.css"],only:!0,sys:!0,gal:"chinaren"},{title:"CR图片频道",desc:"CR图片频道",ico:"ico_widget.gif",type:"cr_clubpic",path:Actions.widgetLibPathCR+"cr_clubpic/",js:["widget.js"],css:["style.css"],only:!0,sys:!0,gal:"chinaren"},{title:"CR型男索女",desc:"CR型男索女",ico:"ico_widget.gif",type:"cr_club1",path:Actions.widgetLibPathCR+"cr_club1/",js:["widget.js"],css:["style.css"],only:!0,sys:!0,gal:"chinaren"},{title:"CR麻辣婆媳",desc:"CR麻辣婆媳",ico:"ico_widget.gif",type:"cr_club2",path:Actions.widgetLibPathCR+"cr_club2/",js:["widget.js"],css:["style.css"],only:!0,sys:!0,gal:"chinaren"},{title:"CR魅力女人",desc:"CR魅力女人",ico:"ico_widget.gif",type:"cr_club3",path:Actions.widgetLibPathCR+"cr_club3/",js:["widget.js"],css:["style.css"],only:!0,sys:!0,gal:"chinaren"},{title:"CR小宠当家",desc:"CR小宠当家",ico:"ico_widget.gif",type:"cr_club4",path:Actions.widgetLibPathCR+"cr_club4/",js:["widget.js"],css:["style.css"],only:!0,sys:!0,gal:"chinaren"},{title:"CR今日关注",desc:"CR今日关注",ico:"ico_widget.gif",type:"cr_focus",path:Actions.widgetLibPathCR+"cr_focus/",js:["widget.js"],css:["style.css"],only:!0,sys:!0,gal:"chinaren"},{title:"CR新鲜校园",desc:"CR新鲜校园",ico:"ico_widget.gif",type:"cr_campus",path:Actions.widgetLibPathCR+"cr_campus/",js:["widget.js"],css:["style.css"],only:!0,sys:!0,gal:"chinaren"},{title:"ChinaRen专栏",desc:"ChinaRen专栏",ico:"ico_widget.gif",type:"cr_ding",path:Actions.widgetLibPathCR+"cr_ding/",js:["widget.js"],css:["style.css"],only:!0,sys:!0,gal:"chinaren"},{title:"CR热点专题",desc:"CR热点专题",ico:"ico_widget.gif",type:"cr_feature",path:Actions.widgetLibPathCR+"cr_feature/",js:["widget.js"],css:["style.css"],only:!0,sys:!0,gal:"chinaren"},{title:"CR精彩活动",desc:"CR精彩活动",ico:"ico_widget.gif",type:"cr_party",path:Actions.widgetLibPathCR+"cr_party/",js:["widget.js"],css:["style.css"],only:!0,sys:!0,gal:"chinaren"},{title:"CR小黑板",desc:"CR小黑板",ico:"ico_widget.gif",type:"cr_board",path:Actions.widgetLibPathCR+"cr_board/",js:["widget.js"],css:["style.css"],only:!0,sys:!0,gal:"chinaren"},{title:"学校公告栏",desc:"学校公告栏",ico:"ico_widget.gif",type:"cr_school",path:Actions.widgetLibPathCR+"cr_school/",js:["widget.js"],css:["style.css"],only:!0,sys:!0,gal:"chinaren"},{title:"CR学校搜索",desc:"CR学校搜索",ico:"ico_widget.gif",type:"cr_search",path:Actions.widgetLibPathCR+"cr_search/",js:["widget.js"],css:["style.css"],only:!0,sys:!0,gal:"chinaren"},{title:"在CR的近况",desc:"在CR的近况",ico:"ico_widget.gif",type:"cr_track",path:Actions.widgetLibPathCR+"cr_track/",js:["widget.js"],css:["style.css"],only:!0,sys:!0,gal:"chinaren"},{title:"CR群组",desc:"CR群组",ico:"ico_widget.gif",type:"cr_group",path:Actions.widgetLibPathCR+"cr_group/",js:["widget.js"],css:["style.css"],only:!0,sys:!0,gal:"chinaren"},{title:"ChinaRen导航",desc:"ChinaRen导航",ico:"ico_widget.gif",type:"cr_nav",path:Actions.widgetLibPathCR+"cr_nav/",js:["widget.js"],css:["style.css"],only:!0,sys:!0,gal:"chinaren"},{title:"在CR收到的礼物",desc:"在CR收到的礼物",ico:"ico_widget.gif",type:"cr_gift",path:Actions.widgetLibPathCR+"cr_gift/",js:["widget.js"],css:["style.css"],only:!0,sys:!0,gal:"chinaren"},{title:"公告",desc:"公告",ico:"http://js5.pp.sohu.com.cn/ppp/blog/styles_ppp/images/custom/icons/rosette.gif",type:"cr_tips",path:Actions.widgetLibPath5+"cr_tips/",js:["widget.js"],only:!0,sys:!0,dev:!0,gal:"chinaren"},{title:"奥运精彩图片",desc:"精彩奥运图片展示",ico:"ico_widget.gif",type:"o_wondPhoto",path:Actions.widgetLibPath1+"o_wondPhoto/",js:["widget.js"],css:["style.css"],only:!0,sys:!0,demo:!0,gal:"picture"},{title:"微博",desc:"我的微博列表",ico:"ico_widget.gif",author:"gm",site:"http://gmtjuwidget.blog.sohu.com",type:"t_mini",path:Actions.widgetLibPath2+"t_mini/",js:["widget.js"],css:["style.css"],only:!0,sys:!0,gal:"mini"},{title:"微博档案",desc:"我的微博档案",ico:"ico_widget.gif",author:"gm",site:"http://gmtjuwidget.blog.sohu.com",type:"t_profile",path:Actions.widgetLibPath2+"t_profile/",js:["widget.js"],css:["style.css"],only:!0,sys:!0,gal:"mini"},{title:"微博标签",desc:"微博热门标签",ico:"ico_widget.gif",author:"gm",site:"http://gmtjuwidget.blog.sohu.com",type:"t_tag",path:Actions.widgetLibPath2+"t_tag/",js:["widget.js"],css:["style.css"],only:!0,sys:!0,gal:"mini"},{title:"微博访客",desc:"微博访客",ico:"ico_widget.gif",author:"gm",site:"http://gmtjuwidget.blog.sohu.com",type:"t_visitor",path:Actions.widgetLibPath2+"t_visitor/",js:["widget.js"],css:["style.css"],only:!0,sys:!0,gal:"mini"}],pageLib=[{title:"相册",desc:"包含常用的相册模块",ico:100,type:"1",hash:"p_pp",colStyle:"25:75",widgets:[["pp_sets"],["pp_set","pp_recommends"]],permit:0,only:!0,ableDel:!0,ableSetOpt:!0,ableSetTit:!1,ableSetCol:!0,ableSetIco:!1,ableSetPer:!1},{title:"音乐",desc:"包含常用的音乐模块",ico:78,type:"2",hash:"p_music",colStyle:"67:33",widgets:[["msc_album","msc_recommends"],["msc_albums","msc_newsongs"]],permit:0,only:!0,ableDel:!0,ableSetOpt:!0,ableSetTit:!1,ableSetCol:!0,ableSetIco:!1,ableSetPer:!1},{title:"视频",desc:"包含常用的视频模块",ico:125,type:"4",hash:"p_video",colStyle:"33:67",widgets:[["v_profile","v_favovideo","v_favoplist","v_vrecommend"],["v_tv","v_video","v_plist"]],permit:0,only:!0,ableDel:!0,ableSetOpt:!0,ableSetTit:!1,ableSetCol:!0,ableSetIco:!1,ableSetPer:!1},{title:"ChinaRen",desc:"包含常用的ChinaRen模块",ico:146,type:"5",hash:"p_chinaren",colStyle:"50:50",widgets:[["cr_ding","cr_club2","cr_focus","cr_club3","cr_party"],["cr_clubpic","cr_campus","cr_club1","cr_feature","cr_club4"]],permit:0,only:!0,ableDel:!0,ableSetOpt:!0,ableSetTit:!1,ableSetCol:!0,ableSetIco:!1,ableSetPer:!1},{title:"大本营",desc:"搜狐各产品的大本营",info:"这里是搜狐大本营，您可以由此方便地进入搜狐各个产品。其内容为私有，只有您自己可见。",ico:55,type:"3",hash:"p_camp",colStyle:"33:33:33",widgets:[["camp_passport"],["camp_blog","camp_mail","camp_pp"],["camp_club","camp_alumni","camp_xiaonei","camp_crclub"]],permit:1,only:!0,ableDel:!1,ableSetOpt:!0,ableSetTit:!1,ableSetCol:!0,ableSetIco:!1,ableSetPer:!1,demo:!0},{title:"",desc:"可以自定义页面标题、图标、版式等",ico:0,type:"0",hash:"p_0",colStyle:"",widgets:[],permit:0,only:!1,ableDel:!0,ableSetOpt:!0,ableSetTit:!0,ableSetCol:!0,ableSetIco:!0,ableSetPer:!1}],highlightStyle={backgroundColor:"white",border:"1px solid #ccc",padding:"0"},unHighlightStyle={backgroundColor:"transparent",border:"none",padding:"1px"},colId_prefix="col_",pageHash_prefix="tp_",defaultColStyle="33:33:33",createOnlyFirstPageMod=!0,maxPageTabCount=6,maxPerPageModCount=20,lib={Lang:Actions.jsPath+"lang_"+lang+".js"};
checkOptVar();var App={version:"0.2",status:isMyBlog()?3==getUserType()?3:2:1,theme:"undefined"!=typeof _theme?_theme:"default",lang:lang!==void 0?lang:"zh",Actions:Object.extend({imgPath:"http://js3.pp.sohu.com.cn/ppp/blog/styles_ppp/images/",icoShortPath:"custom/icons/",themePath:"http://js1.pp.sohu.com.cn/ppp/blog/themes_ppp/",jsPath:"http://js2.pp.sohu.com.cn/ppp/blog/js_ppp/",widgetLibPath:"http://js4.pp.sohu.com.cn/ppp/blog/widgets/",customTheme:"/manage/style.do",userData:"/action/",newMod:"/manage/module.do",delMod:"/manage/module.do",editMod:"/manage/module.do",newPage:"/manage/page.do",delPage:"/manage/page.do",editPage:"/manage/page.do",editUserStyle:"/manage/module.do",theme:"/manage/theme.do",themeGW:"/manage/theme.do",linkMng:"/manage/link.do",greenWay:"http://act.blog.sohu.com/service/list_code.jsp",proxyURL:"/hp"},Actions!==void 0?Actions:{}),noCache:noCache!==void 0?noCache:!1,cacheTime:defaultCacheTime!==void 0?defaultCacheTime:30,maxWidgetLoadTime:maxWidgetLoadTime!==void 0?maxWidgetLoadTime:1e4,colStyleLib:Object.extend({"25:25:25:25":"custom/colStyles/25_25_25_25.gif","25:50:25":"custom/colStyles/25_50_25.gif","25:25:50":"custom/colStyles/25_25_50.gif","50:25:25":"custom/colStyles/50_25_25.gif","50:50":"custom/colStyles/50_50.gif","25:75":"custom/colStyles/25_75.gif","75:25":"custom/colStyles/75_25.gif"},colStyleLib!==void 0?colStyleLib:{}),icoLib:Object.extend(["none.gif","anchor.gif","attach.gif","basket.gif","bomb.gif","book.gif","book_addresses.gif","book_open.gif","brick.gif","briefcase.gif","bug.gif","cake.gif","calendar_view_day.gif","calendar_view_month.gif","camera.gif","car.gif","cd.gif","chart_bar.gif","chart_curve.gif","chart_organisation.gif","chart_pie.gif","clock.gif","clock_red.gif","cog.gif","coins.gif","color_swatch.gif","comment.gif","computer.gif","connect.gif","creditcards.gif","door.gif","door_open.gif","drink.gif","drink_empty.gif","email.gif","email_open.gif","email_open_image.gif","emoticon_evilgrin.gif","emoticon_grin.gif","emoticon_happy.gif","emoticon_smile.gif","emoticon_surprised.gif","emoticon_tongue.gif","emoticon_unhappy.gif","emoticon_waii.gif","emoticon_wink.gif","exclamation.gif","eye.gif","feed.gif","flag_blue.gif","flag_green.gif","flag_orange.gif","flag_pink.gif","flag_purple.gif","flag_red.gif","flag_yellow.gif","folder.gif","heart.gif","house.gif","image.gif","information.gif","ipod.gif","keyboard.gif","layout.gif","lightbulb.gif","lightbulb_off.gif","lock.gif","lock_open.gif","lorry.gif","lorry_flatbed.gif","magnifier.gif","money.gif","money_dollar.gif","money_euro.gif","money_pound.gif","money_yen.gif","monitor.gif","mouse.gif","music.gif","new.gif","note.gif","page.gif","page_copy.gif","page_white.gif","page_white_acrobat.gif","page_white_code.gif","page_white_compressed.gif","page_white_excel.gif","page_white_flash.gif","page_white_php.gif","page_white_picture.gif","page_white_powerpoint.gif","page_white_text.gif","page_white_word.gif","page_white_world.gif","palette.gif","paste_plain.gif","pencil.gif","phone.gif","photo.gif","picture.gif","printer.gif","printer_empty.gif","rainbow.gif","rosette.gif","server.gif","shield.gif","sport_8ball.gif","sport_basketball.gif","sport_football.gif","sport_golf.gif","sport_raquet.gif","sport_shuttlecock.gif","sport_soccer.gif","sport_tennis.gif","star.gif","stop.gif","tag_blue.gif","tag_green.gif","tag_orange.gif","tag_pink.gif","tag_purple.gif","tag_red.gif","tag_yellow.gif","telephone.gif","television.gif","thumb_down.gif","thumb_up.gif","trash.gif","tux.gif","user.gif","user_female.gif","user_gray.gif","user_green.gif","user_orange.gif","user_red.gif","user_suit.gif","vcard.gif","weather_clouds.gif","weather_cloudy.gif","weather_lightning.gif","weather_rain.gif","weather_snow.gif","weather_sun.gif","world.gif","zoom.gif","chinaren.gif","olympic.gif"],"undefined"!=typeof icoLib?icoLib:[]),highlightStyle:Object.extend({backgroundColor:"white",border:"1px solid #ccc",padding:"0"},highlightStyle!==void 0?highlightStyle:{}),unHighlightStyle:Object.extend({backgroundColor:"transparent",border:"none",padding:"1px"},unHighlightStyle!==void 0?unHighlightStyle:{}),colId_prefix:colId_prefix!==void 0?colId_prefix:"col_",pageHash_prefix:pageHash_prefix!==void 0?pageHash_prefix:"tp_",defaultColStyle:"33:33:33",createOnlyFirstPageMod:createOnlyFirstPageMod!==void 0?createOnlyFirstPageMod:!0,maxPageTabCount:maxPageTabCount!==void 0?maxPageTabCount:5,maxPerPageModCount:maxPerPageModCount!==void 0?maxPerPageModCount:20,showNewWidgtTip:"undefined"!=typeof showNewWidgtTip?showNewWidgtTip:!1,showNewThemeTip:"undefined"!=typeof showNewThemeTip?showNewThemeTip:!1,cancelBubble:function(e){Event.stop(e)}};App.Permit={resize:2==App.status,editModule:2==App.status,sortable:2==App.status,editTheme:2==App.status,editHead:2==App.status,editPageTab:2==App.status,ableViewPvtPageTab:2==App.status||3==App.status,ableToy:"true"==getUrlParam("toy"),able3rdDev:"true"==getUrlParam("3rdDev"),ableDemo:"true"==getUrlParam("pppDeveloper"),ableLog:"true"==getUrlParam("log")},App.Lib={lib:Object.extend({Lang:App.Actions.jsPath+"lang_"+App.lang+".js"},lib!==void 0?lib:{}),load:function(){$H(this.lib).each(function(e){document.write('<script type="text/javascript" charset="utf-8" src="'+e.value+'"></scr'+"ipt>")})}},App.Lib.load(),App.WidgetLib={gallery:Object.extend([{key:"other",title:""}],widgetGallery!==void 0?widgetGallery:[]),getGallery:function(e){return this.gallery.find(function(t){return t&&t.key&&t.key==e})},lib:Object.extend([],widgetLib!==void 0?widgetLib:[]),getWidget:function(e){return this.lib.find(function(t){return t&&t.type&&t.type==e})},analyseAll:function(){var e=[];$A(this.lib).each(function(t){var i=this.getAnalysedWidget(t);i&&(e.push(i),i.isNew&&this.getGallery(i.gal)&&!this.getGallery(i.gal).hasNew&&(this.getGallery(i.gal).hasNew=!0,this.hasNew||(this.hasNew=!0)))}.bind(this)),this.lib=e},getAnalysedWidget:function(e){var t=Object.extend({title:"No Title",desc:"no description.",ico:App.Actions.imgPath+"ico_widget.gif",author:"Todd Lee",site:"http://www.todd-lee.com",pubDate:"Sun, 16 May 1982 11:30:00 GMT",type:"",path:"",js:[],css:[],only:!1,sys:!1,ableDel:!0,toy:!1,dev:!1,demo:!1,"private":!1,gal:"other"},e||{});if(!App.showNewWidgtTip&&t.isNew&&(t.isNew=null),!t.type)return alert("Error: widget type is undefined."),null;if(!t.path)return alert("Error: path of widget ["+t.type+"] is undefined."),null;var i=t.path;if(t.ico){var s=t.ico.trim();s&&0!==s.indexOf("http://")&&0!==s.indexOf("/")&&(s=i+(s||"")),t.ico=s}return $A(t.js).each(function(e,s){0!==e.indexOf("http://")&&0!==e.indexOf("/")&&(t.js[s]=i+e)}),$A(t.css).each(function(e,s){0!==e.indexOf("http://")&&0!==e.indexOf("/")&&(t.css[s]=i+e)}),t}},App.WidgetLib.analyseAll(),App.PageLib={lib:Object.extend([],pageLib!==void 0?pageLib:[]),getPage:function(e){return this.lib.find(function(t){return t&&t.type&&t.type==e})},analyseAll:function(){var e=[];$A(this.lib).each(function(t){var i=this.getAnalysedPage(t);i&&e.push(i)}.bind(this)),this.lib=e},getAnalysedPage:function(e){var t=Object.extend({title:"",desc:"",ico:0,author:"Todd Lee",site:"http://www.todd-lee.com",pubDate:"Sun, 16 May 1982 11:30:00 GMT",type:"",hash:"",colStyle:App.defaultColStyle,widgets:[],permit:0,only:!1,ableDel:!0,ableSetOpt:!0,ableSetTit:!0,ableSetCol:!0,ableSetIco:!0,ableSetPer:!0,toy:!1,dev:!1,demo:!1},e||{});return t.type?t.hash?t:(alert("Error: page hash is undefined."),null):(alert("Error: page type is undefined."),null)}},App.PageLib.analyseAll(),App.ThemeLib={group:Object.extend([{key:"sys",title:""}],themeGroup!==void 0?themeGroup:[]),getGroup:function(e){return this.group.find(function(t){return t&&t.key&&t.key==e})},lib:Object.extend([],themeLib!==void 0?themeLib:[]),getTheme:function(e){return this.lib.find(function(t){return t&&t.id&&t.id==e})},analyseAll:function(){var e=[];$A(this.lib).each(function(t){var i=this.getAnalysedTheme(t);i&&(e.push(i),i.isNew&&this.getGroup(i.grp)&&!this.getGroup(i.grp).hasNew&&(this.getGroup(i.grp).hasNew=!0,this.hasNew||(this.hasNew=!0)))}.bind(this)),this.lib=e},getAnalysedTheme:function(e){var t=Object.extend({id:"",grp:"sys",smp:"sample.jpg",path:"",code:"",name:""},e||{});return!App.showNewThemeTip&&t.isNew&&(t.isNew=null),t.id?t:(alert("Error: theme id is undefined."),null)},add:function(e){this.getTheme(e.id)||this.lib.push(this.getAnalysedTheme(e))}},App.ThemeLib.analyseAll(),App.CusThemeLib={headerBgi:{lib:Object.extend([],cusThemeHeaderBgi!==void 0?cusThemeHeaderBgi:[]),getImg:function(e){return this.lib.find(function(t){return t&&t.src&&t.src==e})},analyseAll:function(){var e=[];$A(this.lib).each(function(t){var i=this.getAnalysedImg(t);i&&e.push(i)}.bind(this)),this.lib=e},getAnalysedImg:function(e){var t=Object.extend({src:"",smp:"",tiled:"",align:"",height:""},e||{});return t.src?t:(alert("Error: header bgi url is undefined."),null)}},bodyBgi:{lib:Object.extend([],cusThemeBodyBgi!==void 0?cusThemeBodyBgi:[]),getImg:function(e){return this.lib.find(function(t){return t&&t.src&&t.src==e})},analyseAll:function(){var e=[];$A(this.lib).each(function(t){var i=this.getAnalysedImg(t);i&&e.push(i)}.bind(this)),this.lib=e},getAnalysedImg:function(e){var t=Object.extend({src:"",smp:"",tiled:"",align:""},e||{});return t.src?t:(alert("Error: header bgi url is undefined."),null)}}},App.CusThemeLib.headerBgi.analyseAll(),App.CusThemeLib.bodyBgi.analyseAll(),App.ImpBase=function(){},App.ImpBase.prototype={setOptions:function(e){this.options=Object.extend({parameters:"",onFailure:this.reportError.bind(this),method:"get"},e||{}),App.noCache&&(this.options.parameters=this.options.parameters?this.options.parameters+"&c="+timeStamp():"c="+timeStamp())},reportError:function(e){var t=App.Lang.error+": "+e.status+" "+(e.statusText!==void 0?e.statusText:"")+"\n\n";return"404"==e.status?(t+=App.Lang.fileNotFound,t+=" ( "+this.url+" )\n"):"500"==e.status?(t+=App.Lang.serverError,t+=" ( "+this.url+" )\n"):"403"==e.status?(t+=App.Lang.noPermit,t+=" ( "+this.url+" )\n"):"12007"==e.status?t+=App.Lang.notConneted:"12029"==e.status?(t+=App.Lang.cannotGetConnetion,t+=" ( "+this.url+" )\n"):(t+=App.Lang.unknownError,t+=" ( "+this.url+" )\n"),"500"==e.status&&(t+=App.Lang.contactAdmin+"\n"),LoadBar.hide(),alert(t),!1},showError:function(e){var t={type:"alert",title:App.Lang.info,content:e,width:"600"};new PopWin(t)}},App.ImpFile=Class.create(),App.ImpFile.prototype=Object.extend(new App.ImpBase,{initialize:function(e,t){e=e.trim();var i;this.setOptions(t),isLocalFile(e)?i=e:(i=App.Actions.proxyURL,this.options.parameters+=(this.options.parameters.length>0?"&":"")+"url="+encodeURIComponent(e)),this.options.nocache&&(this.options.parameters+=(this.options.parameters.length>0?"&":"")+"nocache="+timeStamp()),this.url=i,new Ajax.Request(this.url,this.options)}}),App.EditableText=Class.create(),App.EditableText.prototype={initialize:function(e,t){this.obj=e,this.options=Object.extend({able:!0,type:"text",defaultValue:"",showBtn:!1,overStyle:App.highlightStyle,outStyle:App.unHighlightStyle,maxSize:9999,maxLenght:9999,filter:function(e){return e}},t||{}),this.type=this.options.type,this.setOut(),this.buildText(),this.options.able&&(Event.observe(this.obj,"mouseover",this.setOver.bindAsEventListener(this)),Event.observe(this.obj,"mouseout",this.setOut.bindAsEventListener(this)),this.eventCancelBubble=App.cancelBubble.bindAsEventListener(this),Event.observe(this.obj,"click",this.eventCancelBubble),Event.observe(this.obj,"click",this.setToEditMode.bindAsEventListener(this)))},buildText:function(){this.data=this.obj.innerHTML.convertHTMLToText().convertTextToHTML()||this.options.defaultValue;var e="";"text"==this.type?(e+="<span>"+this.options.filter(this.data)+"</span>",e+='<span style="display:none"><input type="text" maxlength="'+this.options.maxLenght+'" /></span>',this.obj.innerHTML=e):"area"==this.type&&(e+="<div>"+this.options.filter(this.data)+"</div>",e+='<div style="display:none">',e+='<textarea style="overflow:auto;" maxlength="'+this.options.maxLenght+'"></textarea>',e+="</div>",this.obj.innerHTML=e),this.text=this.obj.firstChild,this.edit=this.text.nextSibling,this.inputElm=this.edit.firstChild},setOver:function(){return this.editing?!1:(Element.setStyle(this.obj,this.options.overStyle),this.obj.style.cursor="text",void 0)},setOut:function(){return this.editing?!1:(Element.setStyle(this.obj,this.options.outStyle),this.obj.style.cursor="default",void 0)},setToEditMode:function(){return this.editing?!1:(this.editing=!0,this.setOver(),this.initForm(),void 0)},initForm:function(){if(this.options.showBtn){var e="";e+='<span><input type="button" value="'+App.Lang.save+'" />',e+='<a href="javascript:void(0)">'+App.Lang.cancel+"</a></span>",new Insertion.After(this.obj,e);var t=this.obj.nextSibling,i=t.firstChild,s=t.lastChild;Event.observe(i,"click",this.finish.bindAsEventListener(this)),Event.observe(s,"click",this.cancel.bindAsEventListener(this))}var n=this.text,o=this.edit,a=this.inputElm;a.className=this.options.editStyle,a.style.border="none",Element.hide(n),Element.show(o),"text"==this.type?(a.value=this.data.convertHTMLToText(),Field.activate(a)):"area"==this.type&&(a.value=this.data.convertHTMLToText(),Field.setCursorToEnd(a)),this.refreshSize(),this.lastData=this.data,Event.observe(a,"keyup",this.refreshSize.bindAsEventListener(this)),this.options.showBtn||Event.observe(a,"blur",this.finish.bindAsEventListener(this)),"text"==this.type&&Event.observe(a,"keydown",this.onEnterDown.bindAsEventListener(this))},finish:function(){if(!this.editing)return!1;var e=this.inputElm.value;"text"==this.type?this.data=""===e?this.options.defaultValue||"":e.escapeHTML():"area"==this.type&&(this.data=""===e?this.options.defaultValue||"":e.convertTextToHTML()),Element.hide(this.edit),this.text.innerHTML=this.options.filter(this.data),Element.show(this.text),Element.hide(this.edit),this.options.showBtn&&this.hideBtn(),this.editing=!1,this.setOut(),this.data!=this.lastData&&this.options.onChange&&this.options.onChange(this.data)},cancel:function(){return this.editing?(this.text.innerHTML=this.options.filter(this.lastData),Element.hide(this.edit),Element.show(this.text),this.hideBtn(),this.editing=!1,this.setOut(),void 0):!1},hideBtn:function(){Element.remove(this.obj.nextSibling)},refreshSize:function(){if(!this.editing)return!1;var e=this.text,t=this.inputElm;Element.show(e),"text"==this.type?(e.style.whiteSpace="nowrap",e.innerHTML=t.value.escapeHTML(),t.style.width=Math.min(parseInt(e.offsetWidth)+20,this.options.maxSize)+"px",t.style.height=parseInt(e.offsetHeight)+"px"):"area"==this.type&&(e.innerHTML=t.value.convertTextToHTML(),t.style.width=parseInt(e.offsetWidth)-4+"px",t.style.height=Math.min(parseInt(e.offsetHeight)+20,this.options.maxSize)+"px"),Element.hide(e)},onEnterDown:function(){return this.editing?(window.event.keyCode==Event.KEY_RETURN&&this.finish(),void 0):!1}},App.Resizables={resizes:[],activeResizable:null,register:function(e){0===this.resizes.length&&(this.eventMouseUp=this.end.bindAsEventListener(this),this.eventMouseMove=this.resize.bindAsEventListener(this),this.eventKeypress=this.keyPress.bindAsEventListener(this),Event.observe(document,"mouseup",this.eventMouseUp),Event.observe(document,"mousemove",this.eventMouseMove),Event.observe(document,"keypress",this.eventKeypress)),this.resizes.push(e)},unregister:function(e){this.resizes=this.resizes.reject(function(t){return t==e}),0===this.resizes.length&&(Event.stopObserving(document,"mouseup",this.eventMouseUp),Event.stopObserving(document,"mousemove",this.eventMouseMove),Event.stopObserving(document,"keypress",this.eventKeypress))},activate:function(e){window.focus(),this.activeResizable=e},deactivate:function(){this.activeResizable=null},resize:function(e){if(this.activeResizable){var t=[Event.pointerX(e),Event.pointerY(e)];this._lastPointer&&this._lastPointer.inspect()==t.inspect()||(this._lastPointer=t,this.activeResizable.resize(e))}},end:function(e){this.activeResizable&&(this._lastPointer=null,this.activeResizable.end(e),this.activeResizable=null)},keyPress:function(e){this.activeResizable&&this.activeResizable.keyPress(e)}},App.Resizable=Class.create(),App.Resizable.prototype={initialize:function(e,t){if(this.element=$(e),this.options=Object.extend({able:!0,borderStart:0,border:10,zindex:1e3,constraint:!1,snap:!1,defaultWidth:null,defaultHeight:null},t||{}),this.options.addons){if(this.options.addons.constructor!=Array){var i=this.options.addons;this.options.addons=[],this.options.addons.push(i)}this.options.addons=$A(this.options.addons).map(function(e){if(e&&"string"==typeof e)var t=document.getElementsByClassName(e,this.element)[0];return t||(t=$(e)),t}.bind(this))}Element.cleanWhitespace(this.element),(t.defaultWidth||t.defaultHeight)&&this.resizeTo(t.defaultWidth,t.defaultHeight),this.eventMouseMove=this.over.bindAsEventListener(this),this.eventMouseDown=this.start.bindAsEventListener(this),Event.observe(this.element,"mousemove",this.eventMouseMove),Event.observe(this.element,"mousedown",this.eventMouseDown),App.Resizables.register(this)},destroy:function(){Event.stopObserving(this.element,"mousemove",this.eventMouseMove),Event.stopObserving(this.element,"mousedown",this.eventMouseDown),this.options.addons&&this.options.addons.each(function(e){e.style.width=e._originalWidth||"",e.style.height=e._originalHeight||"",e._originalWidth=null,e._originalHeight=null}.bind(this)),App.Resizables.unregister(this)},over:function(e){if(!this.options.able)return!1;if(App.Resizables.activeResizable)return!1;var t=this.getOffset(e),i=[this.element.offsetWidth,this.element.offsetHeight],s=this.options.constraint?["horizontal"==this.options.constraint,"vertical"==this.options.constraint]:[!0,!0];this.resizeXY=[0,1].map(function(e){var n;return n=this.options.borderStart instanceof Array?this.options.borderStart[e]:this.options.borderStart,s[e]&&t[e]<i[e]-n&&t[e]>i[e]-n-this.options.border}.bind(this)),this.element.style.cursor=this.resizeXY[0]||this.resizeXY[1]?(this.resizeXY[1]?"s":"")+(this.resizeXY[0]?"e":"")+"-resize":"default"},start:function(e){if(this.resizeXY&&(this.resizeXY[0]||this.resizeXY[1])){var t=this.getOffset(e),i=this.getDis(this.element),s=[parseInt(Element.getStyle(this.element,"width"))||this.element.offsetWidth-i[0],parseInt(Element.getStyle(this.element,"height"))||this.element.offsetHeight-i[1]];this.sm=[0,1].map(function(e){return s[e]-t[e]}),this.options.addons&&this.options.addons.each(function(e){e.addonDis=this.getDis(e),e.addonSize=[parseInt(Element.getStyle(e,"width"))||e.offsetWidth-e.addonDis[0],parseInt(Element.getStyle(e,"height"))||e.offsetHeight-e.addonDis[1]],e.sm=[0,1].map(function(i){return e.addonSize[i]-t[i]})}.bind(this)),App.Resizables.activate(this)}},resize:function(e){this.resizing||(this.resizing=!0,this.originalZ=parseInt(Element.getStyle(this.element,"z-index")||0),this.element.style.zIndex=this.options.zindex),this.draw(e),this.options.change&&this.options.change(this),App.cancelBubble(e)},draw:function(e){var t=this.getOffset(e),i=[0,1].map(function(e){return t[e]+this.sm[e]}.bind(this));this.options.snap&&(i="function"==typeof this.options.snap?this.options.snap(this.element,i[0],i[1]):this.options.snap instanceof Array?i.map(function(e,t){return Math.round(e/this.options.snap[t])*this.options.snap[t]}.bind(this)):i.map(function(e){return Math.round(e/this.options.snap)*this.options.snap}.bind(this)));var s=[0,1].map(function(e){return i[e]-this.sm[e]}.bind(this));this.options.addons&&this.options.addons.each(function(e){this.resizeXY[0]&&(e.style.width=Math.max(e.sm[0]+s[0],0)+"px"),this.resizeXY[1]&&(e.style.height=Math.max(e.sm[1]+s[1],0)+"px")}.bind(this)),this.resizeXY[0]&&(this.element.style.width=Math.max(i[0],0)+"px"),this.resizeXY[1]&&(this.element.style.height=Math.max(i[1],0)+"px")},end:function(e){this.resizing&&(this.resizing=!1,this.options.zindex&&(this.element.style.zIndex=this.originalZ),App.Resizables.deactivate(this),this.options.update&&this.options.update(this),App.cancelBubble(e))},resizeTo:function(e,t){var i=[e,t],s=this.getDis(this.element),n=[parseInt(Element.getStyle(this.element,"width"))||Element.getDimensions(this.element).width-s[0],parseInt(Element.getStyle(this.element,"height"))||Element.getDimensions(this.element).height-s[1]],o=[0,1].map(function(e){return i[e]-n[e]});this.options.addons&&this.options.addons.each(function(e){e.addonDis=this.getDis(e),e.addonSize=[parseInt(Element.getStyle(e,"width"))||Element.getDimensions(e).width-e.addonDis[0],parseInt(Element.getStyle(e,"height"))||Element.getDimensions(e).height-e.addonDis[1]],e.ss=[0,1].map(function(t){return e.addonSize[t]+o[t]}),e._originalWidth=e.style.width,e._originalHeight=e.style.height,i[0]&&(e.style.width=e.ss[0]+"px"),i[1]&&(e.style.height=e.ss[1]+"px")}.bind(this)),i[0]&&(this.element.style.width=Math.max(i[0],0)+"px"),i[1]&&(this.element.style.height=Math.max(i[1],0)+"px")},adjustSize:function(e,t){var i=this.getDis(this.element.firstChild),s=[parseInt(Element.getStyle(this.element.firstChild,"width"))+i[0]||Element.getDimensions(this.element.firstChild).width,parseInt(Element.getStyle(this.element.firstChild,"height"))+i[1]||Element.getDimensions(this.element.firstChild).height],n=this.getDisPadding(this.element);e&&(this.element.style.width=s[0]+n[0]+"px"),t&&(this.element.style.height=s[1]+n[1]+"px")},getOffset:function(e){var t=[Event.pointerX(e),Event.pointerY(e)],i=Position.cumulativeOffset(this.element),s=[0,1].map(function(e){return t[e]-i[e]});return s},getDisPadding:function(e){var t=[0+(parseInt(Element.getStyle(e,"padding-left"))||0)+(parseInt(Element.getStyle(e,"padding-right"))||0),0+(parseInt(Element.getStyle(e,"padding-top"))||0)+(parseInt(Element.getStyle(e,"padding-top"))||0)];return t},getDisBorder:function(e){var t=[0+(parseInt(Element.getStyle(e,"border-left-width"))||0)+(parseInt(Element.getStyle(e,"border-right-width"))||0),0+(parseInt(Element.getStyle(e,"border-top-width"))||0)+(parseInt(Element.getStyle(e,"border-bottom-width"))||0)];return t},getDis:function(e){var t=[0,1].map(function(t){return 0+this.getDisPadding(e)[t]+this.getDisBorder(e)[t]}.bind(this));return t},keyPress:function(e){!e.keyCode!=Event.KEY_ESC&&this.end(e)}},App.Requester={orderObj:null,floatObj:[],request:function(e,t){switch(e){case"new":case"del":case"newPage":case"delPage":case"editPageTitle":case"editPageColStyle":case"editPageIco":case"editPagePermit":case"editPageMods":case"editPage":case"pageOrder":case"customTheme":case"customThemeClean":case"theme":case"themeGW":case"styleAll":case"userData":this.doSend(e,t);break;case"edit":if(!t.options.id)return t.endSave(),void 0;this.doSend(e,t);break;case"order":this.doSend(e,t);break;case"float":0===this.floatObj.length&&(this.eventSendFloat=this.sendFloatAll.bind(this),Event.observe(window,"unload",this.eventSendFloat)),$A(this.floatObj).include(t.options.id)||this.floatObj.push(t.options.id);break;default:return}},sendFloatAll:function(){$A(this.floatObj).each(function(e){$(e)&&this.doSend("float",App.Modules.getObjByElement($(e)))}.bind(this))},doSend:function(e,t){LoadBar.show();var i="",s={};switch(e){case"userData":LoadBar.show(App.Lang.loadUserModule),i=App.Actions.userData+"m_list-ebi_"+_ebi+"/module/",App.Permit.editModule&&(i+="?o=true"),s={data:{okFun:App.UserData.response.bind(App.UserData)}};break;case"order":i=App.Actions.editMod,t=t||this.orderObj,s={parameters:"m=update&id="+t.id+"&type=order&data="+JSON.stringify(t.data),method:"post"};break;case"new":i=App.Actions.newMod,s={parameters:"m=save&type="+t.options.type+"&title="+escape(t.options.title)+"&data="+escape(JSON.stringify(t.options.data)||""),data:{okFun:App.Modules.doNewMod.bind(App.Modules)},method:"post"};break;case"edit":i=App.Actions.editMod,s={parameters:"m=update&id="+t.options.id+"&type="+t.options.type+"&title="+escape(t.options.title)+"&data="+escape(JSON.stringify(t.options.data)||""),data:{okFun:t.endSave.bind(t)},method:"post"};break;case"del":i=App.Actions.delMod,s={parameters:"m=delete&id="+t.options.id,data:{okFun:t.doClose.bind(t)}};break;case"newPage":i=App.Actions.newPage,s={parameters:"m=save&type="+t.options.type+"&title="+escape(t.options.title)+"&ico="+t.options.ico+"&colStyle="+t.options.colStyle+"&permit="+t.options.permit+"&widget="+JSON.stringify(t.options.widgets),data:{okFun:App.PageTabs.analyseNewPageTab.bind(App.PageTabs)},method:"post"};break;case"delPage":i=App.Actions.delPage,s={parameters:"m=delete&id="+t.options.id,data:{okFun:t.doClose.bind(t)}};break;case"editPageTitle":i=App.Actions.editPage,s={parameters:"m=update&id="+t.options.id+"&type="+t.options.type+"&title="+escape(t.newTitle),data:{okFun:t.doSaveTitle.bind(t)},method:"post"};break;case"editPageColStyle":i=App.Actions.editPage,s={parameters:"m=update&id="+t.options.id+"&colStyle="+escape(t.newColStyle),data:{okFun:t.doSetColStyle.bind(t)},method:"post"};break;case"editPageIco":i=App.Actions.editPage,s={parameters:"m=update&id="+t.options.id+"&ico="+escape(t.newIco),data:{okFun:t.doSetIcon.bind(t)},method:"post"};break;case"editPagePermit":i=App.Actions.editPage,s={parameters:"m=update&id="+t.options.id+"&permit="+escape(t.newPermit),data:{okFun:t.doSetPermit.bind(t)},method:"post"};break;case"editPageMods":i=App.Actions.editPage,s={parameters:"m=update&id="+t.options.id+"&mods="+JSON.stringify(t.newMods),method:"post"};break;case"editPage":i=App.Actions.editPage,s={parameters:"m=update&id="+t.options.id+"&title="+escape(t.options.title)+"&ico="+t.options.ico+"&colStyle="+t.options.colStyle+"&permit="+t.options.permit+"&mods="+JSON.stringify(t.options.mods),method:"post"};break;case"pageOrder":i=App.Actions.editPage,s={parameters:"m=update&layout="+JSON.stringify(t.data),method:"post"};break;case"theme":i=App.Actions.theme,s={parameters:"m=update&v=xml&theme="+t,data:{okFun:App.Themes.doSetTheme.bind(App.Themes)},method:"post"};break;case"themeGW":i=App.Actions.themeGW,s={parameters:"m=update&v=xml&greenThemeId="+t.themeCode+"&vcode="+t.vcode+"&vcodeEn="+escape(t.vcodeEn),data:{okFun:App.Framework.okSetThemeGW.bind(App.Framework),errorFun:App.Framework.errorSetThemeGW.bind(App.Framework)},method:"post"};break;case"customTheme":i=App.Actions.customTheme,s={parameters:"m=update&v=xml&"+t,data:{okFun:App.UserStyle.saveOk.bind(App.UserStyle)},method:"post"};break;case"customThemeClean":i=App.Actions.customTheme,s={parameters:"m=clean&v=xml",data:{okFun:App.UserStyle.cleanOk.bind(App.UserStyle)},method:"post"};break;case"styleAll":i=App.Actions.customTheme,s={parameters:"m=updateAll&v=xml&"+t,data:{okFun:App.UserStyle.styleAllOk.bind(App.UserStyle)},method:"post"};break;case"float":i=App.Actions.editMod,s={parameters:"id="+t.options.id+"&floating="+JSON.stringify(t.options.floating)};break;case"expand":i=App.Actions.editMod,s={parameters:"id="+t.options.id+"&isExpanded="+JSON.stringify(t.options.isExpanded)}}this.doRequest(i,s)},doRequest:function(e,t){t=Object.extend({method:"get",onSuccess:App.Response.analyse.bind(App.Response)},t||{}),new App.ImpFile(e,t)}},App.Response={analyse:function(e,t,i){if(LoadBar.hide(),!e)return this.connetionError();if(!e.responseText)return this.connetionError();if(0!==e.responseText.indexOf("<?"))return this.notWebFormed(e);if(!e.responseXML)return this.notWebFormed(e);var s=e.responseXML,n=Element.getChildValueByTagName(s,"code")[0],o=Element.getChildValueByTagName(s,"message")[0].trim();if(n===void 0||o===void 0)return this.notWebFormed(e);if(i&&i.defaultFun&&"function"==typeof i.defaultFun&&i.defaultFun(n,o),"200"==n){var a=s.getElementsByTagName("data")[0];if(!i||!i.okFun||"function"!=typeof i.okFun)return a;i.okFun(a)}else this.reportError(n,o),i&&i.errorFun&&"function"==typeof i.errorFun&&i.errorFun(n,o)},connetionError:function(){var e=App.Lang.error+": "+App.Lang.connetionError+"\n\n";return e+=App.Lang.cannotGetConnetion+"\n",e+=App.Lang.contactAdmin+"\n",alert(e),null},notWebFormed:function(e){var t=App.Lang.error+": "+App.Lang.analyseFileError+"\n\n";return t+=App.Lang.notWellFormed+"\n",t+=App.Lang.contactAdmin+"\n",t+="-------------------------\n",t+=100>=e.responseText.length?e.responseText:e.responseText.substring(0,100)+"...",alert(t),null},reportError:function(e,t){if("401"==e){var i=App.Lang.notLogon+"\n\n";if(i+=App.Lang.pleaseLogon,confirm(i))return location.href="http://blog.sohu.com/login/logon.do",void 0}if("403"==e){var i=App.Lang.noPermitOrNotLogon+"\n\n";if(i+=App.Lang.pleaseLogon,confirm(i))return location.href="http://blog.sohu.com/login/logon.do",void 0}else{var i="";i+=Info.htmlInfo(unescape(t),1," "),alert(i)}return null}},App.Framework={initialize:function(){if(App.Permit.ableLog&&$LT("App.Framework.initialize"),App.Permit.editHead,App.Framework.initNavBar(),App.Framework.indiBtnCntn=$("optionNav"),App.Framework.initThemeBtn(),App.Permit.editTheme){var e=window.location.hash;e&&e.length>1&&(e=e.split("#method_"),2==e.length&&e[1].length>0&&("settheme"==e[1]?Event.observe(window,"load",App.Framework.setTheme.bind(App.Framework)):"custtheme"==e[1]&&Event.observe(window,"load",App.UserStyle.customTheme.bind(App.UserStyle))))}App.UserData.load()},initNavBar:function(){App.Permit.ableLog&&$LT("App.Framework.initNavBar"),this._mainNavBar=$("mainNav");var e=[];e.push("<ul></ul>"),this._mainNavBar.innerHTML=e.join(""),e=null,this.elm_navBar=this._mainNavBar.firstChild},showNewPageBtn:function(){this.initNewPageBtn()},initNewPageBtn:function(){App.Permit.ableLog&&$LT("App.Framework.initNewPageBtn");var e=document.createElement("span");this.elm_newPageBtn=e,e.id="newPageBtn",e.innerHTML='<a href="javascript:void(0)" onfocus="this.blur()" onmousedown="CA.q(\'blog_addPage\');">'+App.Lang.newPageBtn+"</a>",this._mainNavBar.appendChild(e),Event.observe(e,"click",App.cancelBubble.bindAsEventListener(this)),Event.observe(e,"click",this.newPage.bindAsEventListener(this))},getNewPageMenuData:function(){var e=[];return $A(App.PageLib.lib).each(function(t){var i=!1,s="",n="";if(t.only&&App.PageTabs.getPTabByType(t.type).length>0&&(i=!0,s+='<img src="'+App.Actions.imgPath+'ico_tick_small.gif" />',n+=App.Lang.alreadyInUse),t.demo&&!App.Permit.ableDemo)throw $continue;if(t.dev&&!App.Permit.able3rdDev&&!App.Permit.ableDemo)throw $continue;if(t.toy&&!App.Permit.ableToy&&!App.Permit.ableDemo)throw $continue;var o={text:'<img src="'+(0!=t.ico?App.Actions.imgPath+App.Actions.icoShortPath+App.icoLib[t.ico]:App.Actions.imgPath+"spacer.gif")+'" alt="'+t.title+'" /> '+(t.title?t.title:App.Lang.customPage)+s+(t.toy?"*":"")+(t.demo?"**":""),title:t.desc+(i?" ("+n+")":""),action:App.PageTabs.newPageTab.bind(App.PageTabs),value:t.type,disabled:i};e.push(o)}.bind(this)),[{title:null,active:!0,data:e}]},newPage:function(){if(!this.newPageMenu){var e={menuData:this.getNewPageMenuData(),title:null,clsBtn:!1,autoCls:!0,autoActive:!1,btn:this.elm_newPageBtn,zIndex:500,sDivCss:"menuSub-div menuSub-div-newPage"};this.newPageMenu=new WinMenu(e)}this.newPageMenu.win.showing?this.newPageMenu.hide():this.newPageMenu.show()},updateNewPageMenuContent:function(){this.newPageMenu&&this.newPageMenu.updateMenuData(this.getNewPageMenuData())},initModContainer:function(){var e=$("mainWrapper"),t=[];t.push('<div id="innerMainWrapper">'),t.push('<div style="display:none"></div>'),t.push('<div id="modContainer">'),t.push("</div>"),t.push("</div>"),e.innerHTML=t.join(""),this.elm_modCtnInfo=e.firstChild.firstChild,this.elm_modCtn=e.firstChild.lastChild},initThemeBtn:function(){if(App.Permit.editTheme){App.Permit.ableLog&&$LT("App.Framework.initThemeBtn");var e=document.createElement("li");this.elm_themeBtn=e;var t='<a href="javascript:void(0)" onfocus="this.blur()" class="navEditTheme" onmousedown="CA.q(\'blog_editTheme\');">'+App.Lang.setTheme+"</a>";App.ThemeLib.hasNew&&(t+='<img src="'+App.Actions.imgPath+'ico_new.gif" alt="'+App.Lang.hasNewTheme+'" title="'+App.Lang.hasNewTheme+'" class="new" />'),e.innerHTML=t,this.indiBtnCntn.insertBefore(e,this.indiBtnCntn.firstChild),Event.observe(e,"click",this.setTheme.bindAsEventListener(this))
}else{var e=document.createElement("li");this.elm_userThemeBtn=e;var t='<a href="javascript:void(0)" onfocus="this.blur()" class="navEditTheme" onmousedown="CA.a(\'useTheme\');">使用此博客主题</a>';e.innerHTML=t,this.indiBtnCntn.insertBefore(e,this.indiBtnCntn.firstChild),Event.observe(e,"click",this.useTheme.bindAsEventListener(this))}},initNewModBtn:function(){App.Permit.ableLog&&$LT("App.Framework.initNewModBtn");var e=document.createElement("li");this.elm_newModBtn=e;var t='<a href="http://blog.sohu.com/manage/setting.do?m=newEdit" class="navSysOpt" >博客设置</a>&nbsp;&nbsp;&nbsp;<a href="javascript:void(0)" onfocus="this.blur()" class="navNewMod" onmousedown="CA.q(\'blog_addMod\');">'+App.Lang.newModule+"</a>";App.WidgetLib.hasNew&&(t+='<img src="'+App.Actions.imgPath+'ico_new.gif" alt="'+App.Lang.hasNewWidget+'" title="'+App.Lang.hasNewWidget+'" class="new" />'),e.innerHTML=t,this.indiBtnCntn.insertBefore(e,this.indiBtnCntn.firstChild),Event.observe(e,"click",this.newMod.bindAsEventListener(this))},getNewModMenuData:function(){var e=[];return $A(App.WidgetLib.gallery).each(function(t,i){if(t.demo&&!App.Permit.ableDemo)throw $continue;if(t.dev&&!App.Permit.able3rdDev&&!App.Permit.ableDemo)throw $continue;if(t.toy&&!App.Permit.ableToy&&!App.Permit.ableDemo)throw $continue;if("function"==t.type)var s=this._reqMods.bind(this,t);else{var s=[];$A(App.WidgetLib.lib).each(function(e){if(e.gal!=t.key)throw $continue;var i=!1,n="",o="";e.only&&App.UserData.getModByType(e.type)&&(i=!0,n+='<img src="'+App.Actions.imgPath+'ico_tick_small.gif" />',o+=App.Lang.alreadyInUse);var a=App.PageTabs.getActivePTab();if(e.private&&a&&0==a.options.permit&&(i=!0,n+='<img src="'+App.Actions.imgPath+'ico_warn_small.gif" />',o+=App.Lang.onlyInPrivatePage),e.demo&&!App.Permit.ableDemo)throw $continue;if(e.dev&&!App.Permit.able3rdDev&&!App.Permit.ableDemo)throw $continue;if(e.toy&&!App.Permit.ableToy&&!App.Permit.ableDemo)throw $continue;var p={text:'<img src="'+e.ico+'" alt="'+e.title+'" /> '+e.title+n+(e.toy?"<span>*</span>":"")+(e.demo?"**":"")+(e.isNew?'<img src="'+App.Actions.imgPath+'ico_new.gif" alt="'+App.Lang.newWidget+'" title="'+App.Lang.newWidget+'" class="new" />':""),title:e.desc+(i?" ("+o+")":e.sys?" ("+App.Lang.sysMod+")":""),action:App.Modules.newMod.bind(App.Modules),value:e.type,disabled:i};s.push(p)}.bind(this))}e.push({title:t.title+(t.hasNew||t.isNew?' <img src="'+App.Actions.imgPath+'ico_new.gif" alt="'+App.Lang.hasNewWidget+'" title="'+App.Lang.hasNewWidget+'" class="new" />':"")+(t.toy?"*":"")+(t.demo?"**":""),active:0==i,data:s})}.bind(this)),e},_reqMods:function(e,t){var i=this.newModMenu.options,s=i.menuData[t].isDivCssEx,n=document.createElement("div");return n.className=i.isDivCss+" clearfix",s&&Element.addClassName(n,s),n.innerHTML=App.Lang.loadModuleData,new Groj(e.dataUrl,{variable:"ow_recmd_widgets",onSuccess:this._getMods.bind(this,t),onFailure:this._notGetMods.bind(this,t)}),n},_getMods:function(e,t){if(t)if(0==t.status)if(t.data&&t.data.length){t.data;var i=[];t.data.each(function(e){i.push({text:'<img src="'+e.icon+'" alt="'+e.title+'" /> '+e.title,title:e.description,action:App.Modules.newOwMod.bind(App.Modules),value:e.link,disabled:!1})}),this.newModMenu.options.menuData[e].data=i,this.newModMenu.updateSubContent(e)}else this._notGetMods(e,this.newModMenu.options.noneInfo);else this._notGetMods(e,t.statusText);else this._notGetMods(e,App.Lang.notWellFormed)},_notGetMods:function(e,t){this.newModMenu.elm_subConts[e].innerHTML="string"==typeof trasport?t:t.statusText},newMod:function(){if(!this.newModMenu){var e=document.createElement("div");e.className="more",e.innerHTML=App.Lang.moreMod;var t={menuData:this.getNewModMenuData(),title:App.Lang.newModule,autoActive:!1,btn:this.elm_newModBtn,displace:[-210,0],noneInfo:App.Lang.noWidget,zIndex:500,sDivCss:"menuSub-div menuSub-div-newMod",elm_extendBottom:e};this.newModMenu=new WinMenu(t)}this.newModMenu.win.showing?this.newModMenu.hide():(this.setThemeMenu&&this.setThemeMenu.win.showing&&this.setThemeMenu.hide(),this.newModMenu.show())},updateNewModMenuContent:function(){this.newModMenu&&this.newModMenu.updateMenuData(this.getNewModMenuData())},getGreenWaySubMenuData:function(e){this.setThemeMenu.index=e;var t=document.createElement("div");t.className="menuInnerSub-div clearfix menuInnerSub-div-theme";var i=[];return i.push('<form method="post" onsubmit="return false;">'),i.push('<table style="clear:both;" cellpadding="2" cellspacing="5">'),i.push('<tr><td width="55" valign="top">'),i.push(App.Lang.greenWay+":"),i.push("</td><td>"),i.push(App.Lang.blogworldSohuGWThemes),i.push("</td></tr>"),i.push("<tr><td>"),i.push(App.Lang.gwCode+":"),i.push("</td><td>"),i.push('<input type="text" name="themeCode" class="text" /> <span style="font-weight:bold; cursor:pointer; padding:0px 4px; border:1px solid #ccc;" title="'+App.Lang.whatisGW+'">?</span>'),i.push("</td></tr>"),i.push('<tr style="display:none"><td>&nbsp;</td><td>'),i.push('<div class="infoBox" style="float:none;">'),i.push(App.Lang.gwInfoText),i.push("</div>"),i.push("</td></tr>"),i.push('<tr style="display:none;"><td>'),i.push(App.Lang.vCode+":"),i.push("</td><td>"),i.push("</td></tr>"),i.push("<tr><td>"),i.push('&nbsp;</td><td><input type="submit" class="button-submit" value="'+App.Lang.ok+'" />'),i.push('<span style="display:none;">'+App.Lang.loading+"</span>"),i.push("</td></tr>"),i.push("</table>"),i.push('<div className="clearfix" style="clear:both;"></div>'),i.push("</form>"),t.innerHTML=i.join(""),this.setThemeMenu.gwForm=t.firstChild,this.setThemeMenu.gwCodeIpt=t.firstChild.firstChild.rows[1].cells[1].firstChild,this.setThemeMenu.gwInfoBtn=t.firstChild.firstChild.rows[1].cells[1].lastChild,this.setThemeMenu.gwInfoText=t.firstChild.firstChild.rows[2],this.setThemeMenu.gwVCodeBox=t.firstChild.firstChild.rows[3],this.setThemeMenu.gwCodeSubmitBtn=t.firstChild.firstChild.rows[4].cells[1].firstChild,this.setThemeMenu.gwCodeSubmitLoadText=t.firstChild.firstChild.rows[4].cells[1].lastChild,this.setThemeMenu.greenWaySubMenu=t.firstChild.lastChild,Event.observe(this.setThemeMenu.gwForm,"submit",this.submitGreenWayCode.bindAsEventListener(this)),Event.observe(this.setThemeMenu.gwCodeIpt,"focus",this.showGreenWayVCode.bindAsEventListener(this)),Event.observe(this.setThemeMenu.gwInfoBtn,"click",function(){Element.toggle(this.setThemeMenu.gwInfoText)}.bind(this)),setTimeout(this.loadGreenWayData.bind(this,e),10),t},showGreenWayVCode:function(){if(""==this.setThemeMenu.gwVCodeBox.lastChild.innerHTML){var e=[];e.push('<input name="vcode" type="text" class="text" id="vcode" value="" size="4" maxlength="4" />&nbsp;'),e.push("<span></span>&nbsp;"),e.push('<a href="javascript:void(0)">'+App.Lang.cannotSeeVCode+"</a>"),this.setThemeMenu.gwVCodeBox.lastChild.innerHTML=e.join(""),this.setThemeMenu.gwVCodeCon=this.setThemeMenu.gwVCodeBox.lastChild.getElementsByTagName("span")[0],this.setThemeMenu.gwVCodeRefresh=this.setThemeMenu.gwVCodeBox.lastChild.lastChild,this.setThemeMenu.gwVCodeRefresh.onclick=function(){new VCode(this.setThemeMenu.gwVCodeCon)}.bind(this),new VCode(this.setThemeMenu.gwVCodeCon),Element.show(this.setThemeMenu.gwVCodeBox)}},submitGreenWayCode:function(){return Form.getInputs(this.setThemeMenu.gwForm,"text","themeCode")[0].value?Form.getInputs(this.setThemeMenu.gwForm,"text","vcode")[0].value?(this.setThemeMenu.gwCodeSubmitBtn.disabled=!0,Element.show(this.setThemeMenu.gwCodeSubmitLoadText),App.Requester.request("themeGW",{themeCode:Form.getInputs(this.setThemeMenu.gwForm,"text","themeCode")[0].value,vcode:Form.getInputs(this.setThemeMenu.gwForm,"text","vcode")[0].value,vcodeEn:Form.getInputs(this.setThemeMenu.gwForm,"hidden","vcodeEn")[0].value}),!1):(alert(App.Lang.plsEnterVCode),Form.getInputs(this.setThemeMenu.gwForm,"text","vcode")[0].focus(),!1):(alert(App.Lang.plsEnterGWCode),Form.getInputs(this.setThemeMenu.gwForm,"text","themeCode")[0].focus(),!1)},okSetThemeGW:function(e){var t=Element.getChildValueByTagName(e,"theme")[0]||"";t||this.errorSetThemeGW(),App.Themes.doSetThemeGW(t),this.endSubmitGreenWayCode(),this.setThemeMenu.gwCodeIpt.value="",this.setThemeMenu.gwVCodeBox.lastChild.innerHTML="",Element.hide(this.setThemeMenu.gwVCodeBox),this.setThemeMenu.hide(),this.updateGreenWayData()},errorSetThemeGW:function(){this.endSubmitGreenWayCode()},endSubmitGreenWayCode:function(){Form.getInputs(this.setThemeMenu.gwForm,"text","vcode")[0]&&(Form.getInputs(this.setThemeMenu.gwForm,"text","vcode")[0].value=""),new VCode(this.setThemeMenu.gwVCodeCon),this.setThemeMenu.gwCodeSubmitBtn.disabled=!1,Element.hide(this.setThemeMenu.gwCodeSubmitLoadText)},updateGreenWayData:function(){this.loadGreenWayData(this.setThemeMenu.index)},loadGreenWayData:function(e){var t=App.Actions.greenWay+"?mail="+getP()+"&nocache="+timeStamp();new LinkFile(t,{type:"script",callBack:{variable:"gw_codes",onLoad:this.showGreenWayData.bind(this,e),onFailure:function(){this.greenWaySubMenu.innerHTML=""}.bind(this)}})},showGreenWayData:function(e){if(gw_codes.length>0){if(!this.setThemeMenu.greenWaySubTitle){var t=document.createElement("div");this.setThemeMenu.greenWaySubTitle=t,t.style.clear="both",t.style.styleFloat="none",t.style.width="auto",t.style.padding="5px 0px",t.style.margin="0px 5px",t.style.borderTop="1px solid #ccc",this.setThemeMenu.greenWaySubMenu.parentNode.insertBefore(t,this.setThemeMenu.greenWaySubMenu)}this.setThemeMenu.greenWaySubTitle.innerHTML=App.Lang.myGWTheme+":"}this.setThemeMenu.greenWaySubMenu.innerHTML="",gw_codes.each(function(t,i){var s={id:t.id,grp:"gw",code:t.code};App.ThemeLib.add(s),s=App.ThemeLib.getTheme(s.id);var n={text:'<img src="'+(s.path||App.Actions.themePath+s.id+"/")+s.smp+'" alt="'+(s.name||s.id)+'" />',title:s.name||s.id,action:App.Themes.setTheme.bind(App.Themes),value:s.id,active:App.theme==s.id},o=document.createElement("div");o.className=this.options.sOutCss,n.active&&Element.addClassName(o,this.options.sActiveCss),n.disabled&&Element.addClassName(o,this.options.sDisableCss),o.innerHTML=n.text,n.text&&(o.title=n.title||n.text),Event.observe(o,"mouseover",function(){n.disabled||Element.addClassName(o,this.options.sOverCss)}.bind(this)),Event.observe(o,"mouseout",function(){n.disabled||(Element.removeClassName(o,this.options.sOverCss),Element.removeClassName(o,this.options.sDownCss))}.bind(this)),Event.observe(o,"mousedown",function(){n.disabled||Element.addClassName(o,this.options.sDownCss)}.bind(this)),Event.observe(o,"mouseup",function(){n.disabled||Element.removeClassName(o,this.options.sDownCss)}.bind(this)),Event.observe(o,"click",function(){n.disabled||(this.options.autoActive&&this.activeItem(e,i),n.action(n.value),this.options.click2cls&&this.hide())}.bind(this)),this.greenWaySubMenu.appendChild(o)}.bind(this.setThemeMenu))},getCustomThemeSubMenuData:function(e){this.setThemeMenu.index=e;var t=document.createElement("div");t.className="menuInnerSub-div clearfix menuInnerSub-div-theme";var i="";return i+='<input type="button" style="margin:5px 0 5px 20px;" value="'+App.Lang.customTheme+'" />',i+='<input type="button" style="margin:5px 0 5px 20px;" value="'+App.Lang.shareTheme+'" />',t.innerHTML=i,this.setThemeMenu.cusThemeBtn=t.firstChild,this.setThemeMenu.shareThemeBtn=t.childNodes[1],Event.observe(this.setThemeMenu.cusThemeBtn,"click",function(){App.UserStyle.customTheme(),this.setThemeMenu.hide()}.bind(this)),Event.observe(this.setThemeMenu.shareThemeBtn,"click",App.UserStyle.shareTheme.bind(App.UserStyle)),t},getSetThemeMenuData:function(){var e=[];return $A(App.ThemeLib.group).each(function(t,i){if(t.demo&&!App.Permit.ableDemo)throw $continue;if(t.dev&&!App.Permit.able3rdDev&&!App.Permit.ableDemo)throw $continue;if(t.toy&&!App.Permit.ableToy&&!App.Permit.ableDemo)throw $continue;if("gw"==t.key)var s=this.getGreenWaySubMenuData.bind(this);else if("customTheme"==t.key)var s=this.getCustomThemeSubMenuData.bind(this);else if("function"==t.type)var s=this._reqThemes.bind(this,t);else{var s=[];$A(App.ThemeLib.lib).each(function(e){if(e.grp!=t.key)throw $continue;if(e.demo&&!App.Permit.ableDemo)throw $continue;if(e.dev&&!App.Permit.able3rdDev&&!App.Permit.ableDemo)throw $continue;if(e.toy&&!App.Permit.ableToy&&!App.Permit.ableDemo)throw $continue;var i='<img src="'+(e.path||App.Actions.themePath+e.id+"/")+e.smp+'" alt="'+(e.name||e.id)+'" />';e.isNew&&(i+='<img src="'+App.Actions.imgPath+'ico_new.gif" alt="'+App.Lang.newTheme+'" title="'+App.Lang.newTheme+'" class="new" />');var n={text:i,title:e.name||e.id,action:App.Themes.setTheme.bind(App.Themes),value:e.code||e.id,active:App.theme==e.id};s.push(n)}.bind(this))}var n=null;t.more&&t.moreUrl&&(n='<div class="more" id="'+t.moreId+'" style="display:none;"><a href="'+t.moreUrl+'" target="_blank">'+t.moreTitle+"</a></div>"),e.push({title:t.title+(t.hasNew||t.isNew?' <img src="'+App.Actions.imgPath+'ico_new.gif" alt="'+App.Lang.hasNewTheme+'" title="'+App.Lang.hasNewTheme+'" class="new" />':"")+(t.toy?"*":"")+(t.demo?"**":""),active:0==i,isDivCssEx:"menuInnerSub-div-theme",itDivExtCss:t.itDivExtCss,data:s,more:n})}.bind(this)),e},_reqThemes:function(e,t){var i=this.setThemeMenu.options,s=i.menuData[t].isDivCssEx,n=document.createElement("div"),o=e.dataUrl.split("vn=")[1].split("&")[0];return n.className=i.isDivCss+" clearfix",s&&Element.addClassName(n,s),n.innerHTML=App.Lang.loadModuleData,new Groj(e.dataUrl,{variable:o,onSuccess:this._getThemes.bind(this,t,o),onFailure:this._notGetThemes.bind(this,t)}),n},_getThemes:function(e,t,i){if(i)if(0==i.status)if("ow_my_themes"==t&&i.data.length>8?$("ow_my_themes_more").show():"ow_latest_themes"==t&&16==i.data.length&&$("ow_latest_themes_more").show(),i.data&&i.data.length){i.data;var s=[];i.data.each(function(e){var i='<img src="'+e.thumbnail+'" alt="'+e.title+'" />',n=e.link;action=App.Themes.setOT.bind(App.Themes),t="string"==typeof t?t:"","ow_my_themes"==t?(i+='<span class="span_jsy">使用</span>',n=e.id,action=App.Themes.setTheme.bind(App.Themes)):"ow_latest_themes"==t&&(i+='<span class="span_jgm"><font>购买</font><b>￥</b>'+e.price+"</span>"),s.push({text:i,title:e.title,action:action,value:n,disabled:!1})}),this.setThemeMenu.options.menuData[e].data=s,this.setThemeMenu.updateSubContent(e)}else this._notGetThemes(e,this.setThemeMenu.options.noneInfo);else this._notGetThemes(e,i.statusText);else this._notGetThemes(e,App.Lang.notWellFormed)},_notGetThemes:function(e,t){this.setThemeMenu.elm_subConts[e].innerHTML="string"==typeof t?t:t.statusText},useTheme:function(){if(!isLogin())return setTimeout(function(){location.href=loginPath()},0),void 0;var e=App.UserStyle.getThemeType();return 2==e?(new PopWin({type:"alert",content:"此主题为收费主题，请先去收费模板专区购买！"}),void 0):(new PopWin({type:"confirm",content:"确定要使用此博客主题吗？",okAction:function(){var t;switch(e){case 1:t="clean=true&theme="+App.UserStyle.getThemeId();break;case 3:t="clean=true&ot=false&theme="+App.UserStyle.getThemeId()+"&"+App.UserStyle.getCustomSets(!0);break;case 4:t="clean=true&ot=true&theme="+App.UserStyle.getThemeId()+"&"+App.UserStyle.getCustomSets(!0)}App.Requester.request("styleAll",t)}}),void 0)},setTheme:function(){if(!this.setThemeMenu){var e=document.createElement("div");e.className="more",e.innerHTML=App.Lang.moreTheme;var t={menuData:this.getSetThemeMenuData(),title:App.Lang.setTheme,btn:this.elm_themeBtn,displace:[-495,0],zIndex:500,allInOne:!0,sDivCss:"menuSub-div menuSub-div-theme",elm_extendBottom:e};this.setThemeMenu=new WinMenu(t)}this.setThemeMenu.win.showing?this.setThemeMenu.hide():(this.newModMenu&&this.newModMenu.win.showing&&this.newModMenu.hide(),this.setThemeMenu.show())}},Starter.add(App.Framework.initialize),App.UserData={userModulesData:[],userModulseOrder:null,loaded:!1,load:function(){App.Permit.ableLog&&$LT("App.UserData.load"),this.userModulesData=[],this.userModulseOrder=null,"undefined"!=typeof preloadUserData&&preloadUserData?(App.Permit.ableLog&&$LT("App.UserData load from page"),$A(preloadUserData).each(function(e){"order"==e.type?this.userModulseOrder=e:this.userModulesData.push(e)}.bind(this)),this.startInitModContainer()):App.Requester.request("userData")},response:function(e){this.analyse(e)},analyse:function(e){if(App.Permit.ableLog&&$LT("App.UserData.analyse"),e){var t=e.getElementsByTagName("mod");$A(t).each(function(e){var t=this.getModData(e);"order"==t.type?this.userModulseOrder=t:this.userModulesData.push(t)}.bind(this)),this.startInitModContainer()}},startInitModContainer:function(){App.Framework.initModContainer(),this.createPage()},getModData:function(e){var t={id:e.getAttribute("id")||"",type:e.getAttribute("type")||"",isExpanded:e.getAttribute("isExpanded")?JSON.parse(e.getAttribute("isExpanded")):!0,share:e.getAttribute("share")?JSON.parse(e.getAttribute("share")):!0,floating:e.getAttribute("floating")?JSON.parse(e.getAttribute("floating")):!1,title:Element.getChildValueByTagName(e,"title")[0]||"",data:Element.getChildValueByTagName(e,"data")[0]?JSON.parse(Element.getChildValueByTagName(e,"data")[0])||Element.getChildValueByTagName(e,"data")[0]:""};return t},addMod:function(e){this.userModulesData.push(e)},delMod:function(e){this.userModulesData=this.userModulesData.reject(function(t){return t.id==e.id})},createPage:function(){LoadBar.show(App.Lang.createAllPages);var e="";if(location.hash){var t=location.hash;0==t.indexOf("#"+App.pageHash_prefix)&&(e=t.substring(2))}var i=!1;$A(this.userModulseOrder.data).each(function(t){if(!t.id)throw $continue;if(!App.Permit.ableViewPvtPageTab&&0!=t.permit)throw $continue;(null==e||""==e)&&(e=t.id);var s=App.PageLib.getPage(t.type);s||(s=App.PageLib.getPage("0"));var n=!1;(e==t.id||e==s.hash)&&(n=!0);var o={id:t.id,type:t.type||"0",ico:t.ico||58,title:t.title||App.Lang.defaultPageTitle,colStyle:t.colStyle||App.defaultColStyle,mods:t.mods||[],permit:t.permit||0,isActive:n&&!i,createMods:App.createOnlyFirstPageMod?n&&!i:!0};new App.PageTab(o),n&&(i=!0)}),LoadBar.hide(),App.Permit.editPageTab&&(App.Framework.showNewPageBtn(),App.PageTabs.regPageTabObservers(),App.Framework.initNewModBtn()),App.PageTabs.listenHash()},getModByType:function(e){return this.userModulesData.find(function(t){return t.type==e})}},App.PageTabs={pTabs:[],register:function(e){$(e.options.placeIn).appendChild(e.element),this.pTabs.push(e)},unregister:function(e){var t=0;this.pTabs=this.pTabs.reject(function(i,s){return i==e&&(t=s),i==e}),t--,0>t&&(t=0),t>=this.pTabs.length&&(t=this.pTabs.length-1),this.pTabs[t].active(),App.Framework.updateNewPageMenuContent()},disActiveAll:function(){this.pTabs.each(function(e){e.disActive()})},getActivePTab:function(){return this.pTabs.find(function(e){return e.options.isActive})},getPrivateTabs:function(){return this.pTabs.findAll(function(e){return 0!=e.options.permit})},getPublicTabs:function(){return this.pTabs.findAll(function(e){return 0==e.options.permit})},getProfileTabs:function(){return this.pTabs.findAll(function(e){return 2==e.options.permit})},getPTabByElement:function(e){return this.pTabs.find(function(t){return t.element==e})},getPTabByType:function(e){return this.pTabs.findAll(function(t){return t.options.type==e})},hideOptMenuAll:function(){this.pTabs.each(function(e){e.hideOptMenu()})},setHash:function(e){this.stopListenHash();var t="";if(e)t="0"!=e.pl.type&&e.pl.hash?e.pl.hash:e.options.id;else{var i=this.pTabs.find(function(e){return e.options.isActive});i&&(t="0"!=i.pl.type&&i.pl.hash?i.pl.hash:i.options.id)}this.activePage=t,location.href="#t"+t,this.listenHash()},getHash:function(){var e="";if(location.hash&&0==location.hash.indexOf("#"+App.pageHash_prefix)&&(e=location.hash.substring(2)),e==App.profilePageHashId&&this.getProfileTabs().length>0&&(e=this.getProfileTabs()[0].options.id),e!=this.activePage&&e){var t=this.pTabs.find(function(t){var i=App.PageLib.getPage(t.options.type);return i||(i=App.PageLib.getPage("0")),t.options.id==e||i.hash==e});void 0!==t&&t||(t=this.pTabs[0]),t!==void 0&&t&&t.active(!0),this.activePage=e}},listenHash:function(){this.hashListener&&this.stopListenHash(),this.hashListener=setInterval(this.getHash.bind(this),1e3)},stopListenHash:function(){this.hashListener&&(clearInterval(this.hashListener),this.hashListener=null)},getNewPageTabsOrder:function(){var e=[],t=$A(App.Framework.elm_navBar.getElementsByTagName("li"));return $A(t).each(function(t){t.id&&e.push(t.id)}),e},savePageTabsOrder:function(){this.newOrder=this.getNewPageTabsOrder(),JSON.stringify(this.newOrder)!=JSON.stringify(this.oldOrder)&&(App.Requester.request("pageOrder",{data:this.newOrder}),this.oldOrder=this.newOrder)},regPageTabObservers:function(){if(App.Permit.editPageTab){var e={tag:"li",only:"pTab",targeting:!0,overlap:"horizontal",constraint:"horizontal",ghosting:!0,onUpdate:this.savePageTabsOrder.bind(this)};Sortable.create(App.Framework.elm_navBar,e),this.regDrops(),this.oldOrder=this.getNewPageTabsOrder()}},disRegPageTabObservers:function(){Sortable.destroy(App.Framework.elm_navBar)},drag_snap:function(e,t){var i=Math.max(0,Math.min(e,screen.availWidth)),s=Position.positionedOffset(App.Framework.elm_navBar),n=Math.max(s[1],Math.min(t,s[1]+App.Framework.elm_navBar.offsetHeight));return[i,n]},regDrops:function(){this.pTabs.each(function(e){e.regDrop()})},showModCtnInfo:function(e){return e.options.isActive?0===e.options.mods.flatten().length?(App.Framework.elm_modCtnInfo.innerHTML=App.Permit.editPageTab?App.Lang.goAddModPageInfo:App.Lang.noModPageInfo,App.Framework.elm_modCtnInfo.className="modCtnInfo-noMod clearfix",Element.show(App.Framework.elm_modCtnInfo),void 0):e.pl&&e.pl.info&&e.pl.info.length&&isMyBlog()?(App.Framework.elm_modCtnInfo.innerHTML=e.pl.info,App.Framework.elm_modCtnInfo.className=0!=e.options.permit?"modCtnInfo-private clearfix":"modCtnInfo-private public clearfix",Element.show(App.Framework.elm_modCtnInfo),void 0):(this.hideModCtnInfo(),void 0):void 0},hideModCtnInfo:function(){Element.hide(App.Framework.elm_modCtnInfo)},newPageTab:function(e){if(e){if(this.pTabs.length>=App.maxPageTabCount){var t={type:"alert",title:App.Lang.error,content:App.Lang.tooManyPages};return new PopWin(t),void 0}if(this.newPL=App.PageLib.getPage(e),this.newPW_all=[],this.newPW_okW=[],this.newPW_noW=[],this.newPW_noM=[],$A(this.newPL.widgets).each(function(e,t){this.newPW_all.push([]),this.newPW_okW.push([]),this.newPW_noW.push([]),e.each(function(e){var i=App.WidgetLib.getWidget(e);if(!i)throw $continue;if((i.only||i.sys)&&App.UserData.getModByType(e)){var s=App.UserData.getModByType(e);this.newPW_all[t].push(s.id),this.newPW_noW[t].push(e),this.newPW_noM.push(s.id)}else this.newPW_all[t].push(e),this.newPW_okW[t].push(e)}.bind(this))}.bind(this)),App.Permit.ableLog&&($LT("App.PageTabs.newPageTab\n"),$LR("newPW_all: "+JSON.stringify(this.newPW_all)),$LR("newPW_okW: "+JSON.stringify(this.newPW_okW)),$LR("newPW_noW: "+JSON.stringify(this.newPW_noW)),$LR("newPW_noM: "+JSON.stringify(this.newPW_noM))),this.newPW_noM.length>0){var i="";i+=App.Lang.beSboutToAddNewPage,i+="["+this.newPL.title+"], ",i+=App.Lang.itContaintMods+":\n",$A(this.newPL.widgets.flatten()).each(function(e,t){i+="["+App.WidgetLib.getWidget(e).title+"]",this.newPL.widgets.flatten().length-1>t&&(i+=", ")}.bind(this)),i+="\n\n",i+=App.Lang.hasUsingTheseMods+":\n",$A(this.newPW_noW.flatten()).each(function(e,t){i+="["+App.WidgetLib.getWidget(e).title+"]",this.newPW_noW.flatten().length-1>t&&(i+=", ")}.bind(this)),i+="\n\n",i+=App.Lang.whetherMoveMods;var t={type:"confirm",content:i,focus:!1,width:"350",okText:App.Lang.moveMod,okAction:this.reqNewPageTab.bind(this),okData:!0,cancelText:App.Lang.notMoveMod,cancelAction:this.reqNewPageTab.bind(this),cancelData:!1,closeAction:Prototype.emptyFunction};new PopWin(t)}else this.reqNewPageTab(!0)}},reqNewPageTab:function(e){this.opt4newPageTab={type:this.newPL.type,title:this.newPL.title||App.Lang.aNewPage,ico:null!=this.newPL.ico?this.newPL.ico:0,colStyle:this.newPL.colStyle||App.defaultColStyle,permit:this.newPL.permit||0,widgets:this.newPW_all||[]},e?$A(this.newPW_noM).each(function(e){var t=App.Modules.getObjById(e);if(!t)throw $contunue;var i=t.options.page;t.destroy(),i.saveModsOrder("noToServer")}):this.opt4newPageTab.widgets=this.newPW_okW||[],App.Requester.request("newPage",{options:this.opt4newPageTab})},analyseNewPageTab:function(e){if(App.Permit.ableLog&&$LT("App.PageTabs.analyseNewPageTab"),e){var t=e.getElementsByTagName("mod");this.newPageData=null,$A(t).each(function(e){var t=App.UserData.getModData(e);"order"==t.type?(this.newPageData=t.data,App.UserData.userModulseOrder.data.push(t.data)):App.UserData.userModulesData.push(t)}.bind(this)),this.doNewPageTab()}},doNewPageTab:function(){var e={};this.newPageData&&(e=this.newPageData[0]);var t=Object.extend(this.opt4newPageTab,e),i=new App.PageTab(t);this.regPageTabObservers(),i.active(),App.Framework.updateNewPageMenuContent(),this.newPL.ableSetTit&&i.editTitle()}},App.PageTab=Class.create(),App.PageTab.prototype={initialize:function(e){App.Permit.ableLog&&$LT("App.PageTab[id:"+e.id+"] initialize"),this.options=Object.extend({id:null,type:"0",ico:0,title:"",colStyle:null,mods:[],permit:0,isActive:!1,createMods:!1,placeIn:App.Framework.elm_navBar,sDivCss:"menuSub-div",imtDivCss:"subMenu-maintitle",itDivCss:"subMenu-title",isDivCss:"menuInnerSub-div",sOutCss:"menuSub-out",sOverCss:"menuSub-over",sDownCss:"menuSub-down",sDisableCss:"menuSub-disabled",sActiveCss:"menuSub-active"},e||{}),this.pl=App.PageLib.getPage(this.options.type),this.pl||(this.pl=App.PageLib.getPage("0")),!this.pl.ableSetTit&&this.pl.title&&(this.options.title=this.pl.title),!this.pl.ableSetCol&&this.pl.colStyle&&(this.options.colStyle=this.pl.colStyle),!this.pl.ableSetIco&&this.pl.ico&&(this.options.ico=this.pl.ico),this.pl.ableSetPer||(this.options.permit=this.pl.permit),this.build(),App.PageTabs.register(this),App.Permit.editPageTab&&this.regDrop(),this.buildModCtn(),this.options.createMods&&this.createMods()},destroy:function(){this.element&&(this.disActive(),this.disRegDrop(),this.removeMods(),this.modCtn.destroy(),Element.remove(this.element),this.element=null,setTimeout(function(){App.PageTabs.unregister(this)}.bind(this),10))},build:function(){App.Permit.ableLog&&$LT("App.PageTab[id:"+this.options.id+"] build");var e=document.createElement("li");this.element=e,e.id=this.options.id,Element.addClassName(e,"pTab"),0!=this.options.permit&&Element.addClassName(e,"private"),this.options.isActive&&Element.addClassName(e,"active"),App.PageTabs.showModCtnInfo(this);var t=[];this.options.ico||(this.options.ico=0);var i=this.options.title?this.options.title.escapeHTML():"";t.push('<img class="pageIcon" src="'+(0!=this.options.ico?App.Actions.imgPath+App.Actions.icoShortPath+App.icoLib[this.options.ico]:App.Actions.imgPath+"spacer.gif")+'" alt="'+(this.options.ico?i:"")+'" />'),t.push('<span class="pageTitle"'+(this.options.isActive&&App.Permit.editPageTab&&this.pl.ableSetTit?' title="'+App.Lang.clk2chgPageName+'"':"")+">"+i+"</span>"),App.Permit.editPageTab&&(t.push('<img class="pageCls" src="'+App.Actions.imgPath+'spacer.gif" alt="'+App.Lang.delPage+'" title="'+App.Lang.delPage+'" />'),t.push('<img class="pageOpt" src="'+App.Actions.imgPath+'spacer.gif" alt="'+App.Lang.setPageOpt+'" title="'+App.Lang.setPageOpt+'" />')),e.innerHTML=t.join(""),t=null,this.eventCancelBubble=App.cancelBubble.bindAsEventListener(this),this.elm_ico=e.firstChild,this.elm_title=e.childNodes[1],e.childNodes[2]&&(this.elm_del=e.childNodes[2]),e.childNodes[3]&&(this.elm_opt=e.childNodes[3]),0==this.options.ico&&(this.elm_ico.style.width="1px"),!this.pl.ableDel&&this.elm_del&&(this.elm_del.style.visibility="hidden"),!this.pl.ableSetOpt&&this.elm_opt&&(this.elm_opt.style.visibility="hidden"),this.eventActive=function(){this.options.isActive||this.active()}.bindAsEventListener(this),Event.observe(this.element,"click",this.eventActive),App.Permit.editPageTab&&(this.pl.ableSetTit&&(Event.observe(this.elm_title,"mouseover",function(){this.options.isActive&&Element.addClassName(this.elm_title,"pageTitleHover")}.bind(this)),Event.observe(this.elm_title,"mouseout",function(){this.options.isActive&&Element.removeClassName(this.elm_title,"pageTitleHover")}.bind(this)),Event.observe(this.elm_title,"mousedown",this.eventCancelBubble),this.eventEditTitle=function(e){this.options.isActive&&(this.editTitle(),App.cancelBubble(e))}.bindAsEventListener(this),Event.observe(this.elm_title,"click",this.eventEditTitle)),Event.observe(this.elm_del,"mouseover",function(){this.options.isActive&&Element.addClassName(this.elm_del,"pageClsHover")}.bind(this)),Event.observe(this.elm_del,"mouseout",function(){this.options.isActive&&Element.removeClassName(this.elm_del,"pageClsHover")}.bind(this)),Event.observe(this.elm_del,"mousedown",this.eventCancelBubble),this.eventClose=this.close.bindAsEventListener(this),Event.observe(this.elm_del,"click",this.eventClose),Event.observe(this.elm_opt,"mouseover",function(){this.options.isActive&&Element.addClassName(this.elm_opt,"pageOptHover")}.bind(this)),Event.observe(this.elm_opt,"mouseout",function(){this.options.isActive&&Element.removeClassName(this.elm_opt,"pageOptHover")}.bind(this)),Event.observe(this.elm_opt,"mousedown",this.eventCancelBubble),this.eventSetOpt=this.setOpt.bindAsEventListener(this),Event.observe(this.elm_opt,"click",this.eventSetOpt),this.options.isActive||(Element.hide(this.elm_del),Element.hide(this.elm_opt)))},buildModCtn:function(){var e={colStyle:this.options.colStyle,isActive:this.options.isActive,placeIn:App.Framework.elm_modCtn};this.modCtn=new App.ModContainer(e),this.modCtn.pageTab=this},removeMods:function(){$A(App.Modules.modules).select(function(e){return e.options.page==this}.bind(this)).each(function(e){App.UserData.delMod(e.options),e.destroy()}),App.Framework.updateNewModMenuContent()},createMods:function(){this.loaded=!0,LoadBar.show(App.Lang.createAllModules);var e=100;$A(this.options.mods).each(function(e,t){$A(e).each(function(e,i){$A(App.UserData.userModulesData).each(function(s){if(s.id==e){var n={page:this,placeIn:this.modCtn.cols[t]?this.modCtn.cols[t]:this.modCtn.cols[this.modCtn.cols.length-1],fastLoad:i},o=Object.extend(s,n);if(0==this.options.permit&&App.WidgetLib.getWidget(o.type)&&App.WidgetLib.getWidget(o.type).private){if(App.Permit.editModule){var a=new App.Module(o,!0);setTimeout(function(){a.doClose()},0)}}else var a=new App.Module(o,!0);throw $break}}.bind(this))}.bind(this))}.bind(this)),LoadBar.hide(),setTimeout(this.regModObservers.bind(this),e),e+=100},getPageTabData:function(){var e={id:this.options.id,title:this.options.title,ico:this.options.ico,permit:this.options.permit,colStyle:this.options.colStyle,mods:this.getModsOrder()};return e},getModsOrder:function(){if(!this.loaded)return this.options.mods;var e=[],t=$A(this.modCtn.cols);return $A(t).each(function(t){var i=[];$A(t.childNodes).each(function(e){e.tagName&&e.tagName.toUpperCase()=="div".toUpperCase()&&Element.hasClassName(e,"mod")&&e.id&&i.push(e.id)}),e.push(i)}),e},saveModsOrder:function(e){this.newMods=this.getModsOrder(),("doToServer"==e||JSON.stringify(this.newMods)!=JSON.stringify(this.options.mods))&&(this.options.mods=this.newMods,"noToServer"!=e&&App.Requester.request("editPageMods",this),App.PageTabs.showModCtnInfo(this))},regModObservers:function(){if(App.Permit.sortable){var e={tag:"div",handle:"t",handleTag:"td",only:"mod",dropOnEmpty:!0,targeting:!0,containment:this.modCtn.cols,constraint:!1,snap:this.drag_snap,starteffect:function(e){Browser.ua.indexOf("ie")>=0?new Effect.Opacity(e,{duration:0,from:1,to:.7}):new Effect.Opacity(e,{duration:.2,from:1,to:.7});var t=$A(e.getElementsByTagName("object")),i=$A(e.getElementsByTagName("embed"));i=i.reject(function(e){return"object"==e.parentNode.tagName.toLowerCase()}),t=t.concat(i);var s=$A(e.getElementsByTagName("iframe")),n=t.concat(s);$A(n).each(function(e){var t=document.createElement("div");t.className="divFlashSpacer";var i=e.width||e.offsetWidth,s=e.height||e.offsetHeight;t.style.width=isNaN(i)?i:i+"px",t.style.height=isNaN(s)?s:s+"px",t.style.overflow="hidden",e.parentNode.insertBefore(t,e),Element.hide(e)
})},endeffect:function(e){Browser.ua.indexOf("ie")>=0?new Effect.Opacity(e,{duration:0,from:.7,to:1}):new Effect.Opacity(e,{duration:.2,from:.7,to:1});var t=$A(e.getElementsByTagName("object")),i=$A(e.getElementsByTagName("embed"));i=i.reject(function(e){return"object"==e.parentNode.tagName.toLowerCase()}),t=t.concat(i);var s=$A(e.getElementsByTagName("iframe")),n=t.concat(s);$A(n).each(function(e){Element.show(e)}),$A(document.getElementsByClassName("divFlashSpacer",e,"div")).each(function(e){Element.remove(e)})}};$A(this.modCtn.cols).each(function(t){e=Object.extend(e,{onUpdate:this.saveModsOrder.bind(this)}),Sortable.create(t,e)}.bind(this))}},disRegModObservers:function(){$A(this.modCtn.cols).each(function(e){Sortable.destroy(e)})},drag_snap:function(e,t){var i=Math.max(0,Math.min(e,screen.availWidth)),s=Math.max(30,t);return[i,s]},active:function(e){this.options.isActive||(App.PageTabs.disActiveAll(),this.options.isActive=!0,Element.addClassName(this.element,"active"),App.PageTabs.showModCtnInfo(this),this.pl.ableSetTit&&App.Permit.editPageTab&&(this.elm_title.title=App.Lang.clk2chgPageName),this.elm_del&&this.elm_opt&&(Element.show(this.elm_del),Element.show(this.elm_opt)),this.modCtn.active(),this.loaded||this.createMods(),e||App.PageTabs.setHash(this),App.Framework.updateNewModMenuContent())},disActive:function(){this.options.isActive&&(this.options.isActive=!1,Element.removeClassName(this.element,"active"),this.elm_title.title="",this.elm_del&&this.elm_opt&&(Element.hide(this.elm_del),Element.hide(this.elm_opt)),this.modCtn.disActive(),this.hideOptMenu(),this.saveTitle())},editTitle:function(){Element.hide(this.elm_ico),Element.hide(this.elm_title),Element.hide(this.elm_del),Element.hide(this.elm_opt);var e=document.createElement("input");this.elm_titleIpt=e,e.type="text",e.value=this.options.title,e.style.width=12*this.options.title.length+20+"px",this.element.appendChild(e),e.focus(),e.select(),Event.observe(e,"keydown",this.onTitleEnterDown.bindAsEventListener(this)),e.onkeyup=function(){this.style.width=12*this.value.length+20+"px"},Event.observe(e,"blur",this.saveTitle.bindAsEventListener(this)),this.editingTitle=!0},onTitleEnterDown:function(e){"other"!=Browser.ua&&13==e.keyCode&&this.saveTitle()},saveTitle:function(){if(this.editingTitle){this.editingTitle=!1;var e=this.elm_titleIpt.value;if(e=""==e.trim()?this.options.title:e.convertTextToHTML(),e==this.options.title)return this.endEditTitle(),void 0;if(getTureLength(e)>12){var t=App.Lang.pageTitleTooLong+"("+getTureLength(e)+App.Lang.byte+")";return t+="\n"+App.Lang.reduceTo+"12"+App.Lang.byte+"(6"+App.Lang.chsWord+")",t+="\n\n",t+=App.Lang.confirmToEdit,t+="\n",t+=App.Lang.cannelThisOperation,confirm(t)?(this.elm_titleIpt.focus(),this.elm_titleIpt.select(),this.editingTitle=!0):this.endEditTitle(),void 0}this.newTitle=e,App.Requester.request("editPageTitle",this)}},doSaveTitle:function(e){var t=this.newTitle;if(e&&Element.getChildValueByTagName(e,"data")[0]){var i=JSON.parse(Element.getChildValueByTagName(e,"data")[0])[0];i.title&&(t=i.title)}this.options.title=t,this.elm_title.innerHTML=t,this.elm_ico&&(this.elm_ico.alt=t),this.endEditTitle()},endEditTitle:function(){Element.remove(this.elm_titleIpt),Element.show(this.elm_ico),Element.show(this.elm_title),this.elm_del&&this.elm_opt&&(Element.show(this.elm_del),Element.show(this.elm_opt)),this.editingTitle=!1},hasNoDelMod:function(){var e=[];return $A(this.options.mods.flatten()).each(function(t){var i=App.Modules.getObjById(t);if(!i)throw $continue;var s=App.WidgetLib.getWidget(i.options.type);i&&s&&!s.ableDel&&e.push(i)}.bind(this)),e},close:function(){if(1>=App.PageTabs.pTabs.length){var e={type:"alert",title:App.Lang.error,content:App.Lang.cannotDelOnlyPage};return new PopWin(e),void 0}var t=App.PageTabs.getPublicTabs();if(0==this.options.permit&&1>=t.length){var e={type:"alert",title:App.Lang.error,content:App.Lang.cannotDelOnlyPubPage};return new PopWin(e),void 0}var i=this.hasNoDelMod();if(i.length>0){var s="";s+=App.Lang.hasNoDelMods,s+=":",i.each(function(e,t){0!=t&&(s+=","),s+="["+e.options.title+"]"}),s+="\n",s+="\n",s+=App.Lang.cannotDelNoDelModPage;var e={type:"alert",title:App.Lang.error,content:s};return new PopWin(e),void 0}var e={type:"confirm",content:App.Lang.confirmDelPage,focus:!1,okAction:this.acceptClose.bind(this)};new PopWin(e)},acceptClose:function(){App.Requester.request("delPage",this)},doClose:function(){this.destroy()},getPermitOpt:function(){var e=document.createElement("div");e.className=this.options.isDivCss+" clearfix";var t=[];return t.push("<ul>"),t.push('<li><label for="pagePub_'+this.options.id+'">'),t.push('<input type="radio" id="pagePub_'+this.options.id+'" name="pagePermit_'+this.options.id+'" value="0"'+(0==this.options.permit?' checked="checked"':"")+" />"+App.Lang.pagePublic),t.push("</label></li>"),t.push('<li><label for="pagePri_'+this.options.id+'">'),t.push('<input type="radio" id="pagePri_'+this.options.id+'" name="pagePermit_'+this.options.id+'" value="1"'+(0!=this.options.permit?' checked="checked"':"")+" />"+App.Lang.pagePrivate),t.push("</label></li>"),t.push("</ul>"),e.innerHTML=t.join(""),this.optPub=e.firstChild.childNodes[0].firstChild.firstChild,this.optPri=e.firstChild.childNodes[1].firstChild.firstChild,Event.observe(this.optPub,"click",function(){this.setPermit(0),this.optMenu&&this.optMenu.hide()}.bind(this)),Event.observe(this.optPri,"click",function(){this.setPermit(1),this.optMenu&&this.optMenu.hide()}.bind(this)),e},getTitleOpt:function(){var e=document.createElement("div");e.className=this.options.isDivCss+" clearfix";var t=[];return t.push("<ul>"),t.push('<li><a href="javascript:void(0)">'+App.Lang.chgPageTitle+"</a></li>"),t.push("</ul>"),e.innerHTML=t.join(""),this.optSetTitle=e.firstChild,Event.observe(this.optSetTitle,"click",function(){this.editTitle(),this.optMenu&&this.optMenu.hide()}.bind(this)),e},setOpt:function(){if(!this.optMenu){var e={menuData:[],title:App.Lang.pageOpt,btn:this.element,zIndex:500,sDivCss:"menuSub-div menuSub-div-colStyle"};if(this.pl.ableSetCol){var t={title:App.Lang.pageLayout,active:!0,isDivCssEx:"menuInnerSub-div-colStyle",data:[]};$H(App.colStyleLib).each(function(e){t.data.push({text:'<img src="'+App.Actions.imgPath+e.value+'" alt="'+e.key+'" />',title:e.key,action:this.setColStyle.bind(this),value:e.key,active:this.options.colStyle==e.key})}.bind(this)),e.menuData.push(t)}if(this.pl.ableSetTit&&e.menuData.push({title:App.Lang.pageTitle,active:!1,data:this.getTitleOpt.bind(this)}),this.pl.ableSetIco){var i={title:App.Lang.pageIcon,active:!1,isDivCssEx:"menuInnerSub-div-ico",data:[]};$A(App.icoLib).each(function(e,t){i.data.push({text:'<img src="'+App.Actions.imgPath+App.Actions.icoShortPath+e+'" alt="'+"["+t+"]:"+e+'" />',title:"["+t+"]:"+e,action:this.setIcon.bind(this),value:t,active:this.options.ico==t})}.bind(this)),e.menuData.push(i)}this.pl.ableSetPer&&e.menuData.push({title:App.Lang.pagePermit,active:!1,data:this.getPermitOpt.bind(this)}),this.optMenu=new WinMenu(e)}this.optMenu.win.showing?this.hideOptMenu():(App.PageTabs.hideOptMenuAll(),this.showOptMenu())},showOptMenu:function(){this.optMenu&&this.optMenu.show()},hideOptMenu:function(){this.optMenu&&this.optMenu.hide()},setColStyle:function(e){e&&e!=this.options.colStyle&&(this.newColStyle=e,App.Requester.request("editPageColStyle",this))},doSetColStyle:function(e){var t=this.newColStyle;if(e&&Element.getChildValueByTagName(e,"data")[0]){var i=JSON.parse(Element.getChildValueByTagName(e,"data")[0])[0];i.colStyle&&(t=i.colStyle)}this.options.colStyle=t,this.modCtn.setColStyle(t)},setIcon:function(e){e!=this.options.ico&&(this.newIco=e,App.Requester.request("editPageIco",this))},doSetIcon:function(e){var t=this.newIco;if(e&&Element.getChildValueByTagName(e,"data")[0]){var i=JSON.parse(Element.getChildValueByTagName(e,"data")[0])[0];i.ico&&(t=i.ico)}this.options.ico=t,0==this.options.ico?(this.elm_ico.src=App.Actions.imgPath+"spacer.gif",this.elm_ico.style.width="1px"):(this.elm_ico.src=App.Actions.imgPath+App.Actions.icoShortPath+App.icoLib[this.options.ico],this.elm_ico.style.width="16px")},hasPrivateMod:function(){var e=[];return $A(this.options.mods.flatten()).each(function(t){var i=App.Modules.getObjById(t);i&&App.WidgetLib.getWidget(i.options.type).private&&e.push(i)}.bind(this)),e},setPermit:function(e){if(e!=this.options.permit){if(0==e){var t=this.hasPrivateMod();if(t.length>0){var i="";i+=App.Lang.hasPriveMods,i+=":",t.each(function(e,t){0!=t&&(i+=","),i+="["+e.options.title+"]"}),i+="\n",i+="\n",i+=App.Lang.cannotSetPublic;var s={type:"alert",title:App.Lang.error,content:i};return new PopWin(s),this.optPub.checked=!1,this.optPri.checked=!0,void 0}}else{var n=App.PageTabs.getPrivateTabs();if(n.length==App.PageTabs.pTabs.length-1){var i="";i+=App.Lang.cannotAllPrivate;var s={type:"alert",title:App.Lang.error,content:i};return new PopWin(s),this.optPub.checked=!0,this.optPri.checked=!1,void 0}}this.newPermit=e,App.Requester.request("editPagePermit",this)}},doSetPermit:function(e){var t=this.newPermit;if(e&&Element.getChildValueByTagName(e,"data")[0]){var i=JSON.parse(Element.getChildValueByTagName(e,"data")[0])[0];i.permit&&(t=i.permit)}this.options.permit=t,0==this.options.permit?Element.removeClassName(this.element,"private"):Element.addClassName(this.element,"private"),App.PageTabs.showModCtnInfo(this),App.Framework.updateNewModMenuContent()},regDrop:function(){App.Permit.ableLog&&$LT("App.PageTab[id:"+this.options.id+"] regDrop");var e={accept:"mod",hoverclass:"hover",onHover:this.onHover.bind(this),onDrop:this.onDrop.bind(this)};Droppables.add(this.element,e)},disRegDrop:function(){Droppables.remove(this.element)},onHover:function(e){var t=App.Modules.getObjByElement(e.element);return t.options.page.element==this.element?(Sortable.target(e,e.element.parentNode),Sortable.targetMark(),void 0):(Sortable.untarget(),void 0)},onDrop:function(e){var t=App.Modules.getObjByElement(e.element),i=t.options.page;if(i.element!=this.element){if(App.WidgetLib.getWidget(t.options.type).private&&0==this.options.permit){var s="";s+=App.Lang.movePriMod2PubPage,s+="\n",s+=App.Lang.cannotMovePriMod2PubPage;var n={type:"alert",title:App.Lang.error,content:s};return new PopWin(n),void 0}this.loaded?(t.options.page=this,this.modCtn.cols[0].insertBefore(e.element,this.modCtn.cols[0].firstChild),i.saveModsOrder(),this.saveModsOrder()):(t.destroy(!0),this.options.mods[0].unshift(t.options.id),this.saveModsOrder("doToServer"))}}},App.ModContainers={mCtns:[],register:function(e){$(e.options.placeIn).appendChild(e.element),this.mCtns.push(e)},unregister:function(e){this.mCtns=this.mCtns.reject(function(t){return t==e})}},App.ModContainer=Class.create(),App.ModContainer.prototype={initialize:function(e){App.Permit.ableLog&&$LT("App.ModContainer.initialize"),this.options=Object.extend({colStyle:App.defaultColStyle,isActive:!1,placeIn:document.body},e||{}),this.cols=[],this.build(),App.ModContainers.register(this)},destroy:function(){this.element&&(Element.remove(this.element),this.element=null,App.ModContainers.unregister(this))},build:function(){var e=document.createElement("table");this.element=e,e.id="modContainerTable",e.cellSpacing="0",e.cellPadding="0",this.options.isActive||Element.hide(e);var t=this.element.insertRow(0);this.content=t,this.doSetColStyle(!0)},setColStyle:function(e){e&&e!=App.colStyle&&(this.options.colStyle=e,this.doSetColStyle())},doSetColStyle:function(e){this.colsRate=this.options.colStyle.split(":");var t=this.cols;this.colsRate.length!=t.length;var i=this.colsRate.length<t.length;$A(this.colsRate.length>t.length?this.colsRate:t).each(function(e,i){this.colsRate[i]&&!t[i]&&this.addCol(),t[i]&&!this.colsRate[i]&&this.delCol(),t[i]&&this.colsRate[i]&&(this.cols[i].style.width=(isNaN(this.colsRate[i])?100:this.colsRate[i])+"%")}.bind(this)),"opera"==Browser.ua&&(Element.hide(this.element),Element.show(this.element)),e||(this.pageTab.regModObservers(),i&&this.pageTab.saveModsOrder())},addCol:function(){var e=this.cols.length,t=document.createElement("td");t.className="col",t.id=App.colId_prefix+(e+1),this.content.appendChild(t),this.cols.push(t)},delCol:function(){var e=this.cols.length-1,t=this.cols[e];$A(t.childNodes).each(function(t){this.cols[e-1].appendChild(t)}.bind(this)),Element.remove(t),this.cols=this.cols.reject(function(e){return e==t})},active:function(){Element.show(this.element)},disActive:function(){Element.hide(this.element)}},window.onunload=function(){try{App.PageTabs.stopListenHash(),App.Modules.unregisterAll(),delete App,App=null}catch(e){}},App.Modules={modules:[],register:function(e,t){if(t||!e.options.placeBefore?$(e.options.placeIn).appendChild(e.element):$(e.options.placeBefore)&&$(e.options.placeIn).insertBefore(e.element,$(e.options.placeBefore)),e.options.floating){e.element.style.position="absolute",e.element.style.left=e.options.floating[0]+"px",e.element.style.top=e.options.floating[1]+"px",e.element.style.width=e.options.floating[2]+"px";var i={defaultWidth:e.options.floating[2],defaultHeight:e.options.floating[3]};this.registerResizable(e,i)}this.modules.push(e),t||0>Browser.ua.indexOf("ie")&&(new Effect.Highlight(e.element,{duration:.3,queue:"front"}),new Effect.Highlight(e.element,{duration:.5,queue:"end"}),new Effect.Highlight(e.element,{duration:1,queue:"end"}))},unregister:function(e){this.unregisterResizable(e),this.modules=this.modules.reject(function(t){return t==e})},unregisterAll:function(){try{for(var e=0;this.modules.length>e;e++)this.modules[e].destroy(),delete this.modules[e],this.modules[e]=null}catch(t){}},showAll:function(){this.modules.each(function(e){e.swapShowHide(!0)})},hideAll:function(){this.modules.each(function(e){e.swapShowHide(!1)})},registerResizable:function(e,t){if(e&&!e.resizeObj){var i=Object.extend({able:App.Permit.resize,addons:"modCon",snap:this.resize_snap,change:this.resize_change,update:function(e){App.Modules.getObjByElement(e.element).setFloat()}},t||{});e.resizeObj=new App.Resizable(e.element,i)}},unregisterResizable:function(e){e&&e.resizeObj&&(e.resizeObj.destroy(),e.resizeObj=null)},resize_snap:function(e,t,i){var s=Math.max(180,Math.min(t,screen.availWidth)),n=Math.max(20,Math.min(i,screen.availHeight));return[s,n]},resize_change:function(e){var t=parseInt(Element.getStyle(e.element,"width")),i=parseInt(Element.getStyle(e.element,"height")),s=Math.max(180,Math.min(t,screen.availWidth)),n=Math.max(e.element.firstChild.offsetHeight,Math.min(i,screen.availHeight));e.element.style.width=s+"px",e.element.style.height=n+"px"},getObjByElement:function(e){return this.modules.find(function(t){return t.element==e})},getObjByType:function(e){return this.modules.find(function(t){return t.options.type==e})},getObjById:function(e){return this.modules.find(function(t){return t.options.id==e})},newOwMod:function(e){window.open(e,"_blank")},newMod:function(e){if(this.curPTab=App.PageTabs.getActivePTab()?App.PageTabs.getActivePTab():App.PageTabs.pTabs[0],this.curPTab.options.mods.flatten().length>=App.maxPerPageModCount){var t={type:"alert",title:App.Lang.info,content:App.Lang.tooManyModsInOnePage};return new PopWin(t),void 0}this.opt4newMod={type:e,title:""},App.Requester.request("new",{options:this.opt4newMod})},doNewMod:function(e){if(e){var t=e.getElementsByTagName("mod")[0],i={page:this.curPTab||App.PageTabs.pTabs[0],id:t.getAttribute("id")||"",type:t.getAttribute("type")||this.opt4newMod.type||"",title:Element.getChildValueByTagName(t,"title")[0]||this.opt4newMod.title||"",data:Element.getChildValueByTagName(t,"data")[0]?JSON.parse(Element.getChildValueByTagName(t,"data")[0]):this.opt4newMod.data||"",placeIn:this.curPTab.modCtn.cols[0],placeBefore:this.curPTab.modCtn.cols[0].firstChild};new App.Module(i),setTimeout(function(){this.curPTab.regModObservers(),this.curPTab.saveModsOrder(),App.Framework.updateNewModMenuContent()}.bind(this),100)}}},App.Module=Class.create(),App.Module.prototype={initialize:function(e,t){this.options=Object.extend({id:null,type:null,isExpanded:!0,share:!0,floating:!1,title:"",data:null,page:null,placeIn:document.body,placeBefore:null,newMode:!1},e||{}),Object.extend(this.options,{editMode:!1,loaded:!1,loadTime:0,maxLoadTime:App.maxWidgetLoadTime}),this.build(),this.m_content=this.getModuleContent(),this.m_suffix=this.getModuleSuffix(),App.Permit.editModule&&(this.m_edit=this.getEditContent(),this.hideEditMode()),this.setIco(),this.options.isExpanded?"":this.swapShowHide(!1,t),this.hideExpandBtn(),App.Modules.register(this,t),t?this.waitToAttachContent():(App.UserData.addMod(this.options),this.attachContent())},destroy:function(e){if(this.content&&this.content.destroy)try{this.content.destroy(),this.content=null}catch(t){}Element.remove(this.element),e?(this.options.page.saveModsOrder(),App.Framework.updateNewModMenuContent()):this.options.page.saveModsOrder("noToServer"),App.Modules.unregister(this)},build:function(){var e=document.createElement("div");this.element=e,e.className="mod",e.id=this.options.id;var t=[];t.push('<div class="modFrame">'),t.push('<table cellspacing="0" cellpadding="0" class="modTable">'),t.push("<thead><tr>"),t.push('<td class="mheader lt"></td>'),t.push('<td class="mheader t"><div class="modHeader clearfix"></div></td>'),t.push('<td class="mheader rt"></td>'),t.push("</tr></thead>"),t.push("<tbody>"),App.Permit.editModule?t.push("<tr>"):t.push('<tr style="display:none;">'),t.push('<td class="mneck l"></td>'),t.push('<td class="mneck ec"><div class="modEditCon"></div></td>'),t.push('<td class="mneck r"></td>'),t.push("</tr>"),t.push("<tr>"),t.push('<td class="mbody l"></td>'),t.push('<td class="mbody c"><div class="modCon">'+App.Lang.loading+"</div>"),t.push('<div class="modSuffix" style="text-align:right;display:none;"><hr /><a href="javascript:void(0);" onmousedown="CA.a(\'widget_share_\' + (isPPLogin() ? (isMyBlog() ? \'admin\' : \'blogger\') : \'guest\'))"><img align="absmiddle" src="http://js2.pp.sohu.com.cn/ppp/images/icons/ico_share.gif" />推荐给好友</a></div></td>'),t.push('<td class="mbody r"></td>'),t.push("</tr></tbody>"),t.push("<tfoot><tr>"),t.push('<td class="mfooter lb"></td>'),t.push('<td class="mfooter b"></td>'),t.push('<td class="mfooter rb"></td>'),t.push("</tr></tfoot>"),t.push("</table>"),t.push("</div>"),e.innerHTML=t.join(""),t=null,this.eventCancelBubble=App.cancelBubble.bindAsEventListener(this);var i=this.getModTable().firstChild.firstChild.childNodes[1].firstChild;if(!this.options.newMode){var s=document.createElement("div");this.elm_showHide=s,s.className="modShow",s.title=App.Lang.showHideModuleBtnTitle,Event.observe(s,"mousedown",this.eventCancelBubble),this.eventSwapShowHide=this.swapShowHide.bindAsEventListener(this),Event.observe(s,"click",this.eventSwapShowHide),i.appendChild(s)}if(App.Permit.editModule){if(!this.options.newMode){var n=document.createElement("div");this.elm_close=n,n.className="modCls";var o="";o=App.WidgetLib.getWidget(this.options.type)&&App.WidgetLib.getWidget(this.options.type).sys?App.Lang.hideModuleBtnTitle:App.Lang.delModuleBtnTitle,n.title=o,Event.observe(n,"mousedown",this.eventCancelBubble),this.eventClose=this.close.bindAsEventListener(this),Event.observe(n,"click",this.eventClose),i.appendChild(n),Element.hide(n)}var a=document.createElement("div");this.elm_edit=a,a.className="modEdit",a.innerHTML='<a href="javascript:void(0)">'+App.Lang.setBtn+"</a>",Event.observe(a,"mousedown",this.eventCancelBubble),this.eventSwapEdit=this.swapEditMode.bindAsEventListener(this),Event.observe(a,"click",this.eventSwapEdit),i.appendChild(a),Element.hide(a)}if(!this.options.newMode){var p=document.createElement("div");this.elm_refresh=p,p.className="modRfs",p.title=App.Lang.refreshModuleBtnTitle,Event.observe(p,"mousedown",this.eventCancelBubble),this.eventRefresh=this.refresh.bindAsEventListener(this),Event.observe(p,"click",this.eventRefresh),i.appendChild(p),Element.hide(p)}if(!this.options.editModule){var h=document.createElement("div");this.elm_addMe=h,h.className="modAdw",h.innerHTML='<a href="javascript:void(0)">'+App.Lang.addMeModuleBtnTitle+"</a>",Event.observe(h,"mousedown",this.eventCancelBubble),this.eventAddMe=this.addMe.bindAsEventListener(this),Event.observe(h,"click",this.eventAddMe),i.appendChild(h),Element.hide(h)}var d=document.createElement("div");this.elm_ico=d,d.className="modIco",d.innerHTML='<img src="'+App.Actions.imgPath+'spacer.gif" />',i.appendChild(d);var l=document.createElement("div");this.elm_title=l,l.className="modTitle",l.innerHTML=this.options.title||App.Lang.createModule,i.appendChild(l),this.eventMouseOver=this.mouseOver.bind(this),this.eventMouseOut=this.mouseOut.bind(this),Event.observe(this.element,"mouseover",this.eventMouseOver),Event.observe(this.element,"mouseout",this.eventMouseOut)},mouseOver:function(){this.showBtns()},mouseOut:function(){this.hideBtns()},getModTable:function(){return this.element.firstChild.firstChild},getEditPanel:function(){var e=this.getModTable(),t=e.childNodes[1].firstChild;return t},getContentPanel:function(){var e=this.getModTable(),t=e.childNodes[1].childNodes[1];return t},getEditContent:function(){var e=this.getEditPanel(),t=e.childNodes[1].firstChild;return t},getModuleContent:function(){var e=this.getContentPanel(),t=e.childNodes[1].firstChild;return t},getModuleSuffix:function(){var e=this.getContentPanel(),t=e.childNodes[1].lastChild;return t},setIco:function(e){if(!e)return Element.hide(this.elm_ico),void 0;var t=this.elm_ico.firstChild;t.src=e,t.onload=function(){this.height>16&&(this.height="16")},Element.show(this.elm_ico)},showIcoBtn:function(){this.elm_ico&&Element.show(this.elm_ico)},hideIcoBtn:function(){this.elm_ico&&Element.hide(this.elm_ico)},setTitle:function(e,t){e&&(!this.options.title||t)&&(this.elm_title.innerHTML=e)},getTitle:function(){return this.elm_title.innerHTML},setFloat:function(){this.options.floating=[parseInt(Element.getStyle(this.element,"left")),parseInt(Element.getStyle(this.element,"top")),parseInt(Element.getStyle(this.element,"width")),parseInt(Element.getStyle(this.element,"height"))],App.Requester.request("float",this)},showRefreshBtn:function(){this.elm_refresh&&Element.show(this.elm_refresh)},hideRefreshBtn:function(){this.elm_refresh&&Element.hide(this.elm_refresh)},refresh:function(){this.content&&this.content.refresh&&this.options.loaded&&(this.options.loaded=!1,this.content.refresh())},loaded:function(){this.options.loaded=!0},showCloseBtn:function(){Element.show(this.elm_close)},hideCloseBtn:function(){this.elm_close&&Element.hide(this.elm_close)},close:function(){var e={type:"confirm",content:App.WidgetLib.getWidget(this.options.type)&&App.WidgetLib.getWidget(this.options.type).sys?App.Lang.confirmHideModule:App.Lang.confirmDelModule,focus:!1,okAction:this.acceptClose.bind(this)};new PopWin(e)},acceptClose:function(){App.Requester.request("del",this)},doClose:function(){App.UserData.delMod(this.options),this.destroy(!0)},showAddMeBtn:function(){this.elm_addMe&&Element.show(this.elm_addMe)},hideAddMeBtn:function(){this.elm_addMe&&Element.hide(this.elm_addMe)},addMe:function(){if(!(this.content&&this.content.addMe&&this.content.addMe())){var e="&type="+this.options.type;if(this.options.data.oid){for(var t=[],i=Object.keys(this.options.data),s=0;i.length>s;s++)t.push(i[s]+"="+escape(this.options.data[i[s]]));e+="&oid="+this.options.data.oid+"&"+t.join("&")}window.open("http://blog.sohu.com/manage/module.do?m=preview"+e)}},swapShowHide:function(e,t){this.lastIsExpanded=this.options.isExpanded,"boolean"==typeof arguments[0]?arguments[0]?this.show():this.hide():this.options.isExpanded?this.hide():this.show(),!App.Permit.editModule||t||void 0!==e&&e==this.lastIsExpanded||App.Requester.request("expand",this)},showExpandBtn:function(){this.elm_showHide&&Element.show(this.elm_showHide)},hideExpandBtn:function(){this.elm_showHide&&Element.hide(this.elm_showHide)},show:function(e){Element.show(this.getContentPanel()),this.resizeObj&&("opera"==Browser.ua?setTimeout(function(){this.resizeObj.adjustSize(!1,!0)}.bind(this),10):this.resizeObj.adjustSize(!1,!0),this.resizeObj.options.constraint=this.resizeObj.defaultConstraint),Element.hasClassName(this.elm_showHide,"modHide")&&Element.removeClassName(this.elm_showHide,"modHide"),Element.addClassName(this.elm_showHide,"modShow"),e||(this.options.isExpanded=!0)},hide:function(e){Element.hide(this.getContentPanel()),this.resizeObj&&("opera"==Browser.ua?setTimeout(function(){this.resizeObj.adjustSize(!1,!0)}.bind(this),10):this.resizeObj.adjustSize(!1,!0),this.resizeObj.defaultConstraint=this.resizeObj.options.constraint,this.resizeObj.options.constraint="horizontal"),Element.hasClassName(this.elm_showHide,"modShow")&&Element.removeClassName(this.elm_showHide,"modShow"),Element.addClassName(this.elm_showHide,"modHide"),e||(this.options.isExpanded=!1)},showEditBtn:function(){Element.show(this.elm_edit)},hideEditBtn:function(){this.elm_edit&&Element.hide(this.elm_edit)},swapEditMode:function(){this.options.editMode?this.closeEdit():this.edit()},edit:function(){this.options.editMode=!0,this.content&&this.content.edit&&this.content.edit(),this.showEditMode(),this.show()},closeEdit:function(){this.options.editMode=!1,this.content&&this.content.onCloseEdit&&this.content.onCloseEdit(),this.hideEditMode()},save:function(e,t){(e||null!==t)&&(e!==void 0&&e&&(this.options.data=e),t!==void 0&&null!==t&&(this.options.title=t),App.Requester.request("edit",this))},endSave:function(){this.content&&this.content.endSave&&this.content.endSave(),this.closeEdit()},showEditMode:function(){var e=this.getEditPanel();Element.show(e),this.resizeObj&&("opera"==Browser.ua?setTimeout(function(){this.resizeObj.adjustSize(!1,!0)}.bind(this),10):this.resizeObj.adjustSize(!1,!0)),this.setCloseEditBtn()},hideEditMode:function(){var e=this.getEditPanel();Element.hide(e),this.resizeObj&&("opera"==Browser.ua?setTimeout(function(){this.resizeObj.adjustSize(!1,!0)}.bind(this),10):this.resizeObj.adjustSize(!1,!0)),this.setEditBtn()},setEditBtn:function(){this.elm_edit.firstChild.innerHTML=App.Lang.setBtn},setCloseEditBtn:function(){this.elm_edit.firstChild.innerHTML=App.Lang.closeSetBtn},waitToAttachContent:function(){if(Browser.ua.indexOf("ie")>=0&&!this.options.newMode)if(this.options.page.loaded){if(0==this.options.fastLoad)var e=Math.round(500*Math.random());else if(1==this.options.fastLoad)var e=Math.round(1e3*Math.random()+500);else var e=Math.round(2e3*Math.random()+1500);setTimeout(this.attachContent.bind(this),e)}else setTimeout(this.waitToAttachContent.bind(this),100);else this.attachContent()},attachContent:function(){return App.WidgetLib.getWidget(this.options.type)?(this.showWidgetLoading(),App.Widgets[this.options.type]?this.initWidget():(new App.Widget(this.options.type),this.waitForAttachContent()),void 0):(this.showWidgetError(),void 0)},waitForAttachContent:function(){!App.Widgets.hasRegistered(this.options.type),App.Widgets[this.options.type]?this.initWidget():this.options.loadTime<this.options.maxLoadTime?(this.options.loadTime+=100,setTimeout(this.waitForAttachContent.bind(this),100)):(App.Widgets.unregister(this.options.type),this.showWidgetInfo())},initWidget:function(){var e=App.WidgetLib.getWidget(this.options.type);this.setWidgetData(e),this.w_path=e.path,this.content=new App.Widgets[this.options.type](this.options.data,this.m_content,this.m_edit,this.w_path),this.content.id=this.options.id,this.content.setIco=this.setIco.bind(this),this.content.setTitle=this.setTitle.bind(this),this.content.getTitle=this.getTitle.bind(this),this.content.resetControls=this.resetControls.bind(this),this.resetControls(),this.content.initialize()},resetControls:function(){App.Permit.editModule&&"function"==typeof this.content.edit&&(this.content.save=this.save.bind(this),this.content.closeEdit=this.closeEdit.bind(this)),"function"==typeof this.content.refresh&&(this.content.loaded=this.loaded.bind(this)),"function"==typeof this.content.shareMePath&&this.content.shareMePath()&&(this.shareMeEl||(this.shareMeEl=this.m_suffix.lastChild),this.shareMeEvent||(this.shareMeEvent=this.shareMe.bind(this),Event.observe(this.shareMeEl,"click",this.shareMeEvent)),Element.show(this.m_suffix))},shareMe:function(e){var ele=this.shareMeEl,attr="data-share2";if(!isLogin())return ele.href=loginPath(),void 0;if(!ele.getAttribute(attr)){ele.setAttribute(attr,"true"),ele.innerHTML='<img align="absmiddle" src="http://js2.pp.sohu.com.cn/ppp/images/icons/ico_share.gif" />正在推荐...';var func=function(req){var info=App.Lang.unknownError;if(req&&req.responseText)try{var json=eval("("+req.responseText+")");json&&json.statusText&&(info=json.statusText)}catch(e){}var aa=new PopWin({type:"alert",title:"推荐给好友",content:info});ele.innerHTML='<img align="absmiddle" src="http://js2.pp.sohu.com.cn/ppp/images/icons/ico_share.gif" />推荐给好友',ele.removeAttribute(attr)},path=this.content.shareMePath?this.content.shareMePath():this.shareMePath(),url="/py?url="+encodeURIComponent("http://ow.blog.sohu.com/widget/0/sendMsg?"+path+"&c="+timeStamp());new Ajax.Request(url,{method:"POST",onComplete:func})}},shareMePath:function(){return"url="+this.options.type},showBtns:function(){App.Permit.editModule?this.content&&"function"==typeof this.content.edit&&this.showEditBtn():this.showAddMeBtn(),this.content&&"function"==typeof this.content.refresh&&(this.options.newMode||this.showRefreshBtn()),App.Permit.editModule&&!this.options.newMode&&this.showCloseBtn(),this.options.newMode||(this.hideIcoBtn(),this.showExpandBtn())},hideBtns:function(){this.hideEditBtn(),this.hideAddMeBtn(),this.hideRefreshBtn(),this.hideCloseBtn(),this.hideExpandBtn(),this.showIcoBtn()},showWidgetLoading:function(){var e="";e+=App.Lang.loadWidget,this.m_content.innerHTML=e},showWidgetError:function(){var e="";e+=App.Lang.widgetError,this.m_content.innerHTML=e},setWidgetData:function(e){this.options.title||this.setTitle(e.title||""),!this.options.ico&&e.ico?this.setIco(e.ico):this.setIco(),Element.addClassName(this.m_content,this.options.type+"-content"),Element.addClassName(this.m_edit,this.options.type+"-edit"),this.m_content.innerHTML=""},showWidgetInfo:function(){var e="";e+=App.Lang.loadTimeout,e+=App.Lang.reloadPage,e+="<br /><br />"+App.Lang.loadWidgetTimeout+"["+this.options.type+"]",this.m_content.innerHTML=e}},App.Widgets={registered:[],register:function(e){this.hasRegistered(e.type)||this.registered.push(e)},hasRegistered:function(e){return this.registered.find(function(t){return t.type==e})?!0:!1},unregister:function(e){this.registered=this.registered.reject(function(t){return t.type==e})},getWidget:function(e){return this.registered.find(function(t){return t.type==e})}},App.Widget=Class.create(),App.Widget.prototype={initialize:function(e){var t;return(t=App.WidgetLib.getWidget(e))?(App.Widgets.hasRegistered(e)||(Object.extend(this,t),this.analyse(),App.Widgets.register(this)),void 0):!1},analyse:function(){var e=this.path,t=this.ico.trim();t&&0!==t.indexOf("http://")&&0!==t.indexOf("/")&&(t=e+(t||"")),this.ico=t,$A(this.js).each(function(t,i){0!==t.indexOf("http://")&&0!==t.indexOf("/")&&(this.js[i]=e+t)}.bind(this)),$A(this.css).each(function(t,i){0!==t.indexOf("http://")&&0!==t.indexOf("/")&&(this.css[i]=e+t)}.bind(this)),this.loadLib()},loadLib:function(){$A(this.css).each(function(e){new LinkFile(e,{type:"css"})}),$A(this.js).each(function(e){var t={};-1!==e.indexOf("feed.js")&&(t.charset="utf-8"),"opera"==Browser.ua?setTimeout(function(){new LinkFile(e,t)},100):new LinkFile(e,t)})}},App.Themes={setTheme:function(e){if(e&&e!=App.theme){var t=App.ThemeLib.getTheme(e);t||(t={},t.id=e),App.Requester.request("theme",t.code||t.id),App.theme=e}},setOT:function(e){window.open(e,"_blank")},doSetTheme:function(e){if(e&&"string"==typeof e)var t=e;else{var i=App.ThemeLib.getTheme(App.theme);i||0!=App.theme.indexOf("g")||(i={id:App.theme});var t=App.Actions.themePath+(i.path||i.id)+"/style.css"}$("themeCss")?($("themeCss").href=t,$("themeCss").setAttribute("themeid",App.theme)):(this.element=new LinkFile(t,{type:"css"}),this.element._link.id="themeCss",this.element._link.setAttribute("themeid",App.theme)),$("openTheme")&&Element.remove("openTheme")
},doSetThemeGW:function(e){if(e&&"string"==typeof e)var t=App.Actions.themePath+e+"/style.css";$("themeCss")?$("themeCss").href=t:(this.element=new LinkFile(t,{type:"css"}),this.element._link.id="themeCss"),$("openTheme")&&Element.remove("openTheme")}},App.UserStyle={stylesTempl:{"#header":{backgroundImage:"",backgroundRepeat:"",backgroundPosition:"",height:""},"#header-bak":{backgroundImage:""},body:{backgroundImage:"",backgroundRepeat:"",backgroundPosition:""},"body-bak":{backgroundImage:""}},styles:null,customTheme:function(){if(!this.cusThemeWin){var e={menuData:[{title:App.Lang.customHeader,active:!0,data:this.getCusHeaderCon.bind(this)},{title:App.Lang.customBodyBg,active:!1,data:this.getCusBodyBgCon.bind(this)}],elm_extendBottom:this.getCusThemeClean(),title:App.Lang.customTheme,dragable:!0,btn:App.Framework.elm_themeBtn,displace:[-495,0],zIndex:1e3,okBtn:!0,cancelBtn:!0,menuType:"tab",onOk:this.save.bind(this),onCancel:this.cancel.bind(this),sDivCss:"menuSub-div menuSub-div-cusTheme"};this.cusThemeWin=new WinMenu(e)}this.cusThemeWin.showing?this.cusThemeWin.hide():(this.cusThemeWin&&this.cusThemeWin.showing&&this.cusThemeWin.hide(),this.cusThemeWin.show())},getCusThemeInfo:function(){var e=document.createElement("div");return e.className="infoBox",e.innerHTML=App.Lang.customThemeInfo,e},getCusThemeClean:function(){var e=document.createElement("div");return e.className="cusThemeClean",e.innerHTML='<a href="javascript:void(0)">'+App.Lang.customThemeClean+"</a>",Event.observe(e.firstChild,"click",function(){var e={type:"confirm",content:App.Lang.confirmCleanCustomTheme,focus:!1,okAction:this.clean.bind(this)};new PopWin(e)}.bind(this)),e},getCusHeaderCon:function(){var e=document.createElement("div");e.className="menuInnerSub-div clearfix";var t=[];t.push("<fieldset>"),t.push("<legend>"+App.Lang.selectImage+"</legend>"),t.push('<div id="cusThemeHeaderBgiBox" style="padding:0;margin:5px;border:1px solid #ccc;height:128px;overflow-y:scroll;" class="clearfix">'),t.push('<div class="headerBgiSmp">'),t.push('<img src="'+App.Actions.imgPath+'custom/themesHeaderBg/default.gif" alt="'+App.Lang.useThemeDefaultHeaderImg+'" value="default" />'),t.push("</div>"),t.push('<div class="headerBgiSmp">'),t.push('<img src="'+App.Actions.imgPath+'custom/themesHeaderBg/upload.gif" alt="'+App.Lang.useMyHeaderImg+'" value="upload" />'),t.push("</div>"),t.push('<div class="headerBgiSmp">'),t.push('<img src="'+App.Actions.imgPath+'custom/themesHeaderBg/none.gif" alt="'+App.Lang.hideHeaderImg+'" value="none" />'),t.push("</div>"),App.CusThemeLib.headerBgi.lib.each(function(e){t.push('<div class="headerBgiSmp">'),t.push('<img src="'+(e.smp||e.src)+'" alt="'+e.src+'" value="'+e.src+'" />'),t.push("</div>")}.bind(this)),t.push("</div>"),t.push('<iframe src="/htmlarea/popups/insert_cusTheme.html?mode=headbgi&d='+_blog_domain+'" frameborder="0" style="margin-left:5px;display:none"></iframe>'),t.push('<input name="ct_header_bgi_bak" type="hidden" />'),t.push("</fieldset>"),t.push("<fieldset>"),t.push("<legend>"+App.Lang.imageOption+"</legend>"),t.push('<table width="100%">'),t.push("<tr>"),t.push('<td width="35">'+App.Lang.tiled+":</td>"),t.push("<td>"),t.push('<select name="ct_header_bgr" class="text">'),t.push('<option value="">'+App.Lang.def+"</option>"),t.push('<option value="repeat">'+App.Lang.repeat+"</option>"),t.push('<option value="no-repeat">'+App.Lang.noRepeat+"</option>"),t.push('<option value="repeat-x">'+App.Lang.repeatX+"</option>"),t.push('<option value="repeat-y">'+App.Lang.repeatY+"</option>"),t.push("</select>"),t.push("</td>"),t.push("</tr>"),t.push("<tr>"),t.push("<td>"+App.Lang.align+":</td>"),t.push("<td>"+App.Lang.horizontal+' <select name="ct_header_bgp_x" class="text">'),t.push('<option value="">'+App.Lang.def+"</option>"),t.push('<option value="left">'+App.Lang.left+"</option>"),t.push('<option value="center">'+App.Lang.center+"</option>"),t.push('<option value="right">'+App.Lang.right+"</option>"),t.push("</select>"),t.push("&nbsp;&nbsp;&nbsp;&nbsp;"+App.Lang.vertical+' <select name="ct_header_bgp_y" class="text">'),t.push('<option value="">'+App.Lang.def+"</option>"),t.push('<option value="top">'+App.Lang.top+"</option>"),t.push('<option value="center">'+App.Lang.middle+"</option>"),t.push('<option value="bottom">'+App.Lang.bottom+"</option>"),t.push("</select></td>"),t.push("</tr>"),t.push("<tr>"),t.push("<td>"+App.Lang.height+":</td>"),t.push('<td><input name="ct_header_h" type="text" class="text" maxlength="3" size="3" /><span>'+App.Lang.pixel+App.Lang.customHeaderHeightInfo+"</span></td>"),t.push("</tr>"),t.push("</table>"),t.push("</fieldset>"),e.innerHTML=t.join("");var i=$A(e.getElementsByTagName("input"));return i=i.concat($A(e.getElementsByTagName("select"))),$A(i).each(function(e){"ct_header_bgi_bak"==e.name&&(this.ipt_header_bgi_bak=e),"ct_header_bgr"==e.name&&(this.ipt_header_bgr=e),"ct_header_bgp_x"==e.name&&(this.ipt_header_bgp_x=e),"ct_header_bgp_y"==e.name&&(this.ipt_header_bgp_y=e),"ct_header_h"==e.name&&(this.ipt_header_h=e)}.bind(this)),this.ifm_header_bgi_up=e.getElementsByTagName("iframe")[0],this.elm_header_bgis=document.getElementsByClassName("headerBgiSmp",e,"div"),setTimeout(function(){this.updateCusHeaderData(),this.observeCusHeader()}.bind(this),1),e},updateCusHeaderData:function(){this.getStyle("header_bgi")&&"transparent"==this.getStyle("header_bgi")?this.activeOneHeaderBgi("none"):""!=this.getStyle("header_bgi")?App.CusThemeLib.headerBgi.getImg(this.getStyle("header_bgi"))?this.activeOneHeaderBgi(this.getStyle("header_bgi")):this.activeOneHeaderBgi("upload"):this.activeOneHeaderBgi("default"),this.ipt_header_bgi_bak.value=this.getStyle("header_bak_bgi"),this.ipt_header_bgr.value=this.getStyle("header_bgr"),this.ipt_header_bgp_x.value=this.getStyle("header_bgp_x"),this.ipt_header_bgp_y.value=this.getStyle("header_bgp_y"),this.ipt_header_h.value=this.getStyle("header_h")},activeOneHeaderBgi:function(e){$A(this.elm_header_bgis).each(function(t){t.firstChild.getAttribute("value")==e?(Element.addClassName(t,"headerBgiSmp-active"),"none"==t.style.display&&Element.show(t)):Element.removeClassName(t,"headerBgiSmp-active")})},observeCusHeader:function(){$A(this.elm_header_bgis).each(function(e){Event.observe(e,"mouseover",function(){Element.addClassName(e,"headerBgiSmp-over")}.bind(this)),Event.observe(e,"mouseout",function(){Element.removeClassName(e,"headerBgiSmp-over")}.bind(this)),Event.observe(e,"click",function(){var t=e.firstChild.getAttribute("value");this.activeOneHeaderBgi(t),Element.hide(this.ifm_header_bgi_up),"default"==t?(this.setCss("#header","background-image",""),this.ipt_header_bgr.value&&(this.ipt_header_bgr.value="",this.setCss("#header","background-repeat","")),this.ipt_header_h.value&&(this.ipt_header_h.value="",this.setCss("#header","height",""))):"none"==t?this.setCss("#header","background-image","none"):"upload"==t?(Element.show(this.ifm_header_bgi_up),$F(this.ipt_header_bgi_bak)&&this.setCss("#header","background-image","url("+$F(this.ipt_header_bgi_bak)+")")):(this.setCss("#header","background-image","url("+t+")"),(_tiled=App.CusThemeLib.headerBgi.getImg(t).tiled)&&this.ipt_header_bgr.value!=_tiled&&(this.ipt_header_bgr.value=_tiled,this.setCss("#header","background-repeat",_tiled)),(_height=App.CusThemeLib.headerBgi.getImg(t).height)&&this.ipt_header_h.value!=_height&&(this.ipt_header_h.value=_height,this.setCss("#header","height",_height+"px")))}.bind(this))}.bind(this)),Event.observe(this.ipt_header_bgr,"change",function(){this.setCss("#header","background-repeat",this.ipt_header_bgr.value)}.bind(this)),Event.observe(this.ipt_header_bgp_x,"change",function(){var e="";(this.ipt_header_bgp_x.value||this.ipt_header_bgp_y.value)&&(e=(this.ipt_header_bgp_x.value||"left")+" "+(this.ipt_header_bgp_y.value||"top")),this.setCss("#header","background-position",e)}.bind(this)),Event.observe(this.ipt_header_bgp_y,"change",function(){var e="";(this.ipt_header_bgp_x.value||this.ipt_header_bgp_y.value)&&(e=(this.ipt_header_bgp_x.value||"left")+" "+(this.ipt_header_bgp_y.value||"top")),this.setCss("#header","background-position",e)}.bind(this)),Event.observe(this.ipt_header_h,"keyup",function(){var e=this.ipt_header_h.value;return this.ipt_header_h.nextSibling.style.color="#000000",e&&(isNaN(e)||100>e||e>500)?(this.ipt_header_h.nextSibling.style.color="#FF0000",this.ipt_header_h.focus(),void 0):(this.setCss("#header","height",this.ipt_header_h.value+"px"),void 0)}.bind(this)),Event.observe(this.ipt_header_h,"blur",function(){var e=this.ipt_header_h.value;return e&&(isNaN(e)||100>e||e>500)?(alert(App.Lang.customHeaderHeightError),this.ipt_header_h.focus(),void 0):void 0}.bind(this))},getCusBodyBgCon:function(){var e=document.createElement("div");e.className="menuInnerSub-div clearfix";var t=[];t.push("<fieldset>"),t.push("<legend>"+App.Lang.selectImage+"</legend>"),t.push('<div id="cusThemeBodyBgiBox" style="padding:0;margin:5px;border:1px solid #ccc;height:128px;overflow-y:scroll;" class="clearfix">'),t.push('<div class="bodyBgiSmp">'),t.push('<img src="'+App.Actions.imgPath+'custom/themesBodyBg/default.gif" alt="'+App.Lang.useThemeDefaultBodyImg+'" value="default" />'),t.push("</div>"),t.push('<div class="bodyBgiSmp">'),t.push('<img src="'+App.Actions.imgPath+'custom/themesBodyBg/upload.gif" alt="'+App.Lang.useMyBodyImg+'" value="upload" />'),t.push("</div>"),t.push('<div class="bodyBgiSmp">'),t.push('<img src="'+App.Actions.imgPath+'custom/themesBodyBg/none.gif" alt="'+App.Lang.hideBodyImg+'" value="none" />'),t.push("</div>"),App.CusThemeLib.bodyBgi.lib.each(function(e){t.push('<div class="bodyBgiSmp">'),t.push('<img src="'+(e.smp||e.src)+'" alt="'+e.src+'" value="'+e.src+'" />'),t.push("</div>")}.bind(this)),t.push("</div>"),t.push('<iframe src="/htmlarea/popups/insert_cusTheme.html?mode=bodybgi&d='+_blog_domain+'" frameborder="0" style="margin-left:5px;display:none"></iframe>'),t.push('<input name="ct_body_bgi_bak" type="hidden" />'),t.push("</fieldset>"),t.push("<fieldset>"),t.push("<legend>"+App.Lang.imageOption+"</legend>"),t.push('<table width="100%" style="border-top:1px solid #eee;">'),t.push("<tr>"),t.push('<td width="35">'+App.Lang.tiled+":</td>"),t.push("<td>"),t.push('<select name="ct_body_bgr" class="text">'),t.push('<option value="">'+App.Lang.def+"</option>"),t.push('<option value="repeat">'+App.Lang.repeat+"</option>"),t.push('<option value="no-repeat">'+App.Lang.noRepeat+"</option>"),t.push('<option value="repeat-x">'+App.Lang.repeatX+"</option>"),t.push('<option value="repeat-y">'+App.Lang.repeatY+"</option>"),t.push("</select>"),t.push("</td>"),t.push("</tr>"),t.push("<tr>"),t.push("<td>"+App.Lang.align+":</td>"),t.push("<td>"+App.Lang.horizontal+' <select name="ct_body_bgp_x" class="text">'),t.push('<option value="">'+App.Lang.def+"</option>"),t.push('<option value="left">'+App.Lang.left+"</option>"),t.push('<option value="center">'+App.Lang.center+"</option>"),t.push('<option value="right">'+App.Lang.right+"</option>"),t.push("</select>"),t.push("&nbsp;&nbsp;&nbsp;&nbsp;"+App.Lang.vertical+' <select name="ct_body_bgp_y" class="text">'),t.push('<option value="">'+App.Lang.def+"</option>"),t.push('<option value="top">'+App.Lang.top+"</option>"),t.push('<option value="center">'+App.Lang.middle+"</option>"),t.push('<option value="bottom">'+App.Lang.bottom+"</option>"),t.push("</select></td>"),t.push("</tr>"),t.push("</table>"),t.push("</fieldset>"),e.innerHTML=t.join("");var i=$A(e.getElementsByTagName("input"));return i=i.concat($A(e.getElementsByTagName("select"))),$A(i).each(function(e){"ct_body_bgi_bak"==e.name&&(this.ipt_body_bgi_bak=e),"ct_body_bgr"==e.name&&(this.ipt_body_bgr=e),"ct_body_bgp_x"==e.name&&(this.ipt_body_bgp_x=e),"ct_body_bgp_y"==e.name&&(this.ipt_body_bgp_y=e),"ct_body_h"==e.name&&(this.ipt_body_h=e)}.bind(this)),this.ifm_body_bgi_up=e.getElementsByTagName("iframe")[0],this.elm_body_bgis=document.getElementsByClassName("bodyBgiSmp",e,"div"),setTimeout(function(){this.updateCusBodyData(),this.observeCusBody()}.bind(this),1),e},updateCusBodyData:function(){this.getStyle("body_bgi")&&"transparent"==this.getStyle("body_bgi")?this.activeOneBodyBgi("none"):""!=this.getStyle("body_bgi")?App.CusThemeLib.bodyBgi.getImg(this.getStyle("body_bgi"))?this.activeOneBodyBgi(this.getStyle("body_bgi")):this.activeOneBodyBgi("upload"):this.activeOneBodyBgi("default"),this.ipt_body_bgi_bak.value=this.getStyle("body_bak_bgi"),this.ipt_body_bgr.value=this.getStyle("body_bgr"),this.ipt_body_bgp_x.value=this.getStyle("body_bgp_x"),this.ipt_body_bgp_y.value=this.getStyle("body_bgp_y")},activeOneBodyBgi:function(e){$A(this.elm_body_bgis).each(function(t){t.firstChild.getAttribute("value")==e?(Element.addClassName(t,"bodyBgiSmp-active"),"none"==t.style.display&&Element.show(t)):Element.removeClassName(t,"bodyBgiSmp-active")})},observeCusBody:function(){$A(this.elm_body_bgis).each(function(e){Event.observe(e,"mouseover",function(){Element.addClassName(e,"bodyBgiSmp-over")}.bind(this)),Event.observe(e,"mouseout",function(){Element.removeClassName(e,"bodyBgiSmp-over")}.bind(this)),Event.observe(e,"click",function(){var t=e.firstChild.getAttribute("value");this.activeOneBodyBgi(t),Element.hide(this.ifm_body_bgi_up),"default"==t?(this.setCss("body","background-image",""),this.ipt_body_bgr.value&&(this.ipt_body_bgr.value="",this.setCss("body","background-repeat",""))):"none"==t?this.setCss("body","background-image","none"):"upload"==t?(Element.show(this.ifm_body_bgi_up),$F(this.ipt_body_bgi_bak)&&this.setCss("body","background-image","url("+$F(this.ipt_body_bgi_bak)+")")):(this.setCss("body","background-image","url("+t+")"),(_tiled=App.CusThemeLib.bodyBgi.getImg(t).tiled)&&this.ipt_body_bgr.value!=_tiled&&(this.ipt_body_bgr.value=_tiled,this.setCss("body","background-repeat",_tiled)))}.bind(this))}.bind(this)),Event.observe(this.ipt_body_bgr,"change",function(){this.setCss("body","background-repeat",this.ipt_body_bgr.value)}.bind(this)),Event.observe(this.ipt_body_bgp_x,"change",function(){var e="";(this.ipt_body_bgp_x.value||this.ipt_body_bgp_y.value)&&(e=(this.ipt_body_bgp_x.value||"left")+" "+(this.ipt_body_bgp_y.value||"top")),this.setCss("body","background-position",e)}.bind(this)),Event.observe(this.ipt_body_bgp_y,"change",function(){var e="";(this.ipt_body_bgp_x.value||this.ipt_body_bgp_y.value)&&(e=(this.ipt_body_bgp_x.value||"left")+" "+(this.ipt_body_bgp_y.value||"top")),this.setCss("body","background-position",e)}.bind(this))},analyesTagCss:function(e){var t=null,i=$(e);if(i){t={};var s=i.sheet||i.styleSheet,n=s.cssRules||s.rules;$A(n).each(function(e){var i=e.selectorText.toLowerCase().split(",");$A(i).each(function(i){var s=i.replace(/(^\s*)|(\s*$)/g,"");t[s]||(t[s]={});var n=e.style;$H(n).each(function(e){e.value&&"cssText"!=e.key&&"string"==typeof e.value&&0!=e.key.indexOf("Moz")&&isNaN(e.key-0)&&(t[s][e.key]=e.value)})})})}return t},getRuntimeCss:function(){var e=this.analyesTagCss("openTheme"),t=this.analyesTagCss("customTheme");return e&&t?Object.extend(e,t):e||t},analyesCss:function(){this.styles=this.getRuntimeCss()},getCss:function(e,t){this.styles||this.analyesCss();var i=t.camelize();return this.styles&&this.styles[e]?this.styles[e][i]?this.styles[e][i]:"":""},setCss:function(e,t,i){var s=$("customTheme");s||(s=document.createElement("style"),s.id="customTheme",s.type="text/css",document.getElementsByTagName("head")[0].appendChild(s));var n=s.sheet||s.styleSheet,o=n.cssRules||n.rules,a=o.length;if($A(o).each(function(i,s){if(i.selectorText.toLowerCase()==e&&i.style[t.camelize()])throw a=s,n.deleteRule?n.deleteRule(s):n.removeRule(s),$break}.bind(this)),i){var p=e+"{"+t+":"+i+";}";n.insertRule?n.insertRule(p,a):n.addRule(e,t+":"+i+";")}},getStyle:function(e){switch(e){case"header_bgi":return this.getCss("#header","background-image").replace(/url\((.*)\)/,"$1");case"header_bak_bgi":return this.getCss("#header-bak","background-image").replace(/url\((.*)\)/,"$1");case"header_bgr":return this.getCss("#header","background-repeat");case"header_bgp_x":return this.getCss("#header","background-position")?this.getCss("#header","background-position").split(" ")[0]:"";case"header_bgp_y":return this.getCss("#header","background-position")?this.getCss("#header","background-position").split(" ")[1]:"";case"header_h":return parseInt(this.getCss("#header","height"))||"";case"body_bgi":return this.getCss("body","background-image").replace(/url\((.*)\)/,"$1");case"body_bak_bgi":return this.getCss("body-bak","background-image").replace(/url\((.*)\)/,"$1");case"body_bgr":return this.getCss("body","background-repeat");case"body_bgp_x":return this.getCss("body","background-position")?this.getCss("body","background-position").split(" ")[0]:"";case"body_bgp_y":return this.getCss("body","background-position")?this.getCss("body","background-position").split(" ")[1]:"";default:return null}},getCustomStyles:function(){this.analyesCss();var e="";return e+="#header{background-image: "+this.getCss("#header","background-image")+";}",e+="#header{background-repeat: "+this.getCss("#header","background-repeat")+";}",e+="#header{background-position: "+this.getCss("#header","background-position")+";}",e+="#header{height: "+this.getCss("#header","height")+";}",e+="body{background-image: "+this.getCss("body","background-image")+";}",e+="body{background-repeat: "+this.getCss("body","background-repeat")+";}",e+="body{background-position: "+this.getCss("body","background-position")+";}"},getCustomSets:function(e){this.analyesCss();var t="";return t+="css|#header|bgi="+this.getCss("#header","background-image"),e||(t+="&css|#header-bak|bgi="+this.getCss("#header-bak","background-image")),t+="&css|#header|bgr="+this.getCss("#header","background-repeat"),t+="&css|#header|bgp="+this.getCss("#header","background-position"),t+="&css|#header|h="+this.getCss("#header","height"),t+="&css|body|bgi="+this.getCss("body","background-image"),e||(t+="&css|body-bak|bgi="+this.getCss("body-bak","background-image")),t+="&css|body|bgr="+this.getCss("body","background-repeat"),t+="&css|body|bgp="+this.getCss("body","background-position")},save:function(){var e=this.getCustomSets();App.Requester.request("customTheme",e);var t={type:"confirm",content:"自定义主题已生效。<br/><br/>提示：如果您再完善一些详细信息，就可以分享给其他博友使用。",okText:"分享",cancelText:"不分享",focus:!1,okAction:this.shareTheme.bind(this)};new PopWin(t)},saveOk:function(){var e=this.getCustomStyles();$("openTheme")&&Element.remove("openTheme"),$("customTheme").innerHTML=e},styleAllOk:function(){location.href=ToolBar.getBlogPath()},shareTheme:function(){switch(this.getThemeType()){case 3:var e=document.createElement("div");e.innerHTML='<form method="post" action="http://ow.blog.sohu.com/manage/theme.do?action=submittheme" target="_blank"><input type="hidden" name="theme" value="" /><input type="hidden" name="style" value="" /></form>',e=document.body.appendChild(e);var t=e.childNodes[0];t.theme.value=$("themeCss").getAttribute("themeid"),t.childNodes[1].value=this.getCustomSets(),t.submit();break;case 2:alert(App.Lang.noSharePay);break;default:alert(App.Lang.needCustom)}},getThemeId:function(){var e,t=$("themeCss");return(e=t.getAttribute("themeid"))&&"string"==typeof e&&e.length>0?e:null},getThemeType:function(){var e=$("customTheme"),t=$("openTheme"),i=null;if(""!=this.getCss("#header","background-image")||""!=this.getCss("body","background-image")){if(e)return 3;if(t)return 4}return(i=this.getThemeId())&&0==i.indexOf("g")?2:1},clean:function(){App.Requester.request("customThemeClean",this)},cleanOk:function(){var e=$("customTheme");e&&Element.remove(e),this.styles=null,setTimeout(function(){try{this.updateCusHeaderData()}catch(e){}try{this.updateCusBodyData()}catch(e){}}.bind(this),10),this.cusThemeWin.hide()},cancel:function(){$H(this.stylesTempl).each(function(e){$H(e.value).each(function(t){this.setCss(e.key,t.key.underscore().dasherize(),this.styles&&this.styles[e.key]&&this.styles[e.key][t.key]?this.styles[e.key][t.key]:"")}.bind(this))}.bind(this)),setTimeout(function(){try{this.updateCusHeaderData()}catch(e){}try{this.updateCusBodyData()}catch(e){}}.bind(this),10)},upHeadbgiOk:function(e){e&&(this.ipt_header_bgi_bak.value=e,this.setCss("#header-bak","background-image","url("+e+")"),this.setCss("#header","background-image","url("+e+")"))},upBodybgiOk:function(e){e&&(this.ipt_body_bgi_bak.value=e,this.setCss("body-bak","background-image","url("+e+")"),this.setCss("body","background-image","url("+e+")"))}};var Feed=function(e){this.root=e.responseXML.documentElement,this.type="feed"==this.root.nodeName?1:0;var t=1==this.type?this.root:this.root.getElementsByTagName("channel")[0],i=Element.getChildElementByTagName(t,"link");1==this.type?$A(i).each(function(e){("text/html"==e.getAttribute("type")||1==i.length)&&(this.htmlUrl=e.getAttribute("href"))}.bind(this)):this.htmlUrl=i[0].firstChild?i[0].firstChild.nodeValue:"",this.title=Element.getChildValueByTagName(t,"title")[0]||this.htmlUrl;var s=1==this.type?this.root.getElementsByTagName("tagline"):this.root.getElementsByTagName("description");this.description=s.length>0?s[0].firstChild?s[0].firstChild.nodeValue:"":"",this.items=[];var n=1==this.type?this.root.getElementsByTagName("entry"):this.root.getElementsByTagName("item");$A(n).each(function(e){var t={};t.node=e,t.enclosures=e.getElementsByTagName("enclosure");var i=Element.getChildElementByTagName(e,"title")[0];if(i&&i.firstChild)t.title=i.firstChild.nodeValue;else{var s=e.getElementsByTagName("description");if(s[0]){var n=document.createElement("div");n.innerHTML=s[0].firstChild.nodeValue,t.title=(n.innerText?n.innerText.substring(0,50):"")+"..."}else t.title="[...]"}var o=Browser.ua.indexOf("ie")>=0?e.getElementsByTagName("dc:date")[0]:e.getElementsByTagName("date")[0];e.getElementsByTagName("pubDate")[0]?t.date=e.getElementsByTagName("pubDate")[0].firstChild?e.getElementsByTagName("pubDate")[0].firstChild.nodeValue:"":o?t.date=o.firstChild.nodeValue:e.getElementsByTagName("issued")[0]&&(t.date=e.getElementsByTagName("issued")[0].firstChild.nodeValue);var a=Element.getChildElementByTagName(e,"link");a.length>0?1==this.type?$A(a).each(function(e){("text/html"==e.getAttribute("type")||1==a.length)&&(t.link=e.getAttribute("href"))}):a[0]||a[0].firstChild?t.link=a[0].firstChild?a[0].firstChild.nodeValue:"":e.getElementsByTagName("guid")[0].firstChild&&(t.link=e.getElementsByTagName("guid")[0].firstChild.nodeValue):t.link=this.htmlUrl,1==this.type?(t.content=e.getElementsByTagName("content")[0],t.description=e.getElementsByTagName("summary")[0]):(t.content=Browser.ua.indexOf("ie")>=0?e.getElementsByTagName("content:encoded")[0]:e.getElementsByTagName("encoded")[0],t.description=e.getElementsByTagName("description")[0]),this.items.push(t)}.bind(this))},PopWins={popWins:[],x:null,y:null,zIndex:2e3,register:function(e){this.popWins.push(e),0>Browser.ua.indexOf("ie")},unregister:function(e){this.popWins=this.popWins.reject(function(t){return t==e}),this.x-=10,this.y-=10,0>=this.popWins.length&&(this.x=this.y=null,this.zIndex=2e3,Event.stopObserving(window,"resize",this.eventResizeBgAll))},placeIt:function(e){document.body.appendChild(e.element),e.element.style.position="absolute",e.element.style.zIndex=this.zIndex++,e.element.style.width=e.options.width+"px",e.element.offsetHeight>=500&&(e.elm_content.style.height="500px"),this.x&&this.y?(this.x+=10,this.y+=10):(this.x=(document.body.offsetWidth-e.element.offsetWidth)/2,this.y=.6*Math.ceil((document.documentElement.clientHeight-e.element.offsetHeight)/2)+document.documentElement.scrollTop),e.element.style.left=this.x+"px",e.element.style.top=this.y+"px",e.dragObj=new Draggable(e.element,{handle:"t",zindex:this.zIndex}),this.eventCancelBubble=App.cancelBubble.bindAsEventListener(this),Event.observe(e.element,"mousedown",this.eventCancelBubble),Event.observe(e.element,"click",this.eventCancelBubble)},placeBg:function(e){document.body.appendChild(e.elm_bg);var t={background:"#666",position:"absolute",zIndex:this.zIndex++,left:"0px",top:"0px",width:document.body.offsetWidth+"px",height:Math.max(document.body.offsetHeight,document.documentElement.clientHeight)+"px"};Element.setStyle(e.elm_bg,t),this.eventResizeBgAll=this.resizeBgAll.bindAsEventListener(this),Event.observe(window,"resize",this.eventResizeBgAll),this.eventCancelBubble=App.cancelBubble.bindAsEventListener(this),Event.observe(e.elm_bg,"mousedown",this.eventCancelBubble),Event.observe(e.elm_bg,"click",this.eventCancelBubble),Browser.ua.indexOf("ie")>=0?Element.setOpacity(e.elm_bg,.5):(Element.setOpacity(e.elm_bg,0),new Effect.Opacity(e.elm_bg,{duration:.3,from:0,to:.5}))},resizeBgAll:function(){this.popWins.each(function(e){this.resizeBg(e)}.bind(this))},resizeBg:function(e){var t={width:document.body.offsetWidth+"px",height:Math.max(document.body.offsetHeight,document.documentElement.clientHeight)+"px"};Element.setStyle(e.elm_bg,t)}},PopWin=Class.create();PopWin.prototype={initialize:function(e){this.options=Object.extend({name:"popWin",type:"pop",focus:!0,title:"",ico:"info",content:"",html:!0,width:"250",okText:App.Lang.ok,okAction:null,okData:null,cancelText:App.Lang.cancel,cancelAction:null,cancelData:null,closeAction:null,closeData:null},e||{}),this.options.ico="ico_"+this.options.ico+".gif","pop"!=this.options.type&&(this.buildBg(),PopWins.placeBg(this)),this.build(),this.options.content&&(this.elm_content.innerHTML=this.options.html?this.options.content.replace(/\n/gi,"<br />"):this.options.content.convertTextToHTML().replace(/\n/gi,"<br />")),PopWins.placeIt(this),("alert"==this.options.type||"confirm"==this.options.type)&&(this.buildBtn(),setTimeout(this.getFocus.bind(this),10),this.eventGetFocus=this.getFocus.bindAsEventListener(this),Event.observe(this.elm_bg,"click",this.eventGetFocus),Event.observe(this.element,"click",this.eventGetFocus)),PopWins.register(this)},destroy:function(){Element.remove(this.element),this.elm_bg&&(Element.setOpacity(this.elm_bg,1),Element.remove(this.elm_bg)),PopWins.unregister(this)},build:function(){var e=document.createElement("div");this.element=e,e.id=this.options.name,e.className="popWin";var t=document.createElement("div");t.className="mod",e.appendChild(t);var i=document.createElement("div");this.elm_popWinFrame=i,i.className="modFrame",t.appendChild(i);var s="";s+='<table cellspacing="0" cellpadding="0" class="modTable" height="100%">',s+="<thead><tr>",s+='<td class="mheader lt"></td>',s+='<td class="mheader t"><div class="modHeader"></div></td>',s+='<td class="mheader rt"></td>',s+="</tr></thead>",s+="<tbody><tr>",s+='<td class="mbody l"></td>',s+='<td class="mbody c" height="100%"><div class="modCon"></div></td>',s+='<td class="mbody r"></td>',s+="</tr></tbody>",s+="<tfoot><tr>",s+='<td class="mfooter lb"></td>',s+='<td class="mfooter b"></td>',s+='<td class="mfooter rb"></td>',s+="</tr></tfoot>",s+="</table>",i.innerHTML=s,this.eventCancelBubble=App.cancelBubble.bindAsEventListener(this);var n=document.createElement("div");this.elm_close=n,n.className="modCls",n.title=App.Lang.close,Event.observe(n,"mousedown",this.eventCancelBubble),this.eventClose=this.closeAction.bindAsEventListener(this),Event.observe(n,"click",this.eventClose);var o=document.createElement("div");this.elm_ico=o,o.className="modIco",o.innerHTML='<img src="'+App.Actions.imgPath+this.options.ico+'" />';var a=document.createElement("div");this.elm_title=a,a.className="modTitle",a.appendChild(document.createTextNode(this.options.title||App.Lang.info));var p=document.getElementsByClassName("modHeader",i)[0];p.appendChild(n),p.appendChild(o),p.appendChild(a),Element.cleanWhitespace(this.element),this.elm_content=this.getPopWinContent()},getPopWinContent:function(){var e=this.element.firstChild.firstChild.firstChild,t=e.rows[1].cells[1].firstChild;return t},close:function(){this.destroy()},buildBg:function(){var e=document.createElement("div");this.elm_bg=e},buildBtn:function(){var e=document.createElement("div");e.className="divBtn";var t=document.createElement("input");if(this.okBtn=t,t.className="button-submit",t.type="button",t.value=this.options.okText,this.eventOkAction=this.okAction.bindAsEventListener(this),Event.observe(t,"click",this.eventOkAction),e.appendChild(t),"confirm"==this.options.type){var i=document.createElement("input");this.cancelBtn=i,i.className="button",i.type="button",i.value=this.options.cancelText,this.eventCancelAction=this.cancelAction.bindAsEventListener(this),Event.observe(i,"click",this.eventCancelAction),e.appendChild(i)}this.elm_content.parentNode.appendChild(e)},okAction:function(){this.close(),this.options.okAction&&(this.options.okData?this.options.okAction(this.options.okData):this.options.okAction(!0))},cancelAction:function(){this.close(),this.options.cancelAction&&(this.options.cancelData?this.options.cancelAction(this.options.cancelData):this.options.cancelAction(!1))},closeAction:function(){this.options.closeAction?(this.close(),this.options.closeData?this.options.closeAction(this.options.closeData):this.options.closeAction(!0)):"confirm"==this.options.type?this.cancelAction():"alert"==this.options.type?this.okAction():this.close()},getFocus:function(){("alert"==this.options.type||"confirm"==this.options.type)&&(this.options.focus===!1?this.cancelBtn.focus():this.okBtn.focus())}},App.ToolTip=function(e,t,i,s){function n(){return document.compatMode&&"BackCompat"!=document.compatMode?document.documentElement:document.body}function o(e){if(l){var t=Browser.ua.indexOf("ie")>=0?Event.pointerX(e):Event.pointerX(e),i=Browser.ua.indexOf("ie")>=0?Event.pointerY(e):Event.pointerY(e),s=Browser.ua.indexOf("ie")>=0&&"opera"!=Browser.ua?n().clientWidth-Event.pointerX(e)+n().scrollLeft-h:window.innerWidth-Event.pointerX(e)+window.pageXOffset-h-20,o=Browser.ua.indexOf("ie")>=0&&"opera"!=Browser.ua?n().clientHeight-Event.pointerY(e)+n().scrollTop-d:window.innerHeight-Event.pointerY(e)+window.pageYOffset-d-20,a=0>h?-1*h:-1e3;p.style.left=p.offsetWidth>s?Browser.ua.indexOf("ie")>=0?Event.pointerX(e)-p.offsetWidth+"px":Event.pointerX(e)-p.offsetWidth+"px":a>t?"5px":t+h+"px",p.offsetHeight>o?("safari"==Browser.ua?0:window.pageYOffset,p.style.top=Browser.ua.indexOf("ie")>=0?Event.pointerY(e)-p.offsetHeight-d+"px":Event.pointerY(e)-p.offsetHeight-d+"px"):p.style.top=i+d+"px"}}var a,p,h=0,d=20,l=!1;$("tooltip")?p=$("tooltip"):(p=document.createElement("div"),p.id="tooltip",p.className="mod",p.style.position="absolute",document.body.appendChild(p)),i||(i=200),s||(s="center"),this.display=function(e,t,i,s){o(window.event),Event.observe(document,"mousemove",o),Event.observe(e,"mouseout",this.hide,!1),p.style.textAlign=s,p.innerHTML='<div class="modFrame">'+t+"</div>",Element.show(p),p.offsetWidth>i&&(p.style.width=i+"px"),l=!0,a=setTimeout(this.hide,1e4)},this.hide=function(){clearTimeout(a),Event.stopObserving(document,"ousemove",o),l=!1,Element.hide(p)},this.display(e,t,i,s)};