var Comment={posturl:"/mini/a/comment/save.do",delurl:"/mini/a/comment/delete.do",defaultText:"添加评论",bindEvent:function(){this.bindEventByElement(document)},bindEventByElement:function(a){var b=a.getElementsByTagName("form");for(var c=0;c<b.length;c++){var e=b[c];if(e.id.indexOf("frmCmt_")!=-1){if(e.id.indexOf("_f")==-1){Event.observe(e.content,"click",this.onclickCtt.bind(e));Event.observe(e.content,"focus",this.onclickCtt.bind(e))}Event.observe(e.content,"keydown",this.shortcut.bindAsEventListener());Event.observe(e.content,"input",this.textConstrain.bindAsEventListener());Event.observe(e.content,"propertychange",this.textConstrain.bindAsEventListener());Event.observe(e.content,"change",this.textConstrain.bindAsEventListener());Event.observe(e,"submit",this.add.bind(e));var d=e.down(".btn");Event.observe(d,"click",this.add.bind(e))}}},shortcut:function(b){var a=Event.element(b);var c=a.up("form");if(b.ctrlKey&&b.keyCode==13){if(c){Comment.add.bind(c)()}}},textConstrain:function(f){var e=Event.element(f);var g=e.up("form");var b=e.value.trim();var d=280;if(Mini.Util.getTxtLength(b)>d){e.value=Mini.Util.limitTxt(b,d)}b=e.value.trim();var a=g.down("div.fcmInputNo");if(a){a=a.down("span")}if(a){var c=d-Mini.Util.getTxtLength(b);c=(c%2==0)?c/2:(c-1)/2;a.innerHTML=c}},autoHeight:function(b){var a=function(d){this.parentNode.style.height=this.offsetHeight+"px";var c=0;if(Prototype.Browser.IE||Prototype.Browser.WebKit){var c=parseInt($(this).getStyle("padding-top"))+parseInt($(this).getStyle("padding-bottom"))}if(Prototype.Browser.IE&&(this.style.height=(this.scrollHeight-c)+"px")){return}this.style.height="";this.style.height=(this.scrollHeight-c)+"px";this.parentNode.style.height=""};Event.observe(b,"propertychange",a.bind(b));Event.observe(b,"input",a.bind(b))},clearHeight:function(a){a.style.height=""},getIdStr:function(a){var b=a.appId.value+"_"+a.apiid.value;if(a.random){b+="_"+a.random.value}return b},onclickCtt:function(){$(this.content).removeClassName("blank");clearInput(this.content,Comment.defaultText)},add:function(){if(this.content.value.trim()==Comment.defaultText){this.content.value=""}if(this.content.value.trim()==""){emptyContentAlert(this.content);return}var pars="appId="+this.appId.value+"&apiid="+this.apiid.value+"&tuid="+this.tuid.value+"&url="+encodeURIComponent("http://t.sohu.com/document/detail.do?u="+this.tuid.value+"&id="+this.apiid.value)+"&picsrc="+this.picsrc.value+"&auids="+this.auids.value+"&content="+encodeURIComponent(this.content.value.trim())+"&format="+encodeURIComponent(this.format.value.trim())+"&sname="+encodeURIComponent("微博")+"&title="+encodeURIComponent(this.title.value.trim());if($("did"+this.apiid.value)){pars+="&tm="+$("did"+this.apiid.value).value}var sbmtBtn=this.down(".btn");sbmtBtn.innerHTML='<b><i class="i iloading"></i>提交中</b>';sbmtBtn.addClassName("btn_dis");new Ajax.Request(Comment.posturl,{method:"post",parameters:pars,onComplete:function(response){sbmtBtn.innerHTML="<b>提 交</b>";sbmtBtn.removeClassName("btn_dis");if(response.status==200){eval("var json="+response.responseText);if(json){if(json.status==1){Comment.clearHeight(this.content);var n1=$("cmtcnt_"+Comment.getIdStr(this)+"_1");var n2=$("cmtcnt_"+Comment.getIdStr(this)+"_2");if(this.format.value==0){this.content.value="";this.auids.value="";var cbdiv=$(this).down("div.fcmInt");if(cbdiv){if(!cbdiv.visible()){cbdiv.show()}cbdiv.innerHTML+=json.data.view}var noteEl=this.down("div.fcmInputNo");if(noteEl){noteEl=noteEl.down("span")}if(noteEl){noteEl.innerHTML="140"}}else{this.content.value="";this.auids.value="";if($("noCommentNote")){var cbdiv=new Element("ul");cbdiv.id="cmtnew_"+this.appId.value+"_"+this.apiid.value;$("noCommentNote").replace(cbdiv)}else{var cbdiv=$("cmtnew_"+this.appId.value+"_"+this.apiid.value)}if(cbdiv){cbdiv.innerHTML+=json.data.view;if(!cbdiv.visible()){cbdiv.show()}}var commentNum=0;if(n1&&n1.innerHTML!=""){commentNum=parseInt(n1.innerHTML)}var cmtFrmdiv=$("cmtfullfrm_"+this.appId.value+"_"+this.apiid.value);if(cmtFrmdiv&&!cmtFrmdiv.visible()&&commentNum>=3){cmtFrmdiv.show()}}if(n1){if(n1.innerHTML==""){n1.replace("("+n1.inspect()+(parseInt(n1.innerHTML==""?0:n1.innerHTML)+1)+"</span>)")}else{n1.innerHTML=parseInt(n1.innerHTML==""?0:n1.innerHTML)+1}}if(n2){n2.innerHTML=parseInt(n2.innerHTML==""?0:n2.innerHTML)+1}}else{Mini.MsgBox.alert(json.statusText)}}}else{Mini.MsgBox.alert("服务器异常错误，请稍后重试")}}.bind(this)});return false},del:function(eA,iB,iC,iD){if(!User.isLogin()){Mini.MsgBox.alert("您未登录，无法执行此操作");return}Mini.MsgBox.confirm("确认删除此篇评论?",function(){eA=$(eA);var cmtCtner=eA.up("li.tcItem");var pars="appId="+iB+"&apiid="+iC+"&cId="+iD;new Ajax.Request(Comment.delurl,{method:"get",parameters:pars,onComplete:function(response){if(response.status==200){eval("var json="+response.responseText);if(json){if(json.status==1){if(cmtCtner){Mini.Vision.slideRemove(cmtCtner,{interval:20})}var n1=$("cmtcnt_"+iB+"_"+iC+"_1");if(n1){if(n1.innerHTML==""){}else{var num=parseInt(n1.innerHTML==""?0:n1.innerHTML)-1;n1.innerHTML=num}}}else{Mini.MsgBox.alert(json.statusText)}}}else{Mini.MsgBox.alert("服务器异常错误，请稍后重试")}}.bind(this)})})},showForm:function(b,a,f){b=b?b:(window.event?window.event:null);var e=b.srcElement?b.srcElement:b.target;var d=$("cmtlst_"+a+"_"+f);var c=$("frmCmt_"+a+"_"+f);Event.stop(b);if((d&&d.visible())||(!d&&c.visible())){c.content.focus();return}if(d){d.show();c.content.focus();outEvent([d,e],function(){if(!d||!c||!c.content){return}if(c.content.value.trim()==""||c.content.value.trim()=="添加评论"){d.hide();return true}})}},reply:function(h,e,d,a,q){h=$(h);if(a&&a=="simple"){var k=h.up("div.feedItem")}else{var k=h.up("li.tcItem")}if(k){var g=k.down(".fcmHead");if(g){g=g.down("a");var o=g.innerHTML.trim()}}if(a&&a=="simple"){var j=$("frmCmt_"+e+"_"+d)}else{var j=$("frmCmt_"+e+"_"+d);var i=$("cmtfullfrm_"+e+"_"+d);if(!i.visible()){i.show()}}var l="@"+o+" ";if(j){j.content.focus();var m=j.content.value.trim();if(m=="添加评论"){m=""}m=m.replace(l,"");m=l+m;j.content.value=m;if(q){var p=j.auids.value.trim();var b=p.split(",");var n=false;b.each(function(c){if(c==q){n=true;return}});if(!n){p=(p!="")?(p+","+q):q;j.auids.value=p}}}}};function lsl(m,i){if(!m){return}i=i||{};var j=document.getElementsByTagName("script");for(var p=0;p<m.length;p++){var r=m[p];var o=false;for(var q=0;q<j.length;q++){var n=j[q].getAttribute("src");if(n&&n==r){o=true;break}}if(!o){var l=(i.charset)?' charset="'+i.charset+'"':"";document.write('<script type="text/javascript" src="'+r+'" '+l+"><\/script>")}}}function outEvent(e,f){var d=function(m){m=m?m:(window.event?window.event:null);var b=m.srcElement?m.srcElement:m.target;var n=b;var i=true;var a=$("pagePop");while(n!=document.body){for(var c=0;c<this.length;c++){if(n==this[c]){i=false;break}else{if(n==a){i=false;break}}}if(!i){break}n=n.parentNode;if(!n){break}}if(i){var l=f();if(l){Event.stopObserving(document.body,"click",d)}}}.bind(e);Event.observe(document.body,"click",d)}function emptyContentAlert(e){var d=[255,200,200];e.style.backgroundColor="rgb("+d[0]+","+d[1]+","+d[2]+")";var f=setInterval(function(){d[1]+=10;d[2]+=10;if(d[1]>255){clearInterval(f)}e.style.backgroundColor="rgb("+d[0]+","+d[1]+","+d[2]+")"},100)}var friendlyTime=function(k){var m=new Date();var n=m.getTime()-k;var l=Math.floor(n/(60*1000));var i=Math.floor(l/60);var h=Math.floor(i/24);var j="";if(h>=1){j+=h;j+="天"}else{if(i<48&&i>0&&(i%24)>0){j+=i%24;j+="小时"}else{if(i<=0&&(l%60<=2)){return"刚刚"}if(i<24){j+=l%60;j+="分钟"}}}j+="前";return j};function needLoginAlert(c){var d=c||"未登录，无法执行此操作！";Mini.MsgBox.alert(d,function(){if(ToolBar){setTimeout(ToolBar.needLogin,300)}})}function deRep(b){return b.replace(/-/g,"+").replace(/_/g,"/")}function clearText(b){if(typeof b!="string"){return b}return b.replace(/</ig,"&lt;").replace(/>/ig,"&gt;").replace(/"/ig,"&quot;").replace(/'/ig,"&apos;")}function clearInput(f,e,d){var f=$(f);if(!e||f.value.trim()==e){f.value="";if(d&&typeof d=="function"){d()}}}function restoreInput(f,e,d){var f=$(f);if(e&&f.value.trim()==""){f.value=e;if(d&&typeof d=="function"){d()}}}if(typeof(HTMLElement)!="undefined"&&!window.opera){HTMLElement.prototype.__defineGetter__("outerHTML",function(){var a=this.attributes,e="<"+this.tagName,f=0;for(;f<a.length;f++){if(a[f].specified){e+=" "+a[f].name+'="'+a[f].value+'"'}}if(!this.canHaveChildren){return e+" />"}return e+">"+this.innerHTML+"</"+this.tagName+">"});HTMLElement.prototype.__defineSetter__("outerHTML",function(e){var d=this.ownerDocument.createRange();d.setStartBefore(this);var f=d.createContextualFragment(e);this.parentNode.replaceChild(f,this);return e});HTMLElement.prototype.__defineGetter__("canHaveChildren",function(){return !/^(area|base|basefont|col|frame|hr|img|br|input|isindex|link|meta|param)$/.test(this.tagName.toLowerCase())})}if(!Mini){var Mini={}}Mini.Emotion={emotions:{1:"[:)]",2:"[#_#]",3:"[8*)]",4:"[:D]",5:"[:-)]",6:"[:P]",7:"[B_)]",8:"[B_I]",9:"[^_*]",10:"[:$]",11:"[:|]",12:"[:(]",13:"[:.(]",14:"[:_(]",15:"[):(]",16:"[:V]",17:"[*_*]",18:"[:^]",19:"[:?]",20:"[:!]",21:"[=:|]",22:"[:%]",23:"[:O]",24:"[:X]",25:"[|-)]",26:"[:Z]",27:"[:9]",28:"[:T]",29:"[:-*]",30:"[*_/]",31:"[:#|]",32:"[:69]",33:"[//shuang]",34:"[//qiang]",35:"[//ku]",36:"[//zan]",37:"[//heart]",38:"[//break]",39:"[//F]",40:"[//W]",41:"[//mail]",42:"[//strong]",43:"[//weak]",44:"[//share]",45:"[//phone]",46:"[//mobile]",47:"[//kiss]",48:"[//V]",49:"[//sun]",50:"[//moon]",51:"[//star]",52:"[(!)]",53:"[//TV]",54:"[//clock]",55:"[//gift]",56:"[//cash]",57:"[//coffee]",58:"[//rice]",59:"[//watermelon]",60:"[//tomato]",61:"[//pill]",62:"[//pig]",63:"[//football]",64:"[//shit]"},mdiv:null,ediv:null,pdiv:null,ouput:null,pg:null,psz:32,tpg:2,init:function(){if(Mini.Emotion._hasInit){return}this._buildFrame();this._buildContent();Mini.Emotion._hasInit=true},_buildFrame:function(){this.mdiv=new Element("div");this.mdiv.className="popLayer emotLayer";var a='<div class="decor"><span class="tl"></span><span class="tr"></span><span class="br"></span><span class="bl"></span></div><iframe style="width: 230px; height: 146px;" class="maskIframe"></iframe><div class="content"><div class="emotBox"><div class="emots">';a+='</div><div class="pager pager-simple"><span class="pagePrev pageNow" data-key="up">上一页</span><a href="javascript:void(0)" class="pagePrev" data-key="up">上一页</a><span data-key="page">1</span><a href="javascript:void(0)" class="pageNext ">下一页</a><span class="pageNext pageNow">下一页</span></div></div></div>';this.mdiv.innerHTML=a;this.mdiv.hide();if($("pagePop")){$("pagePop").appendChild(this.mdiv)}else{document.body.appendChild(this.mdiv)}this.ediv=document.getElementsByClassName("emots",this.mdiv)[0];this.pctner=document.getElementsByClassName("pager",this.mdiv)[0];this.pctner=this.pctner.getElementsByTagName("span")[1];this.dpup=document.getElementsByClassName("pagePrev",this.mdiv,"SPAN")[0];this.pup=document.getElementsByClassName("pagePrev",this.mdiv,"A")[0];this.dpdown=document.getElementsByClassName("pageNext",this.mdiv,"SPAN")[0];this.pdown=document.getElementsByClassName("pageNext",this.mdiv,"A")[0]},_buildContent:function(d){if(!d){d=1}d=parseInt(d);if(d<=0){d=1}if(d>this.tpg){d=this.tpg}if(this.pg==d){return}this.pg=d;var a=(d-1)*this.psz+1;var c=new Array();for(var b=a;b<a+this.psz;b++){c.push('<a class="emot e-base-'+b+'" name="'+b+'" href="javascript:void(0);"></a>')}this.ediv.innerHTML=c.join(" ");this._buildPager();this._bindEvent()},_buildPager:function(){if(this.pg>1){this.pup.show();this.dpup.hide()}else{this.pup.hide();this.dpup.show()}this.pctner.innerHTML=this.pg;if(this.pg<this.tpg){this.pdown.show();this.dpdown.hide()}else{this.pdown.hide();this.dpdown.show()}},_bindEvent:function(){var a=this.ediv.getElementsByTagName("A");for(var c=0;c<a.length;c++){var d=a[c];Event.observe(d,"click",this._onclickImg)}var e=document.getElementsByClassName("pageNext",this.mdiv,"A")[0];if(e){Event.observe(e,"click",function(){this._buildContent(this.pg+1)}.bind(this))}var b=document.getElementsByClassName("pagePrev",this.mdiv,"A")[0];if(b){Event.observe(b,"click",function(){this._buildContent(this.pg-1)}.bind(this))}},_onclickImg:function(evt){evt=evt?evt:(window.event?window.event:null);var elem=evt.srcElement?evt.srcElement:evt.target;var id=elem.name;eval("var s=Mini.Emotion.emotions["+id+"]");Mini.Emotion.ouput.value+=s;Mini.Emotion.mdiv.hide()},show:function(a){if(!Mini.Emotion._hasInit){Mini.Emotion.init()}a=a?a:(window.event?window.event:null);var b=a.srcElement?a.srcElement:a.target;Position.clone(b,Mini.Emotion.mdiv,{setLeft:true,setTop:true,setWidth:false,setHeight:false,offsetTop:-150,offsetLeft:0});Mini.Emotion.mdiv.show();Mini.Emotion.ouput=this;outEvent([Mini.Emotion.mdiv,b],function(){Mini.Emotion.mdiv.hide();return true})}};if(!Mini){var Mini={}}Mini.Forward={txtConstrain:function(e,d,b){if(!e){return}d=d||280;var a=e.value.trim();if(Mini.Util.getTxtLength(a)>d){e.value=Mini.Util.limitTxt(a,d)}a=e.value.trim();if(b){var c=d-Mini.Util.getTxtLength(a);c=(c%2==0)?c/2:(c-1)/2;b.innerHTML=c}},showForm:function(ouid,oid,puid,pid,el){if(!el){return}el=$(el);var postEl=el.up("li.feedItem");var forwardEl=postEl.down("div.quoteBox");if(forwardEl){var forwardTxtEl=forwardEl.down("span.ForwardTxt");if(!forwardTxtEl){return}var forwardTxt=forwardTxtEl.innerHTML}else{var forwardTxtEl=postEl.down("span.ForwardTxt");var forwardTxt=forwardTxtEl.innerHTML}forwardTxt=Mini.Util.limitTxt(forwardTxt,280);var str="<b>转：</b>"+forwardTxt+'<div style="padding:20px 0 0 10px"><div class="PopContentTxtTips">还可以输入<span id="forwardReasonCharLeft">140</span>个汉字</div><textarea rows="10" cols="50" id="forwardReason" class="text blank">随便说点什么吧……</textarea></div>';Mini.MsgBox.confirmExt("",str,function(){clearInput($("forwardReason"),"随便说点什么吧……");var forwardReason=$("forwardReason").value.trim();var url="/mini/a/document/save.do";var pars="s=icon&ouid="+ouid+"&oid="+oid+"&puid="+puid+"&pid="+pid+"&content="+encodeURIComponent(forwardReason);new Ajax.Request(url,{method:"post",parameters:pars,onComplete:function(response){if(response.status==200){eval("var forwardJson = "+response.responseText);if(forwardJson){if(forwardJson.status==1){Mini.MsgBox.alert("转发成功");Mini.Post.addToList(forwardJson);return}else{if(forwardJson.statusText.indexOf("未登录")!=-1){needLoginAlert("登录后才能转发微博");return}else{Mini.MsgBox.alert(forwardJson.statusText);return}}}else{Mini.MsgBox.alert("转发失败,返回数据格式错误");return}}else{Mini.MsgBox.alert("转发失败,服务器返回错误，请稍后重试");return}Mini.MsgBox.alert("转发失败")}})});var reasonEl=$("forwardReason");if(reasonEl){Event.observe(reasonEl,"click",function(){clearInput(reasonEl,"随便说点什么吧……",function(){reasonEl.removeClassName("blank")})});Event.observe(reasonEl,"blur",function(){restoreInput(reasonEl,"随便说点什么吧……",function(){reasonEl.addClassName("blank")})});Event.observe(reasonEl,"propertychange",function(){Mini.Forward.txtConstrain(reasonEl,280,$("forwardReasonCharLeft"))});Event.observe(reasonEl,"input",function(){Mini.Forward.txtConstrain(reasonEl,280,$("forwardReasonCharLeft"))});Event.observe(reasonEl,"change",function(){Mini.Forward.txtConstrain(reasonEl,280,$("forwardReasonCharLeft"))})}}};var __def__={dialog:{},call:function(a,b){if(!a||!b||!this[a]||!this[a][b]){return}return this["fn_"+a](b)},fn_dialog:function(a){Dialog.instance(this.dialog[a])}};var webim_config={product:"sohu/blog",cm_menu_width:"90",load_panel:true,cm_showtip:false,cm_GenMenu:function(a,c){for(var b=c.length-1;b>=0;b--){if(c[b].n=="传纸条"){c[b].n="发送小纸条";c[b].t="给 $NICK 传小纸条"}if(c[b].n=="加为好友"){c[b].n="加为小纸条好友";c[b].t="加 $NICK 为小纸条好友"}}},cm_menu:[{id:"poke",n:"向他打招呼",t:"向他打招呼",c:function(a){if(typeof(pokeHe)=="function"){pokeHe(a._id)}else{window.open("http://poke.blog.sohu.com/pop/poking.do?actId=1&pp="+a._id,"_blank","width=630,height=470")}}}]};var Emotion={iconPath:"http://js3.pp.sohu.com.cn/ppp/images/emotion/",lib:[["[moved]","12.gif","感动"],["[smile]","3.gif","搞笑"],["[suprise]","22.gif","疯狂"],["[sweet]","36.gif","温馨"],["[cool]","34.gif","酷"],["[end]","32.gif","爽"],["[powerful]","33.gif","强"],["[admire]","35.gif","赞"]],getEmotion:function(c){for(var b=0;b<this.lib.length;b++){var a=this.lib[b];if(a[0]==c){return a}}return null},getEmotionIcon:function(b){var d="";for(var c=0;c<this.lib.length;c++){var a=this.lib[c];if(a[0]==b){d+='<img src="'+this.iconPath+a[1]+'" alt="'+a[2]+'" title="'+a[2]+'" ec="'+b+'" />'}}return d},getEmotionIcons:function(){var c="";for(var b=0;b<this.lib.length;b++){var a=this.lib[b];c+='<img src="'+this.iconPath+a[1]+'" alt="'+a[2]+'" title="'+a[2]+'" ec="'+a[0]+'" />'}return c},unescapeUbb:function(a){a=a.replace(/\[moved\]/g,Emotion.getEmotionIcon("[moved]"));a=a.replace(/\[smile\]/g,Emotion.getEmotionIcon("[smile]"));a=a.replace(/\[suprise\]/g,Emotion.getEmotionIcon("[suprise]"));a=a.replace(/\[sweet\]/g,Emotion.getEmotionIcon("[sweet]"));a=a.replace(/\[cool\]/g,Emotion.getEmotionIcon("[cool]"));a=a.replace(/\[end\]/g,Emotion.getEmotionIcon("[end]"));a=a.replace(/\[powerful\]/g,Emotion.getEmotionIcon("[powerful]"));a=a.replace(/\[admire\]/g,Emotion.getEmotionIcon("[admire]"));return a}};var Refer={init:function(a){this.ctrJ=J(a);this.ctrJ.html("加载中...");this.requestIds()},requestIds:function(){if(Blog.getDomain()=="null"){this.noGotIds();return}var a="http://stat.pic.sohu.com/blogcount?u="+Blog.getDomain()+"&k=rv";new Groj(a,{variable:"referid",onSuccess:this.gotIds.bind(this),onFailure:this.noGotIds.bind(this)})},gotIds:function(a){if(typeof(a)=="string"&&a.length>0&&a!="0"){this.requestRefers(a)}else{this.noGotIds()}},noGotIds:function(){this.ctrJ.html('新来的吧，还没有人发现你哦。<a href="http://blog.sohu.com/morefreshblogs.html" target="_blank">快去和大家打个招呼吧！</a>')},requestRefers:function(b){var a="/frag/referfrag.jsp?u="+Blog.getDomain()+"&ids="+b;new Ajax.Request(a,{onSuccess:this.gotRefers.bind(this),onFailure:this.noGotRefers.bind(this)})},gotRefers:function(a){if(a.responseText.length>0){this.ctrJ.html(a.responseText);setTimeout(this.addTime.bind(this),0)}else{this.noGotRefers()}},noGotRefers:function(){this.noGotIds()},addTime:function(){if(!(typeof(referidtime)=="string"&&referidtime.length>0)){return}if(this.ctrJ.length==0||!this.ctrJ.eles[0]){return}var e=this.ctrJ.eles[0].getElementsByTagName("img"),f=referidtime.split(",");if(typeof(referid)=="string"&&referid.length>0){var c=referid.split(",");for(var b=0,a=c.length;b<a;b++){if(c[b]==_ebi){if(b<f.length){f.splice(b,1)}break}}}for(var b=0,a=Math.min(e.length,f.length);b<a;b++){var d=f[b];if(isNaN(d)||parseInt(d)==0){continue}e[b].alt=e[b].title=Time.friendly(d)}}};var Blog={};Object.extend(Blog,{express:function(a,b){return' name="_xp_'+a+'" xpexpress="'+b+'" '},request:function(a){if(a.length>0){var c=[];for(var d=0;d<a.length;d++){if(c[a[d]]){continue}c.push(a[d]);c[a[d]]=true}var b="/service/userinfo.jsp?xp="+c.join(",");new Groj(b,{onSuccess:Blog.gettedBlog})}},gettedBlog:function(b){if(!b){return}for(var a in b){if(b[a]&&typeof(b[a].url)=="string"){Blog.setBlog(a,b[a])}}},setBlog:function(k,c){var a="_xp_"+k;var l=document.getElementsByName(a);for(var e=0;e<l.length;e++){var f=l[e];var b=f.getAttribute("xpexpress");if(typeof(b)=="string"&&b.length>0){var g=b.split(";");for(var d=0;d<g.length;d++){var h=g[d].split(":");if(h.length!=2){continue}switch(h[0]){case"html":f.innerHTML=c[h[1]];break;case"value":f.value=c[h[1]];break;default:f.setAttribute(h[0],c[h[1]]);break}}}}}});Object.extend(Blog,{getTitle:function(){if(!$("homeTitle")){return null}return($("homeTitle").firstChild.innerHTML)},getLink:function(){if(!$("blogUrl")){return null}return($("blogUrl").lastChild.href)},getDesc:function(){return""}});Object.extend(Blog,{getDomain:function(){return _blog_domain}});Object.extend(Blog,{addToFav:function(g){var d=Blog.getTitle();var f=Blog.getDesc();var c=Blog.getLink();if(!d||!c){alert("无法获得此站点相应数据");return}if(ToolBar){ToolBar.disableBtn(ToolBar.addLink)}LoadBar.show("读取中...");var a="/manage/link.do";var b="m=add&title="+escape(d)+"&desc="+escape(f.substr(0,64)||"")+"&link="+escape(c)+"&subscribe=1";var e=new Ajax.Request(a,{method:"post",parameters:b,onComplete:Blog.doneAddToFav})},doneAddToFav:function(request,json,data){setTimeout(function(){if(ToolBar){ToolBar.ableBtn(ToolBar.addLink)}},1000);if(!request||!request.responseText){alert("Error: The resource file is not well-formed.\n"+request.responseText);return}var data=eval("("+request.responseText+")");switch(data.status){case 0:LoadBar.show("已加为好友","ok");break;case 3:LoadBar.show("已加为好友","ok");break;default:var str="Error code: "+data.status+"\n";str+="Error Message: "+data.statusText+"\n";str+="Please contact administrators.\n";alert(str);break}setTimeout(LoadBar.hide,1000)}});var addToFav=Blog.addToFav;var LoadBar={show:function(b,a){clearTimeout(this.timeout);b=b||"loading...";this.build(b);if(a=="ok"){Element.addClassName(this.element,"okBar")}else{Element.removeClassName(this.element,"okBar")}Element.show(this.element);this.element.style.right="0px";this.element.style.top=document.documentElement.scrollTop+30+"px";this.showStatusBar(b)},hide:function(a){if(LoadBar.element){LoadBar.timeout=setTimeout(function(){if(LoadBar.element){Element.hide(LoadBar.element)}LoadBar.hideStatusBar()},((a&&!isNaN(a))?a:0))}},destroy:function(){if(this.element){Element.remove(this.element);this.element=null}},build:function(c){if(this.element){this.element.firstChild.firstChild.alt=c;this.element.firstChild.childNodes[1].nodeValue=c;return}this.element=document.createElement("div");Element.addClassName(this.element,"loadBar");this.element.style.zIndex=1000;this.element.style.position="absolute";Element.hide(this.element);var b=document.createElement("div");var a="http://js1.pp.sohu.com.cn/ppp/blog/styles_ppp/images/loading.gif";b.innerHTML='<img src="'+a+'" alt="text" />'+c;this.element.appendChild(b);document.body.appendChild(this.element)},showStatusBar:function(a){setTimeout(function(){window.status=a},10)},hideStatusBar:function(){setTimeout(function(){window.status=""},10)}};function isPPLogin(){var a;if(typeof PassportSC!="undefined"&&(a=getPPP())){return true}return false}function isLogin(){if(isPPLogin()){var a;if((a=getP())&&a==getPPP()&&hasBlog()){return true}return false}return false}function getP(){if(!BlogCookieInfo.cookie||!BlogCookieInfo.cookie.P){BlogCookieInfo.parseCookie()}var b=BlogCookieInfo.cookie.P;var d="";if(b){try{d=b64_decodex(b);if(d.indexOf("@")<0){d=""}}catch(a){}return d}else{return""}}function getPPP(){if(typeof PassportSC!="undefined"&&PassportSC&&PassportSC.cookieHandle){var a=PassportSC.cookieHandle();if(a.indexOf("@focus.cn")>0){a=PassportSC.cookie.uid+"@focus.cn"}return a}return""}function getProduct(a){if(!a){return false}if(typeof PassportSC=="undefined"||!PassportSC){return false}if(!PassportSC.cookie||!PassportSC.cookie.service){PassportSC.parsePassportCookie()}if(PassportSC.cookie.service[a]!=0){return PassportSC.cookie.service[a]}else{return false}}var BlogCookieInfo={cookie:{},parseCookie:function(){if(!getCookie("bloginfo")){return false}var a=getCookie("bloginfo").split("|");if(a[0]){this.cookie.P=a[0]}if(a[1]){this.cookie.I=a[1]}if(a[2]){this.cookie.ud=a[2]}if(a[3]){this.cookie.B_TP=a[3]}if(a[4]){this.cookie.name=unescape(a[4])}if(a[5]){this.cookie.ico=a[5]}},clear:function(){this.cookie={}}};function hasBlog(){if(!BlogCookieInfo.cookie||!BlogCookieInfo.cookie.I){BlogCookieInfo.parseCookie()}var a=BlogCookieInfo.cookie.I;if(a!=null&&a!=""&&a!="null"&&getUserType()!="3"){return a}return false}function getXP(){if(!BlogCookieInfo.cookie||!BlogCookieInfo.cookie.ud){BlogCookieInfo.parseCookie()}return BlogCookieInfo.cookie.P}function getD(){if(!BlogCookieInfo.cookie||!BlogCookieInfo.cookie.ud){BlogCookieInfo.parseCookie()}return BlogCookieInfo.cookie.ud}function isMyBlog(){if(!BlogCookieInfo.cookie||!BlogCookieInfo.cookie.I){BlogCookieInfo.parseCookie()}if(isLogin()&&hasBlog()&&(typeof _ebi!="undefined")&&_ebi){if(BlogCookieInfo.cookie.I==_ebi){return true}}return false}function getUserType(){if(!BlogCookieInfo.cookie||!BlogCookieInfo.cookie.B_TP){BlogCookieInfo.parseCookie()}return BlogCookieInfo.cookie.B_TP}function getUserName(){if(!BlogCookieInfo.cookie||!BlogCookieInfo.cookie.name){BlogCookieInfo.parseCookie()}return BlogCookieInfo.cookie.name}function getUserIco(){if(!BlogCookieInfo.cookie||!BlogCookieInfo.cookie.ico){BlogCookieInfo.parseCookie()}return BlogCookieInfo.cookie.ico}function is17173User(){return(getP()&&getP().indexOf("@17173")>0)}function getBlogTitle(){if(!$("blogTitle")){return null}return($("blogTitle").lastChild.innerHTML)}function getBlogLink(){if(!$("blogTitle")){return null}return($("blogTitle").lastChild.href)}function getBlogDesc(){if(!$("blogDesc")){return null}return($("blogDesc").innerHTML)}var User={getXpt:getXP,isAdmin:isMyBlog};var ChinarenFeed=Class.create({initialize:function(a){this.setOptions(a)},setOptions:function(a){this.options=Object.extend({size:10,path:"http://i.chinaren.com/feed/feedBlogAction.jsp?t=1&"},a||{})},request:function(){var b="_jn_cr_feed";var a=this.options.path+"name="+b+"&c="+Time.now();new Groj(a,{variable:b,onSuccess:this.getResponse.bind(this),onFailure:this.noGetResponse.bind(this)})},getResponse:function(a){if(!a||a.status!=0){this.noGetResponse(a)}else{this.showList(a.data)}},noGetResponse:function(a){$(this.options.listEl).innerHTML=!!a&&a.statusText?a.statusText:"不能取得数据"},showList:function(e){var a=[];if(e&&e.length){var c=ChinarenFeed.types;for(var b=0;b<e.length;b++){var d=e[b];if(!d){continue}a.push('<div class="item"><div class="blogIco">');a.push('<a href="'+d.link+'" title="'+d.nick+'" target="_blank"><img class="v32img" src="'+d.ico+'" title="'+d.nick+'" alt="'+d.nick+'" /></a>');a.push('</div><div class="content"><dl><dt>');a.push('<a href="'+d.link+'" title="'+d.nick+'" target="_blank">'+d.nick+"</a>&nbsp;");a.push((c[d.type]||"")+"&nbsp;"+d.title+"<small>"+Time.friendly(d.ctime));a.push("</small></dt><dd>");a.push(d.desc||" ");a.push("</dd></dl></div></div>")}}if(a.length==0){a.push("暂无同学动态")}var f=$(this.options.listEl);f.innerHTML=a.join("");setTimeout(function(g){f.select("a").each(function(h){h.target="_blank"})},0)}});ChinarenFeed.types={"1001":"的近况","1002":"更新了","1101":"发留言","1102":"上传了照片","1103":"共享了文件","1104":"上传了视频","1105":"回复了","1107":"评论了","1108":"圈了","1109":"评论了","1201":"发起投票","1202":"申请加入","1203":"加入咱班了，欢迎！","1206":"成为咱班的管理员"};ChinarenFeed.init=function(a){var b=new ChinarenFeed(a);b.request();return b};function timeStamp(){var a=new Date();return(a.getTime())}var ImgRotat=Class.create({initialize:function(a){this.id=a;this.flag=0;this.createBigImgArea();var b="imgSmallDiv"+this.id;this.imgBigDiv=$("imgBigDiv"+this.id);this.imgSmallObj=$("imgSmallId"+this.id);this.imgBigObj=$("imgBigId"+this.id);this.cavnsObj=$("cavId"+this.id);this.inputObj=$("imgBigSrc"+this.id);this.inputOrgObj=$("imgOrgSrc"+this.id);this.direction="r";this.imgLoading=$("imgLoading"+this.id);this.imgBigInnerDiv=$("imgBigInnerDiv"+this.id);this.loadFlag=true},showThispic:function(){if(Prototype.Browser.IE){this.imgBigInnerDiv.style.display="block";this.cavnsObj.hide();this.resizeBigImgWidth();this.imgBigObj.show();this.imgLoading.hide();this.imgBigInnerDiv.setStyle({height:"auto","line-height":"20px",padding:"5px 10px 6px"})}else{var a=this.cavnsObj.getContext("2d");this.cavnsObj.setAttribute("width",this.imgBigObj.width);this.cavnsObj.setAttribute("height",this.imgBigObj.height);this.resizecavnsWidth();a.drawImage(this.imgBigObj,0,0);this.imgBigObj.hide();this.imgLoading.hide();this.imgBigInnerDiv.setStyle({height:"auto","line-height":"20px",padding:"5px 10px 6px"});this.cavnsObj.show()}},showBig:function(){if(!$("imgBigDiv"+this.id)){this.initialize(this.id)}this.imgSmallObj.hide();this.imgBigDiv.show();this.imgBigInnerDiv.setStyle({height:"0",overflow:"hidden","line-height":"0",padding:"0"});this.imgLoading.show();if(this.loadFlag){this.imgBigObj.onload=function(){this.loadFlag=false;this.showThispic()}.bind(this);this.imgBigObj.setAttribute("src",this.inputObj.value)}else{this.showThispic()}},showSmall:function(){this.imgSmallObj.show();this.imgBigDiv.hide()},rotat:function(b){this.direction=b;if(this.direction=="r"){this.flag++}else{if(this.direction=="l"){this.flag--}}if(this.flag>3){this.flag=0}else{if(this.flag<0){this.flag=this.flag+4}}if(Prototype.Browser.IE){this.imgBigObj.style.filter="progid:DXImageTransform.Microsoft.BasicImage(Rotation="+this.flag+")"}else{var a=this.cavnsObj.getContext("2d");switch(this.flag){case 0:this.cavnsObj.setAttribute("width",this.imgBigObj.width);this.cavnsObj.setAttribute("height",this.imgBigObj.height);this.resizecavnsWidth();a.drawImage(this.imgBigObj,0,0);break;case 1:this.cavnsObj.setAttribute("width",this.imgBigObj.height);this.cavnsObj.setAttribute("height",this.imgBigObj.width);a.rotate(90*Math.PI/180);this.resizecavnsWidth();a.drawImage(this.imgBigObj,0,-this.imgBigObj.height);break;case 2:this.cavnsObj.setAttribute("width",this.imgBigObj.width);this.cavnsObj.setAttribute("height",this.imgBigObj.height);a.rotate(180*Math.PI/180);this.resizecavnsWidth();a.drawImage(this.imgBigObj,-this.imgBigObj.width,-this.imgBigObj.height);break;case 3:this.cavnsObj.setAttribute("width",this.imgBigObj.height);this.cavnsObj.setAttribute("height",this.imgBigObj.width);a.rotate(270*Math.PI/180);this.resizecavnsWidth();a.drawImage(this.imgBigObj,-this.imgBigObj.width,0);break}this.imgBigObj.hide();this.cavnsObj.show()}},resizeBigImgWidth:function(){var b=this.imgBigObj.offsetHeight;var a=this.imgBigObj.offsetWidth;var c=420;if(b>c&&a>c){if(b>a){this.imgBigObj.height=""+c}else{this.imgBigObj.width=""+c}}else{if(b>c){this.imgBigObj.height=""+c}if(a>c){this.imgBigObj.width=""+c}}},resizecavnsWidth:function(){var a=420;if(this.cavnsObj.width>a){this.cavnsObj.setAttribute("class","canArea width580")}else{this.cavnsObj.setAttribute("class","canArea")}},createBigImgArea:function(){var d=$("imgOrgSrc"+this.id).value;var c=document.createElement("div");c.setAttribute("id","imgBigDiv"+this.id);c.className="imgArea";var b=this.id;var a="<div id=imgLoading"+b+" class=loadingImg></div><div id=imgBigInnerDiv"+b+" class=imgAreaInner><div class=btn><span class=btnTurn><a target=_blank href="+d+"><span class='icon i-imgShoworgal'></span>查看原图</span></a><span class=split>|</span><span class=btnTurn onClick=ImgRotat.rotat('l','"+b+"');><span class='icon i-imgTurnLeft'></span>向左旋转</span><span class=split>|</span><span class=btnTurn onClick=ImgRotat.rotat('r','"+b+"');><span class='icon i-imgTurnRight'></span>向右旋转</span></div><canvas id=cavId"+b+" class=canArea onclick=ImgRotat.showSmall('"+b+"')></canvas><img src='' id=imgBigId"+b+" class=smallShow onclick=ImgRotat.showSmall('"+b+"')></div><i class=lt></i><i class=rt></i><i class=lb></i><i class=rb></i>";c.innerHTML=a;$("imgSmallDiv"+b).insert(c)}});ImgRotat.config={};ImgRotat.showBig=function(a){if(!ImgRotat.config[a]){ImgRotat.config[a]=new ImgRotat(a)}ImgRotat.config[a].showBig()};ImgRotat.showSmall=function(a){ImgRotat.config[a].showSmall()};ImgRotat.rotat=function(b,a){ImgRotat.config[a].rotat(b)};if(!Mini){var Mini={}}Mini.MsgBox={alert:function(b,a){Mini.ConfirmBox.reset();Mini.ConfirmBox.show({type:"alert",title:"提示",notice:b,fnOk:a})},confirm:function(b,a){Mini.ConfirmBox.reset();Mini.ConfirmBox.show({type:"confirm",title:"确认",notice:b,fnOk:a})},confirmExt:function(e,d,c,b,a){Mini.ConfirmBox.reset();if(typeof a=="undefined"){a=true}Mini.ConfirmBox.show({type:"confirm",title:b||"确认",notice:e,ext:d,fnOk:c,needReturn:a})}};Mini.ConfirmBox=Class.create({initialize:function(){this.box=new Element("div");this.box.setStyle({display:"none",position:"absolute",zIndex:"2000"});this.box.addClassName("mwin");this.box.innerHTML='<table id="add_tw_window" class="mwin1" style=""><thead><tr><td class="bx"></td><td class="by"></td><td class="bz"></td></tr></thead><tfoot><tr><td class="bx"></td><td class="by"></td><td class="bz"></td></tr></tfoot><tbody><tr><td class="bx"></td><td class="by"><div class="mwt"><div class="ttl twWinTitle"><span></span><a href="javascript:void(0);" onclick="return false;" class="mw_close close overlayCanB" title="关闭"><b>跳 过</b></a></div></div><div class="mw mw_a mw02"><div class="mwc"><div class="repost"><div class="repost_c"></div><div class="post"><p class="btns2"><span class="opt"></span><a class="btn" href="javascript:void(0);"><b>确 定</b></a><a class="btn btn_dis" href="javascript:void(0);"><b>取 消</b></a></p></div></div></div></div></td><td class="bz"></td></tr></tbody></table>';this.closeBtn=this.box.down("a.mw_close");this.okBtnCtner=this.box.down("a.btn");this.cancelBtnCtner=this.box.down("a.btn_dis");this.okBtn=this.box.down("a.btn");this.cancelBtn=this.box.down("a.btn",1);this.titleDiv=this.box.down("span");this.noticeDiv=this.box.down("div.repost_c");document.body.appendChild(this.box);this.cancelBtn.observe("click",this.hide.bind(this));this.closeBtn.observe("click",this.hide.bind(this))},show:function(a){Cover.show();a=Object.extend({type:"alert",title:"",notice:"",fnOk:function(){},test:""},a||{});this.titleDiv.innerHTML=a.title||"";this.noticeDiv.innerHTML=a.notice||"";if(a.ext){this.noticeDiv.innerHTML+=a.ext}if(a.type=="confirm"){this.okBtn.observe("click",function(){if(a.needReturn){a.fnOk()}else{this.hide();a.fnOk()}}.bind(this));this.cancelBtnCtner.show()}else{if(a.fnOk){Event.observe(this.okBtn,"click",Event.stop.bindAsEventListener(this));this.okBtn.observe("click",function(){this.hide();a.fnOk()}.bind(this))}else{this.okBtn.observe("click",this.hide.bind(this))}this.cancelBtnCtner.hide()}var b=Dom.getCenterPos(this.box);this.box.setStyle({top:b.top+"px",left:b.left+"px"});this.box.show();this.okBtn.focus()},hide:function(){this.box.hide();this.reset();Cover.hide()},reset:function(){this.okBtn.stopObserving("click")}});Mini.ConfirmBox.show=function(b,a){if(!Mini.ConfirmBox._instance){Mini.ConfirmBox._instance=new Mini.ConfirmBox()}Mini.ConfirmBox._instance.show(b,a)};Mini.ConfirmBox.hide=function(){(Mini.ConfirmBox._instance&&Mini.ConfirmBox._instance.hide())};Mini.ConfirmBox.reset=function(){(Mini.ConfirmBox._instance&&Mini.ConfirmBox._instance.reset())};if(!Mini){var Mini={}}Mini.Post={pg:0,sz:20,delNum:0,listUrl:"/mini/a/document/jsonlist.do",addUrl:"/mini/a/document/save.do",delUrl:"/mini/a/document/delete.do",feedUrl:"http://mnf.blog.sohu.com/message",addEntryUrl:"/manage/entry.do?m=quickPost",type:-1,defaultTxt:"在做什么呢?",getXpt:function(){return window._xpt},feedMore:function(i,a){if(this.loadingData){return}this.loadingData=true;var d="hfeed"+Time.now();var g=$("postList");var e=$("homeFeedMore");var h=$("homeWaitFeed");var f=$("showMoreFeed");var j=$("noMoreFeed");if(typeof i=="number"){this.type=i}else{if(typeof i=="undefined"){this.type=-1}}if(this.type==33&&a){window.open("http://t.sohu.com/home");this.loadingData=false;return}if(!h){Mini.MsgBox.alert("等待页面加载中...");return}if(!a){this.pg=0;g.innerHTML='<div class="feedDefault">正在读取数据...';j.hide();f.show();h.hide();e.hide();this._feedTabShow(this.type)}else{f.hide();h.show()}var c=this.pg+1;var b=this.feedUrl+"?pp="+this.getXpt();if(this.type>=0){b+="&type="+this.type}b+="&st="+((c-1)*this.sz-this.delNum)+"&sz="+this.sz;window.setTimeout(function(){new Groj(b,{variable:d,timeout:40000,onSuccess:function(k){h.hide();if(k.status==1&&k.data){Mini.Post.pg++;var l=document.createElement("div");l.innerHTML=k.data.view;if(!a){g.innerHTML=""}g.insert(l);f.show();e.show();Mini.Post._feedHover(l);Comment.bindEventByElement(l);$call(function(){blog.user.User.fill()},"blog.user")}else{if(!a){g.innerHTML='<div class="feedDefault">暂未好友动态，赶紧通过<a href="http://profile.blog.sohu.com/search.htm" target="_blank">找朋友</a> 工具，找到志同道合的人~</div>'}else{f.hide();j.show()}}Mini.Post.loadingData=false},onFailure:function(){h.hide();if(!a){g.innerHTML='<div class="feedDefault">不能取得相关数据，请稍后重试</div>'}else{Mini.MsgBox.alert("不能取得相关数据，请稍后重试")}Mini.Post.loadingData=false}})},5)},_feedHover:function(b){b=b||document;b=$(b);var a=document.getElementsByClassName("feedItem",b);for(var c=0;c<a.length;c++){var d=a[c];Event.observe(d,"mouseover",function(){$(this).addClassName("hover")}.bind(d));Event.observe(d,"mouseout",function(){$(this).removeClassName("hover")}.bind(d))}},_feedTabShow:function(f){if(!f){f=-1}var a=$("feedTabs");if(!a){return}var d=a.getElementsByTagName("li");for(var c=0;c<d.length;c++){var e=d[c];var b=e.getAttribute("feedtype");if(b&&b==f){e.className="on"}else{e.className=""}}},bindInputEvent:function(a){a=$(a);Event.observe(a,"focus",function(){if(a.value.trim()==Mini.Post.defaultTxt){a.value="";a.addClassName("focus")}});Event.observe(a,"blur",function(){if(a.value.trim()==""){a.value=Mini.Post.defaultTxt;a.removeClassName("focus")}})},addToList:function(d){var f=$("postList");if(f){var c=new Element("div");f.insert({top:c});c.setStyle({height:"0px",overflow:"hidden"});c.innerHTML=d.data.view;var b=c.getElementsByTagName("li")[0];b=$(c);var e=function(){var k=b.getHeight();var j=0;j=parseInt(b.getStyle("padding-top"))+parseInt(b.getStyle("padding-bottom"));if(isNaN(j)){j=0}k-=j;b.setStyle({height:"0px",overflow:"hidden"});c.replace(b);var i=0;var g=setInterval(function(){i+=10;if(i>k){i=k}b.setStyle({height:i+"px"});if(i>=k){clearInterval(g);b.setStyle({height:""})}},40);Comment.bindEventByElement(b);Mini.Post._feedHover(b)};var a=b.down("img");if(a){setTimeout(e,500)}else{e()}}},add:function(fA){if(fA.content.value.trim()==Mini.Post.defaultTxt){fA.content.value=""}if(fA.content.value.trim()==""){emptyContentAlert(fA.content);return}var pars="l="+fA.l.value+"&content="+encodeURIComponent(fA.content.value.trim())+"&file="+fA.file.value+"&s="+(fA.s?fA.s.value:"");if(fA.tag){pars+="&tag="+encodeURIComponent(fA.tag.value.trim())}new Ajax.Request(Mini.Post.addUrl,{method:"post",parameters:pars,onComplete:function(response){if(response.status==200){eval("var json="+response.responseText);if(json){if(json.status==1){fA.reset();Mini.Post.Uploader.reset();var tarea=$(fA.content);var tparent=$(tarea.parentNode);var sucessEl=new Element("div",{className:"success"});sucessEl.className="success";tarea.hide();tparent=$(tparent);tparent.insert(sucessEl);sucessEl.show();var op=1;var sItid=setInterval(function(){sucessEl.setOpacity(op);op=op-0.1;if(op<=0){clearInterval(sItid);sucessEl.remove();tarea.show()}},50);if(json.data.url){window.location.href=json.data.url}else{if((Mini.Post.type==33||Mini.Post.type==-1)){Mini.Post.addToList(json)}else{setTimeout(function(){Mini.Post.feedMore(33)},500)}}Mini.Post.getLastMini()}else{Mini.MsgBox.alert(json.statusText)}}}else{Mini.MsgBox.alert("发布失败，请稍后重试")}}})},del:function(eA,iB,iC,iD){Mini.MsgBox.confirm("确认删除此篇微博?",function(){eA=$(eA);var postCtner=eA.up("div.mblogPosts");postCtner=$(postCtner);if(typeof iD=="undefined"){iD=1}var pars="id="+iB+"&u="+iC+"&l="+iD;new Ajax.Request(Mini.Post.delUrl,{method:"get",parameters:pars,onComplete:function(response){if(response.status==200){eval("var json="+response.responseText);if(json){if(json.status==1){if(json.data.url){window.location.href=json.data.url}else{if(postCtner){var _h=postCtner.getHeight();postCtner.setStyle({overflow:"hidden"});var itid=setInterval(function(){_h=_h-40;if(_h<0){_h=0}postCtner.setStyle({height:_h+"px"});if(_h<=0){clearInterval(itid);postCtner.remove()}},100)}Mini.Post.delNum++}}else{Mini.MsgBox.alert(json.statusText)}}}else{Mini.MsgBox.alert("服务器异常错误，请稍后重试")}}})})},addEntry:function(fA){if(fA.entrytitle.value.trim()==""){emptyContentAlert(fA.entrytitle);return}if(fA.entrycontent.value.trim()==""){emptyContentAlert(fA.entrycontent);return}var pars="entrytitle="+encodeURIComponent(encodeURIComponent(fA.entrytitle.value.trim()))+"&entrycontent="+encodeURIComponent(encodeURIComponent(fA.entrycontent.value.trim()))+"&categoryId="+fA.categoryId.value;fA.sbmtbtn.disabled=true;fA.sbmtbtn.innerHTML="提交中..";new Ajax.Request(Mini.Post.addEntryUrl,{method:"post",parameters:pars,onComplete:function(response){fA.sbmtbtn.disabled=false;fA.sbmtbtn.innerHTML="发布博文";if(response.status==200){eval("var json="+response.responseText);if(json){if(json.status==1){Mini.MsgBox.alert("发布成功",function(){fA.reset();Mini.Post.Tab.hideExtTab();if((Mini.Post.type==1||Mini.Post.type==-1)){Mini.Post.addToList(json)}})}else{Mini.MsgBox.alert(json.statusText)}}else{Mini.MsgBox.alert("发布失败，请稍后重试.")}}else{Mini.MsgBox.alert("发布失败，请稍后重试")}}})},shortcut:function(c,b){if(c.ctrlKey&&c.keyCode==Event.KEY_RETURN){var a=Event.element(c);var d=a.up("form");if(d){Mini.Post.add(d,b)}}},getLastMini:function(){var a="http://t.sohu.com/a/document/jsonlist.do?to=wg&st=0&sz=10";var b="lastMini"+(new Date()).getTime();a+="&xpt="+window._xpt+"&vn=lastMini="+b;new Groj(a,{variable:b,charset:"UTF-8",onSuccess:function(d){if(typeof d.status!="undefined"&&d.status==1){if(d.mini.length>0){var c=d.mini[0];var e=c.ext.title;e=Mini.Util.limitTxt(e,30);$("lastMiniContent").innerHTML='：<a href="http://t.sohu.com/m/'+c.ext.did+'" target="_blank">'+e+"</a>";$("lastMiniTime").innerHTML=friendlyTime(c.ext.createdat)}}},onFailure:function(){}})}};Mini.Post.Uploader={init:function(){this.fA=document.forms.uploadForm;this.fB=document.forms.frmPost;this.eC=$("picUploader");this.eD=$("picUploadExt");this.eE=$("coPicUpload");this.eF=$("picUploadingMsg");this.eG=$("picUploadedName");this.eH=$("picUploaded");this.eI=$("picPreview");this.eJ=$("picUploadedMsg");this._init=true;Position.clone(this.eC,this.eD,{setLeft:true,setTop:true,setWidth:false,setHeight:false,offsetTop:28,offsetLeft:-10})},upload:function(){if(!this._init){this.init()}this.eI.innerHTML="";this.fA.submit();this.eC.hide();this.eJ.hide();this.eF.show()},cbUploadImg:function(e){if(!this._init){return}if(e&&e.img){this.fB.file.value=e.img;var c=e.img.split(/[\[\]]/);var g="";if(c&&c.length==3){g=c[0];var d=c[1].split(/[,]/);if(d.length>=2){g+=1}else{g+=0}g+=c[2]}else{var g=e.img}var b=g.substring(g.lastIndexOf("/")+1);if(b.length>15){b=b.substring(0,8)+"..."+b.substring(b.length-3)}this.eG.innerHTML=b;this.eF.hide();this.eC.hide();this.eJ.show();var a=new Element("img",{src:g});this.eI.hide();this.eI.innerHTML="";this.eI.insert(a);a.observe("load",function(){this.eI.show()}.bind(this));if(this.fB.content&&(this.fB.content.value.trim()==""||this.fB.content.value.trim()=="分享图片")){this.fB.content.value="分享图片";Mini.Util.selectText(this.fB.content,0,this.fB.content.value.length)}}else{if(e&&e.msg){var f=e.msg}Mini.MsgBox.alert("上传失败，请检查图片格式或图片大小超过5M");this.reset()}},preview:function(){this.eD.show()},cancelPreview:function(){this.eD.hide()},cancel:function(){this.reset()},reset:function(){if(!this._init){this.init()}this.eC.show();this.eF.hide();this.eJ.hide();this.eE.value="";this.fB.file.value="";this.fA.reset();var a=window.location.host;if(a.indexOf(".sohu.com")!=-1){this.fA.d.value=a.substring(0,a.indexOf(".sohu.com"))}$("uploadFrame").src=""}};Mini.Q={getXpt:function(){return window._xpt},wdtUrl:"http://q.sohu.com/user/",wdtService:"groups",wdtVarfix:"Q.user_"+this.wdtService,outputEle:null,maxNum:0,getJsonName:function(){return"Q.user_groups"},showGroup:function(a){this.outputEle=$("myGroups");if(!this.outputEle){return}if(a){this.maxNum=a}var c=this.getXpt();var b=this.wdtUrl+"!"+c+"/"+this.wdtService+"!json";this.loadingData();new LinkFile(b,{type:"script",noCache:false,callBack:{variable:this.getJsonName(),onLoad:this.loadedData.bind(this),onFailure:this.noData.bind(this)}})},loadedData:function(){try{var data=eval("("+this.getJsonName()+")");if(data!=null){var str="";if(data.length){var num=(this.maxNum<=0)?data.length:Math.min(data.length,this.maxNum);str+='<ul class="friends">';for(var i=0;i<num;i++){var dataNow=data[i];var ico=dataNow.ico;var title=dataNow.title;var url=dataNow.url;var modifiedImg=this.getUpdateImg(dataNow.modified);str+='<li><a href="'+url+'" target="_blank">'+title+"</a>"+modifiedImg+"</li>"}str+="</ul>";str+='<div class="more"><a href="http://blog.sohu.com/home/soGroup/groups.do" target="_blank">查看全部</a></div>';this.outputEle.innerHTML=str}else{this.noData()}}}catch(e){this.noData()}},noData:function(){this.outputEle.innerHTML='<p>你还没加入过任何圈子，去<a target="_blank" href="http://q.sohu.com">圈子</a>转转<p>'},loadingData:function(){this.outputEle.innerHTML="正在读取数据..."},getUpdateImg:function(g){var h="";var f=4;var e="好久没更新了，去顶顶支持一下";var c=new Date().getTime();var b=c-g;if(b<0){b=0}var d=Math.floor(b/(60*1000));var a=Math.floor(d/(24*60));if(d<60){f=1;e="刚刚更新，快去抢个沙发～"}else{if(a<1){f=2;e=Math.floor(d/60)+"小时前更新，去看看有什么新帖子"}else{if(a<7){f=3;e=a+"天前更新，去顶顶支持一下"}}}h='<img class="news_info" title="'+e+'" alt="'+e+'" src="http://js4.pp.sohu.com.cn/ppp/blog/styles/images/ico_upn_'+f+'.gif" align="absmiddle" />';return h}};Mini.Post.Tab={extTabsEl:null,layerCtner:null,init:function(){this.extTabsEl=$("extPostTabs");this.layerCtner=$("postTabLayers");this.defaultH=this.layerCtner.getHeight();this.layerCtner.setStyle({height:(this.layerCtner.getHeight())+"px"});this.hasInit=true},showTab:function(a){if(!this.hasInit){this.init()}if(this.currentTab==a){return}var c=$(a);if(!c){return}this._clearTabs();c.show();var b=c.getHeight();this.extTabsEl.setStyle({top:(-b)+"px"});this.showExtTab();this.currentTab=a},_clearTabs:function(){$("entryTab").hide();$("extPostTabs").setStyle({top:"-10000px"})},showExtTab:function(){if(!this.hasInit){this.init()}if(this.running){return}var c=this.extTabsEl.getHeight();var b=-c;var a=setInterval(function(){b=b+40;if(b>=0){b=0}this.extTabsEl.setStyle({top:b+"px"});if(c+b>this.layerCtner.getHeight()){this.layerCtner.setStyle({height:(c+b)+"px"})}if(b==0){clearInterval(a);this.running=false}}.bind(this),20);this.running=true},hideExtTab:function(){if(!this.hasInit){this.init()}if(this.running){return}var c=this.extTabsEl.getHeight();var b=0;var a=setInterval(function(){b=b-40;if(b<-c){b=-c}this.extTabsEl.setStyle({top:b+"px"});if(c+b<this.layerCtner.getHeight()){if(c+b<this.defaultH){this.layerCtner.setStyle({height:(this.defaultH)+"px"})}else{this.layerCtner.setStyle({height:(c+b)+"px"})}}if(b==-c){clearInterval(a);this._clearTabs();this.running=false}}.bind(this),20);this.running=true;this.currentTab=null}};Refer=Object.extend(Refer,{requestRefers:function(b){var a="/frag/resentVisitor_new.jsp?u="+Blog.getDomain()+"&ids="+b;new Ajax.Request(a,{onSuccess:this.gotRefers.bind(this),onFailure:this.noGotRefers.bind(this)})},gotRefers:function(a){if(a.responseText.length>0){this.ctrJ.html(a.responseText);setTimeout(this.addTime.bind(this),0)}else{this.noGotRefers()}},addTime:function(){if(!(typeof(referidtime)=="string"&&referidtime.length>0)){return}if(this.ctrJ.length==0||!this.ctrJ.eles[0]){return}var e=this.ctrJ.eles[0].getElementsByTagName("li"),g=referidtime.split(",");if(typeof(referid)=="string"&&referid.length>0){var c=referid.split(",");for(var b=0,a=c.length;b<a;b++){if(c[b]==_ebi){if(b<g.length){g.splice(b,1)}break}}}for(var b=0,a=Math.min(e.length,g.length);b<a;b++){var d=g[b];if(isNaN(d)||parseInt(d)==0){continue}var f=document.createElement("p");f.className="time";f.innerHTML=friendlyTime(d);e[b].appendChild(f)}}});function homeMessageCenter(){var a=setInterval(function(){var d=ToolBar.configs.requestVn;if(window[d]){clearInterval(a);var m;if((m=window[d])&&m.status==0&&(m=m.data)){var k=["requestCount","noticeCount","messageCount","notice1Count","notice3Count","notice4Count","notice8Count","notice9Count","request5Count","request6Count","notice10Count"];var f=[];for(var g=0,j=k.length;g<j;g++){f.push(m[k[g]])}var h=parseInt(f[8]);var e=parseInt(f[9]);var l=parseInt(f[3]);if($("msgCenterFriend")){if(h!=0){$("msgCenterFriend").innerHTML='<a href="http://blog.sohu.com/home/soRequest/request.do?m=listfriend" target="_blank">'+h+"条</a>"}else{$("msgCenterFriend").innerHTML='<b class="grey">0条</b>'}}if($("msgCenterQ")){if(e!=0){$("msgCenterQ").innerHTML='<a href="http://blog.sohu.com/home/soRequest/request.do?m=listgroup" target="_blank">'+e+"条</a>"}else{$("msgCenterQ").innerHTML='<b class="grey">0条</b>'}}if($("msgCenterBlog")){if(l!=0){$("msgCenterBlog").innerHTML='<a href="http://blog.sohu.com/home/soRequest/inform.do?type=1" target="_blank">'+l+"条</a>"}else{$("msgCenterBlog").innerHTML='<b class="grey">0条</b>'}}}}},2000);var c="http://t.sohu.com/a/user/get?auth=abc&passport="+b64_decodex(window._xpt);var b="miniBaseInfo"+(new Date()).getTime();c+="&vn="+b;new LinkFile(c,{type:"script",charset:"utf-8",noCache:false,callBack:{variable:b,onLoad:function(){if(window[b]){var d=window[b].new_ated;if(d&&d!=0){$("msgCenterMini").innerHTML='<a href="http://t.sohu.com/t/at.jsp" target="_blank">'+d+"条</a>"}else{$("msgCenterMini").innerHTML='<b class="grey">0条</b>'}}},onFailure:function(){}}})}if(!Mini){var Mini={}}Mini.Share={fwInfo:{from:encodeURIComponent("搜狐微博"),content:""},toBlog:function(b){var a=this.getUrl(b);var c=this.getTitle(b,"escape");window.open("http://share.blog.sohu.com/submit.jhtml?shareType=0&url="+a+"&title="+c,"一键转帖到搜狐博客");return false},toBai:function(b){var a=this.getUrl(b);var c=this.getTitle(b);window.open("http://bai.sohu.com/share/blank/addbutton.do?from="+this.fwInfo.from+"&link="+a+"&title="+c,"一键转帖到白社会");return false},toKaixin:function(b){var a=this.getUrl(b);var d=this.getTitle(b);var c=this.getContent(b);window.open("http://www.kaixin001.com/repaste/share.php?rtitle="+d+"&rurl="+a+"&rcontent="+c,"一键转帖到开心网");return false},toXiaonei:function(b){var a=this.getUrl(b);var c=this.getTitle(b);window.open("http://share.renren.com/share/buttonshare.do?link="+a+"&title="+c,"一键转帖");return false},toDouban:function(b){var a=this.getUrl(b);var c=this.getTitle(b);window.open("http://www.douban.com/recommend/?url="+a+"&title="+c,"转帖");return false},getUrl:function(b){b=b||Mini.Share.EventEl;b=$(b);try{if(b.tagName!="a"){b=b.up("a")}var a=b.previous("span").innerHTML;if(a.indexOf("http://")==-1){a="http://"+window.location.host+a}var a=encodeURIComponent(a)}catch(c){var a=""}return a},getTitle:function(c,b){c=c||Mini.Share.EventEl;c=$(c);var e="";try{var d=c.up("div.feedItem");d=d.down("div.feedHead");if(b=="escape"){e=escape(d.innerHTML.replace(/<[^>]*>/ig,""))}else{e=encodeURIComponent(d.innerHTML.replace(/<[^>]*>/ig,""))}}catch(a){}e=e.replace(/%A0/g,"%20");return e},getContent:function(a){a=a||Mini.Share.EventEl;a=$(a);try{var c=encodeURIComponent(a.up("div.feedItem").down("h4").down("p").innerHTML)}catch(b){var c=""}c=c.replace(/%A0/g,"%20");return c},showSites:function(a){var b=Event.element(a);this._buildList();Position.clone(b,this.layer,{setLeft:true,setTop:true,setWidth:false,setHeight:false,offsetTop:20,offsetLeft:0});if(!Mini.Share.layer.visible()||Mini.Share.EventEl!=b){Mini.Share.layer.show();Event.stop(a);outEvent([Mini.Share.layer],function(){Mini.Share.layer.hide();return true})}else{if(Mini.Share.EventEl==b){Mini.Share.layer.hide()}}Mini.Share.EventEl=b;return false},_buildList:function(){if(Mini.Share.hasBuild){return}this.layer=new Element("div",{"class":"popLayer"});this.layer.className="popLayer";this.layer.setStyle({width:"75px"});var f='<div class="decor"><span class="tl"><span class="tr"><span class="br"><span class="bl"></span></span></span></span></div><div class="content"></div>';this.layer.innerHTML=f;this.layer.hide();var e=[{title:"搜狐博客",icon:"i-st-blog",handler:"toBlog"},{title:"白社会",icon:"i-st-bai",handler:"toBai"},{title:"开心网",icon:"i-st-kaixin",handler:"toKaixin"},{title:"人人网",icon:"i-st-renren",handler:"toXiaonei"},{title:"豆瓣网",icon:"i-st-douban",handler:"toDouban"}];var d=this.layer.getElementsByTagName("div")[1];d=$(d);for(var b=0;b<e.length;b++){var a=e[b];var c=new Element("div");c.className="shareLi";c.innerHTML='<a href="javascript:void(0)" onclick="Mini.Share.'+a.handler+'()" title="'+a.title+'"><i class="i '+a.icon+'"></i>'+a.title+"</a>";d.insert(c)}if($("pagePop")){$("pagePop").appendChild(this.layer)}else{document.body.appendChild(this.layer)}Mini.Share.hasBuild=true}};var ScrollWin={w3c:document.getElementById,iex:document.all,scrollLoop:false,scrollInterval:null,currentBlock:null,getWindowHeight:function(){if(this.iex){return(document.documentElement.clientHeight)?document.documentElement.clientHeight:document.body.clientHeight}else{return window.innerHeight}},getScrollLeft:function(){if(this.iex){return(document.documentElement.scrollLeft)?document.documentElement.scrollLeft:document.body.scrollLeft}else{return window.pageXOffset}},getScrollTop:function(){if(this.iex){return(document.documentElement.scrollTop)?document.documentElement.scrollTop:document.body.scrollTop}else{return window.pageYOffset}},getElementYpos:function(a){var b=0;while(a.offsetParent){b+=a.offsetTop;a=a.offsetParent}return b},scrollTo:function(g,e){var a=this.getWindowHeight();var i=document.body.scrollHeight||document.documentElement.clientHeight;if(e>i-a){e=i-a}if(this.scrollLoop){var b=this.getScrollLeft();var f=this.getScrollTop();var a=this.getWindowHeight();var c=5;if(Math.abs(b-g)<=c&&Math.abs(f-e)<=c){window.scrollTo(g,e);clearInterval(this.scrollInterval);this.scrollLoop=false;this.scrollInterval=null}else{var h=Math.ceil((g-b)/10);var d=Math.ceil((e-f)/10);if(d==0){d=-1}window.scrollTo(b+h/Math.abs(h)*Math.max(c,Math.abs(h)),f+d/Math.abs(d)*Math.max(c,Math.abs(d)))}}else{this.scrollInterval=setInterval("ScrollWin.scrollTo("+g+","+e+")",20);this.scrollLoop=true}}};var GuidTip={isInit:false,closeBtn:null,okBtn:null,infoEl:null,tipFrame:null,setMask:null,topArr:null,framePosition:{left:0,top:0},step:0,stepReleaseFn:function(){},step0Info:"<h3>欢迎您来到搜狐博客空间</h3><p>空间是博客的管理后台，同时它也是系统消息中心，和好友动态的汇集地。</p>",step1Info:"微博就是“一句话博客”。<br/>将生活中有趣的事情、突发的感想，在这里用一句话或者图片发布到互联网中与朋友们分享。",step2Info:"是否同意TA加你为好友，谁给你的博客留了言，谁在微博中提到你？请关注这里",step3Info:"在“设置”中，可以换头像，改密码，修改个人信息",init:function(){if(this.isInit){return}this.tipFrame=new Element("div");this.tipFrame.className="guideLay";this.tipFrame.setStyle({display:"none"});this.tipFrame.innerHTML=' <div class="guideLayInt"><div class="gidArrTop"></div><div class="gidClose"><a></a></div><div class="gidInfo"></div><div class="gidBtn"><span class="stepf"><span>1</span>/3</span><input type="button" class="btn" value="我知道了"/></div></div>';this.topArr=this.tipFrame.down("div.gidArrTop");this.closeBtn=this.tipFrame.down("div.gidClose");this.okBtn=this.tipFrame.down("input.btn");this.infoEl=this.tipFrame.down("div.gidInfo");this.stepEl=this.tipFrame.down("span.stepf");this.stepEl.hide();this.curStepEl=this.stepEl.down("span");if($("pagePop")){$("pagePop").appendChild(this.tipFrame)}document.body.appendChild(this.tipFrame);this.setMask=new Element("div");this.setMask.innerHTML=" 设置 ";this.setMask.className="mysetMask";this.setMask.setStyle({display:"none",position:"fixed"});if($("pagePop")){$("pagePop").appendChild(this.setMask)}document.body.appendChild(this.setMask);this.isInit=true;Event.observe(this.closeBtn,"click",this.hide.bind(this));Event.observe(this.okBtn,"click",this.onOk.bind(this))},show:function(){this.init();Cover.show();this.tipFrame.show();var a=this.framePosition;this.tipFrame.setStyle({top:a.top+"px"});if(typeof a.left!="undefined"){this.tipFrame.setStyle({left:a.left+"px"});this.tipFrame.setStyle({right:"auto"})}if(typeof a.right!="undefined"){this.tipFrame.setStyle({left:"auto"});this.tipFrame.setStyle({right:a.right+"px"})}this.tipFrame.show()},onOk:function(){this.step++;this.showStep()},showStep:function(){this.init();switch(this.step){case 0:this.tipFrame.style.position="absolute";this.topArr.hide();this.framePosition=Dom.getCenterPos(this.tipFrame);this.okBtn.value="查看更多";this.tipFrame.addClassName("gdstep0");this.stepReleaseFn=function(){this.tipFrame.removeClassName("gdstep0")}.bind(this);this.infoEl.innerHTML=this.step0Info;break;case 1:this.stepReleaseFn();this.topArr.show();this.stepEl.show();this.okBtn.value="我知道了";var d=document.getElementsByClassName("cbox1",$("soHome"))[0];d=$(d);var b=d;var a=Dom.getPos(b);var e=ScrollWin.getWindowHeight();var c=ScrollWin.getScrollTop();if(c+e<a.top+b.offsetHeight+130||c>a.top){ScrollWin.scrollTo(0,a.top-100)}this.framePosition={left:a.left,top:a.top+b.offsetHeight};d.addClassName("gdBight gb1");this.tipFrame.addClassName("gdstep1");this.stepReleaseFn=function(){document.getElementsByClassName("cbox1",$("soHome"))[0].removeClassName("gdBight gb1");this.tipFrame.removeClassName("gdstep1")}.bind(this);this.infoEl.innerHTML=this.step1Info;break;case 2:this.stepReleaseFn();var d=document.getElementsByClassName("c1",$("soHome"))[0];d=$(d);var b=d;var a=Dom.getPos(b);var e=ScrollWin.getWindowHeight();var c=ScrollWin.getScrollTop();if(c+e<a.top+b.offsetHeight+130||c>a.top){ScrollWin.scrollTo(0,a.top-100)}this.framePosition={left:a.left-20,top:a.top+b.offsetHeight};d.addClassName("gdBight gb2");this.tipFrame.addClassName("gdstep2");this.stepReleaseFn=function(){document.getElementsByClassName("c1",$("soHome"))[0].removeClassName("gdBight gb2");this.tipFrame.removeClassName("gdstep2")}.bind(this);this.infoEl.innerHTML=this.step2Info;break;case 3:this.stepReleaseFn();var d=document.getElementsByClassName("myset",$("toolBar"))[0];d=$(d);var b=d;var a=Dom.getPos(b);this.framePosition={right:40,top:a.top+b.offsetHeight};this.setMask.setStyle({left:(a.left-10)+"px",position:"absolute",zIndex:"1002"});this.setMask.show();if(navigator.userAgent.toLowerCase().indexOf("msie 6")==-1){this.tipFrame.style.position="fixed";this.setMask.style.position="fixed"}else{ScrollWin.scrollTo(0,0)}this.tipFrame.addClassName("gdstep3");this.stepReleaseFn=function(){document.getElementsByClassName("myset",$("toolBar"))[0].removeClassName("gdBight gb3");GuidTip.setMask.hide();this.tipFrame.removeClassName("gdstep3")}.bind(this);this.infoEl.innerHTML=this.step3Info;break;default:this.hide();return;break}if(this.step!=0){this.curStepEl.innerHTML=this.step}this.show()},hide:function(){if(this.stepReleaseFn){this.stepReleaseFn()}Cover.hide();this.tipFrame.hide();var a="/service/showTips.jsp";new Ajax.Request(a,{method:"get",parameters:"",onComplete:function(b){}});ScrollWin.scrollTo(0,0)}};if(!Mini){var Mini={}}Mini.Util={getTxtLength:function(b){var a=/<a[^>]*>[^<]*<\/a>/ig;b=b.replace(a,"$1");return this.getLenU(b)},limitTxt:function(d,a){var b=this.getTxtLength(d);var c=this.getLenU(d);return this.limitU(d,a+c-b)},getLenU:function(a){return a.replace(/[^\x00-\xff]/g,"**").length},substrU:function(c,b){var a="";if(c){if(c.length>b){a=c.substr(0,b)}else{a=c}}return a},limitU:function(f,e){switch(typeof(f)){case"string":case"number":var b=3;if(f.length>e){f=f.substr(0,e)}if(this.getLenU(f)>e){var c=new RegExp("[^\x00-\xff]");var a=Math.floor(f.length/2);var d=e-3-this.getLenU(f.substr(0,a));while(d>0){d-=c.test(f.substr(a,1))?2:1;if(d>=0){a++}}f=f.substr(0,a)+"..."}return f;break;default:return"";break}},selectText:function(b,c,d){b.focus();ds=document.selection;if(!ds){b.setSelectionRange(c,d);return}var a=b.createTextRange();a.collapse(1);a.moveStart("character",c);a.moveEnd("character",d-c);a.select()}};if(!Mini){var Mini={}}Mini.Vision={slideRemove:function(b,a){a=Object.extend({step:10,interval:100,type:"remove"},a||{});var e=b.getHeight();var d=0;d=parseInt(b.getStyle("padding-top"))+parseInt(b.getStyle("padding-bottom"));if(isNaN(d)){d=0}e-=d;b.setStyle({overflow:"hidden"});var c=setInterval(function(){e=e-a.step;if(e<0){e=0}b.setStyle({height:e+"px"});if(e<=0){clearInterval(c);if(a.type=="remove"){b.remove()}else{b.hide()}}},a.interval)},slideShow:function(d,a){a=Object.extend({step:10,interval:100,type:"remove"},a||{});var c=d.parentNode;if(!c){return}c=$(c);var b=new Element("div",{height:"0px",overflow:"hidden"});c.insert(b);b.insert()},marqueeTitle:function(c,b){Mini.Vision.marqueeTitle.backup=document.title;if(typeof Mini.Vision.marqueeTitle.itId!="undefined"){clearInterval(Mini.Vision.marqueeTitle.itId)}b=Object.extend({interval:200},b||{});var a=c.length;offset=0;Mini.Vision.marqueeTitle.itId=setInterval(function(){var d=c.substring(offset)+c.substring(0,offset);document.title=d;offset++;if(offset>=a){offset=0}},b.interval)},marqueeTitleClear:function(){if(typeof Mini.Vision.marqueeTitle.backup!="undefined"){document.title=Mini.Vision.marqueeTitle.backup}if(typeof Mini.Vision.marqueeTitle.itId!="undefined"){clearInterval(Mini.Vision.marqueeTitle.itId)}},NumberVision:{up:function(g,f,j){if(g>=f){return}var h=f-g;var e=2000;var b=1;var d=e*b/h;if(d<50){b=parseInt(h*50/e);d=e*b/h}if(d>50){d=50}var c=0;var a=setInterval(function(){c+=b;if(c>h){c=h}j.innerHTML=g+c;if(c>=h){clearInterval(a)}},d)}}};